# ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“‹ ä½¿ç”¨æ­¥éª¤

### 1. æ¿€æ´»ç¯å¢ƒ
```bash
# æ¿€æ´»schiclusterç¯å¢ƒ
micromamba activate schicluster

# éªŒè¯ç¯å¢ƒ
echo $CONDA_DEFAULT_ENV
# åº”è¯¥æ˜¾ç¤º: schicluster
```

### 2. åˆ‡æ¢åˆ°å·¥ä½œç›®å½•
```bash
cd /Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/plotumap
```

### 3. è¿è¡Œæµ‹è¯•

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨Pythonæµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰
```bash
python run_test.py
```
ç„¶åæ ¹æ®èœå•é€‰æ‹©æµ‹è¯•é€‰é¡¹ã€‚

#### æ–¹æ³•äºŒï¼šç›´æ¥è¿è¡Œå…·ä½“æµ‹è¯•
```bash
# åŸºç¡€åŠŸèƒ½æµ‹è¯•
python test_upper_triangle.py

# å°è§„æ¨¡æ‰¹å¤„ç†æµ‹è¯•
python process_all_stages.py --max-cells 2 --stages E95

# æ ¸å¿ƒæ¨¡å—æµ‹è¯•
python hic_upper_triangle_builder.py
```

#### æ–¹æ³•ä¸‰ï¼šä½¿ç”¨Shellè„šæœ¬
```bash
bash run_test.sh
```

## ğŸ¯ æ¨èæµ‹è¯•æµç¨‹

1. **æ•°æ®å¯ç”¨æ€§æ£€æŸ¥** - ç¡®è®¤æ•°æ®å­˜åœ¨
2. **åŸºç¡€åŠŸèƒ½æµ‹è¯•** - éªŒè¯æ ¸å¿ƒåŠŸèƒ½
3. **å°è§„æ¨¡æµ‹è¯•** - å¤„ç†å°‘é‡æ•°æ®éªŒè¯æµç¨‹
4. **æ‰¹é‡å¤„ç†** - å¤„ç†æ‰€æœ‰æ•°æ®

## ğŸ“Š æµ‹è¯•é€‰é¡¹è¯´æ˜

### é€‰é¡¹1: åŸºç¡€åŠŸèƒ½æµ‹è¯•
- æ£€æŸ¥æ•°æ®å¯ç”¨æ€§
- æµ‹è¯•å•ç»†èƒå¤„ç†
- æµ‹è¯•å°è§„æ¨¡stageå¤„ç†
- éªŒè¯ç‰¹å¾åç§°ç”Ÿæˆ

### é€‰é¡¹2: å°è§„æ¨¡æ‰¹å¤„ç†æµ‹è¯•
- å¤„ç†E95 stageï¼ˆç»†èƒæ•°è¾ƒå°‘ï¼‰
- é™åˆ¶æ¯ä¸ªstage 2ä¸ªç»†èƒ
- éªŒè¯å®Œæ•´æµç¨‹

### é€‰é¡¹3: æ ¸å¿ƒæ¨¡å—æµ‹è¯•
- å•ç‹¬æµ‹è¯•çŸ©é˜µæ„å»ºå™¨
- å¤„ç†E95 stage 5ä¸ªç»†èƒ

### é€‰é¡¹4: æ•°æ®å¯ç”¨æ€§æ£€æŸ¥
- æ‰«ææ‰€æœ‰stageç›®å½•
- ç»Ÿè®¡å¯ç”¨ç»†èƒæ•°é‡

### é€‰é¡¹5: è‡ªå®šä¹‰æ‰¹å¤„ç†æµ‹è¯•
- è‡ªå®šä¹‰ç»†èƒæ•°é‡
- è‡ªå®šä¹‰å¤„ç†çš„stages

## ğŸ”§ æ•…éšœæ’é™¤

### ç¯å¢ƒé—®é¢˜
```bash
# å¦‚æœç¯å¢ƒæ¿€æ´»å¤±è´¥
micromamba list environments
micromamba activate schicluster

# æ£€æŸ¥Pythonè·¯å¾„
which python
```

### è·¯å¾„é—®é¢˜
```bash
# ç¡®ä¿åœ¨æ­£ç¡®ç›®å½•
pwd
# åº”è¯¥æ˜¾ç¤º: /Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/plotumap

# æ£€æŸ¥æ•°æ®ç›®å½•
ls -la ../../output/imputed_matrices_by_stage/
```

### æƒé™é—®é¢˜
```bash
# ç¡®ä¿è„šæœ¬å¯æ‰§è¡Œ
chmod +x run_test.sh
chmod +x *.py
```

## ğŸ“ é¢„æœŸè¾“å‡ºç›®å½•

æˆåŠŸè¿è¡Œåä¼šåˆ›å»ºä»¥ä¸‹ç›®å½•å’Œæ–‡ä»¶ï¼š
```
../../output/
â”œâ”€â”€ hic_upper_triangle_h5ad/          # ä¸»è¦è¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ E95_upper_triangle.h5ad       # æµ‹è¯•è¾“å‡º
â”‚   â””â”€â”€ processing_report.txt         # å¤„ç†æŠ¥å‘Š
â””â”€â”€ test_upper_triangle_h5ad/         # æµ‹è¯•è¾“å‡ºç›®å½•
    â””â”€â”€ E95_upper_triangle_test.h5ad  # åŸºç¡€æµ‹è¯•è¾“å‡º
```

## ğŸ“‹ æ—¥å¿—æ–‡ä»¶

- `test_upper_triangle.log` - åŸºç¡€æµ‹è¯•æ—¥å¿—
- `process_all_stages.log` - æ‰¹å¤„ç†æ—¥å¿—
- `hic_umap_pipeline.log` - ä¹‹å‰ç³»ç»Ÿçš„æ—¥å¿—

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **é¦–æ¬¡ä½¿ç”¨**: å…ˆè¿è¡Œé€‰é¡¹4æ£€æŸ¥æ•°æ®ï¼Œç„¶åè¿è¡Œé€‰é¡¹1è¿›è¡ŒåŸºç¡€æµ‹è¯•
2. **å¿«é€ŸéªŒè¯**: ä½¿ç”¨é€‰é¡¹2è¿›è¡Œå°è§„æ¨¡æ‰¹å¤„ç†æµ‹è¯•
3. **ç”Ÿäº§ä½¿ç”¨**: ç¡®è®¤æµ‹è¯•é€šè¿‡åï¼Œä½¿ç”¨å®Œæ•´çš„æ‰¹å¤„ç†å‘½ä»¤

## ğŸš€ å®Œæ•´æ‰¹å¤„ç†å‘½ä»¤

æµ‹è¯•é€šè¿‡åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¤„ç†æ‰€æœ‰æ•°æ®ï¼š
```bash
# å¤„ç†æ‰€æœ‰stagesï¼ˆé¡ºåºï¼‰
python process_all_stages.py

# å¹¶è¡Œå¤„ç†ï¼ˆæ¨èï¼‰
python process_all_stages.py --parallel --max-workers 2

# å¤„ç†æŒ‡å®šstages
python process_all_stages.py --stages E70 E80 EX05

# é™åˆ¶ç»†èƒæ•°é‡ï¼ˆç”¨äºæµ‹è¯•ï¼‰
python process_all_stages.py --max-cells 10
```