2025-08-23 15:13:55,006 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:13:55,007 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:13:55,007 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:13:55,007 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:13:55,007 - INFO - 🔧 使用 MPS: True
2025-08-23 15:13:55,007 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:13:55,007 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:13:55,136 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:13:55,871 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:13:55,871 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:13:55,871 - INFO - 
==================================================
2025-08-23 15:13:55,871 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:13:55,871 - INFO - ==================================================
2025-08-23 15:13:55,873 - INFO - 🗂️  Stage E70: 发现 1 个细胞
2025-08-23 15:13:55,873 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:13:55,879 - INFO - 📦 M4 批次处理 1: 细胞 1-1/1
2025-08-23 15:13:55,879 - INFO - 📊 处理: GasfE703153 (1/1)
2025-08-23 15:13:55,879 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:13:55,884 - ERROR -   ❌ 染色体 chr1 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,884 - ERROR -   ❌ chr1: 插补失败
2025-08-23 15:13:55,887 - ERROR -   ❌ 染色体 chr2 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,887 - ERROR -   ❌ chr2: 插补失败
2025-08-23 15:13:55,889 - ERROR -   ❌ 染色体 chr3 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,889 - ERROR -   ❌ chr3: 插补失败
2025-08-23 15:13:55,891 - ERROR -   ❌ 染色体 chr4 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,891 - ERROR -   ❌ chr4: 插补失败
2025-08-23 15:13:55,893 - ERROR -   ❌ 染色体 chr5 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,893 - ERROR -   ❌ chr5: 插补失败
2025-08-23 15:13:55,896 - ERROR -   ❌ 染色体 chr6 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,896 - ERROR -   ❌ chr6: 插补失败
2025-08-23 15:13:55,898 - ERROR -   ❌ 染色体 chr7 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,898 - ERROR -   ❌ chr7: 插补失败
2025-08-23 15:13:55,900 - ERROR -   ❌ 染色体 chr8 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,900 - ERROR -   ❌ chr8: 插补失败
2025-08-23 15:13:55,902 - ERROR -   ❌ 染色体 chr9 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,902 - ERROR -   ❌ chr9: 插补失败
2025-08-23 15:13:55,904 - ERROR -   ❌ 染色体 chr10 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,904 - ERROR -   ❌ chr10: 插补失败
2025-08-23 15:13:55,906 - ERROR -   ❌ 染色体 chr11 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,906 - ERROR -   ❌ chr11: 插补失败
2025-08-23 15:13:55,908 - ERROR -   ❌ 染色体 chr12 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,908 - ERROR -   ❌ chr12: 插补失败
2025-08-23 15:13:55,910 - ERROR -   ❌ 染色体 chr13 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,910 - ERROR -   ❌ chr13: 插补失败
2025-08-23 15:13:55,912 - ERROR -   ❌ 染色体 chr14 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,912 - ERROR -   ❌ chr14: 插补失败
2025-08-23 15:13:55,913 - ERROR -   ❌ 染色体 chr15 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,913 - ERROR -   ❌ chr15: 插补失败
2025-08-23 15:13:55,915 - ERROR -   ❌ 染色体 chr16 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,915 - ERROR -   ❌ chr16: 插补失败
2025-08-23 15:13:55,916 - ERROR -   ❌ 染色体 chr17 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,916 - ERROR -   ❌ chr17: 插补失败
2025-08-23 15:13:55,918 - ERROR -   ❌ 染色体 chr18 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,918 - ERROR -   ❌ chr18: 插补失败
2025-08-23 15:13:55,919 - ERROR -   ❌ 染色体 chr19 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,919 - ERROR -   ❌ chr19: 插补失败
2025-08-23 15:13:55,920 - ERROR -   ❌ 染色体 chrX 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:13:55,920 - ERROR -   ❌ chrX: 插补失败
2025-08-23 15:13:55,920 - INFO - 🎯 细胞 GasfE703153 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-23 15:13:55,920 - INFO - 📦 批次完成: 0 成功, 20 失败, 耗时 0.0 分钟
2025-08-23 15:13:55,920 - INFO - 🎊 Stage E70 完成: 0 个矩阵成功, 20 个失败
2025-08-23 15:13:55,920 - INFO -    总耗时: 0.00 小时
2025-08-23 15:13:55,920 - INFO - 
============================================================
2025-08-23 15:13:55,920 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:13:55,920 - INFO - 📊 总计: 0 个矩阵成功, 20 个失败
2025-08-23 15:13:55,920 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 15:13:55,920 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:14:49,777 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:14:49,782 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:14:49,782 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:14:49,782 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:14:49,782 - INFO - 🔧 使用 MPS: True
2025-08-23 15:14:49,782 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:14:49,782 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:14:49,897 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:14:50,570 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:14:50,570 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:14:50,570 - INFO - 
==================================================
2025-08-23 15:14:50,570 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:14:50,570 - INFO - ==================================================
2025-08-23 15:14:50,572 - INFO - 🗂️  Stage E70: 发现 1 个细胞
2025-08-23 15:14:50,572 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:14:50,572 - INFO - 📦 M4 批次处理 1: 细胞 1-1/1
2025-08-23 15:14:50,572 - INFO - 📊 处理: GasfE703153 (1/1)
2025-08-23 15:14:50,572 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:14:50,579 - ERROR -   ❌ 染色体 chr1 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,579 - ERROR -   ❌ chr1: 插补失败
2025-08-23 15:14:50,582 - ERROR -   ❌ 染色体 chr2 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,582 - ERROR -   ❌ chr2: 插补失败
2025-08-23 15:14:50,584 - ERROR -   ❌ 染色体 chr3 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,584 - ERROR -   ❌ chr3: 插补失败
2025-08-23 15:14:50,586 - ERROR -   ❌ 染色体 chr4 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,586 - ERROR -   ❌ chr4: 插补失败
2025-08-23 15:14:50,588 - ERROR -   ❌ 染色体 chr5 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,588 - ERROR -   ❌ chr5: 插补失败
2025-08-23 15:14:50,590 - ERROR -   ❌ 染色体 chr6 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,590 - ERROR -   ❌ chr6: 插补失败
2025-08-23 15:14:50,592 - ERROR -   ❌ 染色体 chr7 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,593 - ERROR -   ❌ chr7: 插补失败
2025-08-23 15:14:50,594 - ERROR -   ❌ 染色体 chr8 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,595 - ERROR -   ❌ chr8: 插补失败
2025-08-23 15:14:50,597 - ERROR -   ❌ 染色体 chr9 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,597 - ERROR -   ❌ chr9: 插补失败
2025-08-23 15:14:50,598 - ERROR -   ❌ 染色体 chr10 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,598 - ERROR -   ❌ chr10: 插补失败
2025-08-23 15:14:50,600 - ERROR -   ❌ 染色体 chr11 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,600 - ERROR -   ❌ chr11: 插补失败
2025-08-23 15:14:50,602 - ERROR -   ❌ 染色体 chr12 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,602 - ERROR -   ❌ chr12: 插补失败
2025-08-23 15:14:50,604 - ERROR -   ❌ 染色体 chr13 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,604 - ERROR -   ❌ chr13: 插补失败
2025-08-23 15:14:50,606 - ERROR -   ❌ 染色体 chr14 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,606 - ERROR -   ❌ chr14: 插补失败
2025-08-23 15:14:50,607 - ERROR -   ❌ 染色体 chr15 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,607 - ERROR -   ❌ chr15: 插补失败
2025-08-23 15:14:50,609 - ERROR -   ❌ 染色体 chr16 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,609 - ERROR -   ❌ chr16: 插补失败
2025-08-23 15:14:50,610 - ERROR -   ❌ 染色体 chr17 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,610 - ERROR -   ❌ chr17: 插补失败
2025-08-23 15:14:50,612 - ERROR -   ❌ 染色体 chr18 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,612 - ERROR -   ❌ chr18: 插补失败
2025-08-23 15:14:50,613 - ERROR -   ❌ 染色体 chr19 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,613 - ERROR -   ❌ chr19: 插补失败
2025-08-23 15:14:50,614 - ERROR -   ❌ 染色体 chrX 插补失败: impute_chromosome() got an unexpected keyword argument 'contacts'
2025-08-23 15:14:50,614 - ERROR -   ❌ chrX: 插补失败
2025-08-23 15:14:50,614 - INFO - 🎯 细胞 GasfE703153 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-23 15:14:50,614 - INFO - 📦 批次完成: 0 成功, 20 失败, 耗时 0.0 分钟
2025-08-23 15:14:50,614 - INFO - 🎊 Stage E70 完成: 0 个矩阵成功, 20 个失败
2025-08-23 15:14:50,614 - INFO -    总耗时: 0.00 小时
2025-08-23 15:14:50,614 - INFO - 
============================================================
2025-08-23 15:14:50,614 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:14:50,614 - INFO - 📊 总计: 0 个矩阵成功, 20 个失败
2025-08-23 15:14:50,614 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 15:14:50,614 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:15:57,865 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:15:57,875 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:15:57,875 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:15:57,875 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:15:57,875 - INFO - 🔧 使用 MPS: True
2025-08-23 15:15:57,875 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:15:57,875 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:15:57,992 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:15:58,664 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:15:58,664 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:15:58,664 - INFO - 
==================================================
2025-08-23 15:15:58,664 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:15:58,664 - INFO - ==================================================
2025-08-23 15:15:58,665 - INFO - 🗂️  Stage E70: 发现 1 个细胞
2025-08-23 15:15:58,665 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:15:58,665 - INFO - 📦 M4 批次处理 1: 细胞 1-1/1
2025-08-23 15:15:58,665 - INFO - 📊 处理: GasfE703153 (1/1)
2025-08-23 15:15:58,665 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:15:58,665 - INFO - Starting chromosome chr1 imputation with MPS GPU acceleration
2025-08-23 15:15:58,673 - ERROR -   ❌ 染色体 chr1 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,673 - ERROR -   ❌ chr1: 插补失败
2025-08-23 15:15:58,673 - INFO - Starting chromosome chr2 imputation with MPS GPU acceleration
2025-08-23 15:15:58,674 - ERROR -   ❌ 染色体 chr2 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,674 - ERROR -   ❌ chr2: 插补失败
2025-08-23 15:15:58,674 - INFO - Starting chromosome chr3 imputation with MPS GPU acceleration
2025-08-23 15:15:58,675 - ERROR -   ❌ 染色体 chr3 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,675 - ERROR -   ❌ chr3: 插补失败
2025-08-23 15:15:58,675 - INFO - Starting chromosome chr4 imputation with MPS GPU acceleration
2025-08-23 15:15:58,676 - ERROR -   ❌ 染色体 chr4 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,676 - ERROR -   ❌ chr4: 插补失败
2025-08-23 15:15:58,676 - INFO - Starting chromosome chr5 imputation with MPS GPU acceleration
2025-08-23 15:15:58,677 - ERROR -   ❌ 染色体 chr5 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,677 - ERROR -   ❌ chr5: 插补失败
2025-08-23 15:15:58,677 - INFO - Starting chromosome chr6 imputation with MPS GPU acceleration
2025-08-23 15:15:58,677 - ERROR -   ❌ 染色体 chr6 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,677 - ERROR -   ❌ chr6: 插补失败
2025-08-23 15:15:58,677 - INFO - Starting chromosome chr7 imputation with MPS GPU acceleration
2025-08-23 15:15:58,678 - ERROR -   ❌ 染色体 chr7 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,678 - ERROR -   ❌ chr7: 插补失败
2025-08-23 15:15:58,679 - INFO - Starting chromosome chr8 imputation with MPS GPU acceleration
2025-08-23 15:15:58,679 - ERROR -   ❌ 染色体 chr8 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,679 - ERROR -   ❌ chr8: 插补失败
2025-08-23 15:15:58,679 - INFO - Starting chromosome chr9 imputation with MPS GPU acceleration
2025-08-23 15:15:58,680 - ERROR -   ❌ 染色体 chr9 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,680 - ERROR -   ❌ chr9: 插补失败
2025-08-23 15:15:58,680 - INFO - Starting chromosome chr10 imputation with MPS GPU acceleration
2025-08-23 15:15:58,681 - ERROR -   ❌ 染色体 chr10 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,681 - ERROR -   ❌ chr10: 插补失败
2025-08-23 15:15:58,681 - INFO - Starting chromosome chr11 imputation with MPS GPU acceleration
2025-08-23 15:15:58,682 - ERROR -   ❌ 染色体 chr11 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,682 - ERROR -   ❌ chr11: 插补失败
2025-08-23 15:15:58,682 - INFO - Starting chromosome chr12 imputation with MPS GPU acceleration
2025-08-23 15:15:58,683 - ERROR -   ❌ 染色体 chr12 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,683 - ERROR -   ❌ chr12: 插补失败
2025-08-23 15:15:58,683 - INFO - Starting chromosome chr13 imputation with MPS GPU acceleration
2025-08-23 15:15:58,684 - ERROR -   ❌ 染色体 chr13 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,684 - ERROR -   ❌ chr13: 插补失败
2025-08-23 15:15:58,684 - INFO - Starting chromosome chr14 imputation with MPS GPU acceleration
2025-08-23 15:15:58,685 - ERROR -   ❌ 染色体 chr14 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,685 - ERROR -   ❌ chr14: 插补失败
2025-08-23 15:15:58,685 - INFO - Starting chromosome chr15 imputation with MPS GPU acceleration
2025-08-23 15:15:58,686 - ERROR -   ❌ 染色体 chr15 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,686 - ERROR -   ❌ chr15: 插补失败
2025-08-23 15:15:58,686 - INFO - Starting chromosome chr16 imputation with MPS GPU acceleration
2025-08-23 15:15:58,687 - ERROR -   ❌ 染色体 chr16 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,687 - ERROR -   ❌ chr16: 插补失败
2025-08-23 15:15:58,687 - INFO - Starting chromosome chr17 imputation with MPS GPU acceleration
2025-08-23 15:15:58,688 - ERROR -   ❌ 染色体 chr17 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,688 - ERROR -   ❌ chr17: 插补失败
2025-08-23 15:15:58,688 - INFO - Starting chromosome chr18 imputation with MPS GPU acceleration
2025-08-23 15:15:58,689 - ERROR -   ❌ 染色体 chr18 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,689 - ERROR -   ❌ chr18: 插补失败
2025-08-23 15:15:58,689 - INFO - Starting chromosome chr19 imputation with MPS GPU acceleration
2025-08-23 15:15:58,689 - ERROR -   ❌ 染色体 chr19 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,689 - ERROR -   ❌ chr19: 插补失败
2025-08-23 15:15:58,689 - INFO - Starting chromosome chrX imputation with MPS GPU acceleration
2025-08-23 15:15:58,690 - ERROR -   ❌ 染色体 chrX 插补失败: '[5, 6] not in index'
2025-08-23 15:15:58,690 - ERROR -   ❌ chrX: 插补失败
2025-08-23 15:15:58,690 - INFO - 🎯 细胞 GasfE703153 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-23 15:15:58,690 - INFO - 📦 批次完成: 0 成功, 20 失败, 耗时 0.0 分钟
2025-08-23 15:15:58,690 - INFO - 🎊 Stage E70 完成: 0 个矩阵成功, 20 个失败
2025-08-23 15:15:58,690 - INFO -    总耗时: 0.00 小时
2025-08-23 15:15:58,690 - INFO - 
============================================================
2025-08-23 15:15:58,690 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:15:58,690 - INFO - 📊 总计: 0 个矩阵成功, 20 个失败
2025-08-23 15:15:58,690 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 15:15:58,690 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:26:33,709 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:26:33,719 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:26:33,719 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:26:33,719 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:26:33,719 - INFO - 🔧 使用 MPS: True
2025-08-23 15:26:33,719 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:26:33,719 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:26:33,840 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:26:34,529 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:26:34,529 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:26:34,529 - INFO - 
==================================================
2025-08-23 15:26:34,529 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:26:34,529 - INFO - ==================================================
2025-08-23 15:26:34,530 - INFO - 🗂️  Stage E70: 发现 1 个细胞
2025-08-23 15:26:34,531 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:26:34,531 - INFO - 📦 M4 批次处理 1: 细胞 1-1/1
2025-08-23 15:26:34,531 - INFO - 📊 处理: GasfE703153 (1/1)
2025-08-23 15:26:34,531 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:26:34,535 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-23 15:26:34,537 - INFO -    染色体 chr1 大小: 195,471,971 bp, bins: 9774
2025-08-23 15:26:34,538 - INFO -    数据形状: (6643, 3)
2025-08-23 15:26:34,538 - INFO -    bin 范围: 30-1952, 32-1952
2025-08-23 15:26:34,538 - INFO -    矩阵大小: (9774, 9774), 非零元素: 12,039, 稀疏度: 0.000126
2025-08-23 15:26:34,539 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:26:34,539 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-23 15:26:34,728 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:26:35,047 - INFO -    卷积耗时: 0.508 秒
2025-08-23 15:26:35,049 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0007)
2025-08-23 15:26:35,049 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-23 15:26:35,049 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-23 15:26:35,161 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-23 15:26:36,486 - INFO - 🔥 MPS Iter 1 takes 0.122 seconds. Loss: 4.054
2025-08-23 15:26:37,735 - INFO - 🔥 MPS Iter 2 takes 1.442 seconds. Loss: 0.664
2025-08-23 15:26:38,877 - INFO - 🔥 MPS Iter 3 takes 2.687 seconds. Loss: 0.163
2025-08-23 15:26:40,010 - INFO - 🔥 MPS Iter 4 takes 3.829 seconds. Loss: 0.049
2025-08-23 15:26:41,140 - INFO - 🔥 MPS Iter 5 takes 4.962 seconds. Loss: 0.017
2025-08-23 15:26:42,276 - INFO - 🔥 MPS Iter 6 takes 6.093 seconds. Loss: 0.006
2025-08-23 15:26:42,277 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:26:42,277 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:26:42,350 - INFO - 🧹 GPU memory cleared
2025-08-23 15:26:42,735 - INFO -    RWR 耗时: 7.688 秒
2025-08-23 15:26:42,779 - INFO -    归一化耗时: 0.044 秒
2025-08-23 15:26:43,129 - INFO -    ✅ 完成，总耗时: 8.240 秒
2025-08-23 15:26:43,133 - INFO -   ✅ chr1: 完成，耗时 8.60 秒
2025-08-23 15:26:43,133 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-23 15:26:43,135 - INFO -    染色体 chr2 大小: 182,113,224 bp, bins: 9106
2025-08-23 15:26:43,137 - INFO -    数据形状: (6596, 3)
2025-08-23 15:26:43,138 - INFO -    bin 范围: 30-1819, 31-1819
2025-08-23 15:26:43,138 - INFO -    矩阵大小: (9106, 9106), 非零元素: 11,972, 稀疏度: 0.000144
2025-08-23 15:26:43,138 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:26:43,138 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-23 15:26:43,255 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:26:43,547 - INFO -    卷积耗时: 0.408 秒
2025-08-23 15:26:43,548 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0008)
2025-08-23 15:26:43,548 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-23 15:26:43,548 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-23 15:26:43,651 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-23 15:26:44,586 - INFO - 🔥 MPS Iter 1 takes 0.110 seconds. Loss: 3.845
2025-08-23 15:26:45,514 - INFO - 🔥 MPS Iter 2 takes 1.039 seconds. Loss: 0.628
2025-08-23 15:26:46,408 - INFO - 🔥 MPS Iter 3 takes 1.966 seconds. Loss: 0.156
2025-08-23 15:26:47,321 - INFO - 🔥 MPS Iter 4 takes 2.860 seconds. Loss: 0.047
2025-08-23 15:26:48,214 - INFO - 🔥 MPS Iter 5 takes 3.774 seconds. Loss: 0.017
2025-08-23 15:26:49,105 - INFO - 🔥 MPS Iter 6 takes 4.666 seconds. Loss: 0.006
2025-08-23 15:26:49,105 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:26:49,106 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:26:49,132 - INFO - 🧹 GPU memory cleared
2025-08-23 15:26:49,447 - INFO -    RWR 耗时: 5.900 秒
2025-08-23 15:26:49,484 - INFO -    归一化耗时: 0.037 秒
2025-08-23 15:26:49,801 - INFO -    ✅ 完成，总耗时: 6.345 秒
2025-08-23 15:26:49,805 - INFO -   ✅ chr2: 完成，耗时 6.67 秒
2025-08-23 15:26:49,805 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-23 15:26:49,806 - INFO -    染色体 chr3 大小: 160,039,680 bp, bins: 8002
2025-08-23 15:26:49,808 - INFO -    数据形状: (4946, 3)
2025-08-23 15:26:49,808 - INFO -    bin 范围: 30-1598, 31-1599
2025-08-23 15:26:49,809 - INFO -    矩阵大小: (8002, 8002), 非零元素: 8,912, 稀疏度: 0.000139
2025-08-23 15:26:49,809 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:26:49,809 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-23 15:26:49,907 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:26:50,121 - INFO -    卷积耗时: 0.312 秒
2025-08-23 15:26:50,123 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0007)
2025-08-23 15:26:50,123 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-23 15:26:50,123 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-23 15:26:50,202 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-23 15:26:50,810 - INFO - 🔥 MPS Iter 1 takes 0.089 seconds. Loss: 4.010
2025-08-23 15:26:51,392 - INFO - 🔥 MPS Iter 2 takes 0.688 seconds. Loss: 0.679
2025-08-23 15:26:51,968 - INFO - 🔥 MPS Iter 3 takes 1.270 seconds. Loss: 0.167
2025-08-23 15:26:52,543 - INFO - 🔥 MPS Iter 4 takes 1.846 seconds. Loss: 0.050
2025-08-23 15:26:53,122 - INFO - 🔥 MPS Iter 5 takes 2.421 seconds. Loss: 0.017
2025-08-23 15:26:53,701 - INFO - 🔥 MPS Iter 6 takes 3.001 seconds. Loss: 0.007
2025-08-23 15:26:53,702 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:26:53,702 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:26:53,733 - INFO - 🧹 GPU memory cleared
2025-08-23 15:26:53,986 - INFO -    RWR 耗时: 3.864 秒
2025-08-23 15:26:54,017 - INFO -    归一化耗时: 0.031 秒
2025-08-23 15:26:54,241 - INFO -    ✅ 完成，总耗时: 4.207 秒
2025-08-23 15:26:54,244 - INFO -   ✅ chr3: 完成，耗时 4.44 秒
2025-08-23 15:26:54,244 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-23 15:26:54,245 - INFO -    染色体 chr4 大小: 156,508,116 bp, bins: 7826
2025-08-23 15:26:54,247 - INFO -    数据形状: (4876, 3)
2025-08-23 15:26:54,247 - INFO -    bin 范围: 30-1563, 30-1563
2025-08-23 15:26:54,247 - INFO -    矩阵大小: (7826, 7826), 非零元素: 8,783, 稀疏度: 0.000143
2025-08-23 15:26:54,248 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:26:54,248 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-23 15:26:54,330 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:26:54,546 - INFO -    卷积耗时: 0.298 秒
2025-08-23 15:26:54,553 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0008)
2025-08-23 15:26:54,553 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-23 15:26:54,553 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-23 15:26:54,632 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-23 15:26:55,208 - INFO - 🔥 MPS Iter 1 takes 0.088 seconds. Loss: 3.964
2025-08-23 15:26:55,735 - INFO - 🔥 MPS Iter 2 takes 0.656 seconds. Loss: 0.649
2025-08-23 15:26:56,264 - INFO - 🔥 MPS Iter 3 takes 1.184 seconds. Loss: 0.159
2025-08-23 15:26:56,803 - INFO - 🔥 MPS Iter 4 takes 1.712 seconds. Loss: 0.047
2025-08-23 15:26:57,322 - INFO - 🔥 MPS Iter 5 takes 2.251 seconds. Loss: 0.016
2025-08-23 15:26:57,847 - INFO - 🔥 MPS Iter 6 takes 2.770 seconds. Loss: 0.006
2025-08-23 15:26:57,847 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:26:57,847 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:26:57,870 - INFO - 🧹 GPU memory cleared
2025-08-23 15:26:58,100 - INFO -    RWR 耗时: 3.548 秒
2025-08-23 15:26:58,128 - INFO -    归一化耗时: 0.028 秒
2025-08-23 15:26:58,343 - INFO -    ✅ 完成，总耗时: 3.874 秒
2025-08-23 15:26:58,346 - INFO -   ✅ chr4: 完成，耗时 4.10 秒
2025-08-23 15:26:58,346 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-23 15:26:58,346 - INFO -    染色体 chr5 大小: 151,834,684 bp, bins: 7592
2025-08-23 15:26:58,349 - INFO -    数据形状: (4990, 3)
2025-08-23 15:26:58,349 - INFO -    bin 范围: 30-1517, 31-1517
2025-08-23 15:26:58,349 - INFO -    矩阵大小: (7592, 7592), 非零元素: 8,945, 稀疏度: 0.000155
2025-08-23 15:26:58,350 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:26:58,350 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-23 15:26:58,423 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:26:58,616 - INFO -    卷积耗时: 0.266 秒
2025-08-23 15:26:58,618 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0008)
2025-08-23 15:26:58,618 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-23 15:26:58,618 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-23 15:26:58,689 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-23 15:26:59,188 - INFO - 🔥 MPS Iter 1 takes 0.079 seconds. Loss: 3.793
2025-08-23 15:26:59,651 - INFO - 🔥 MPS Iter 2 takes 0.571 seconds. Loss: 0.638
2025-08-23 15:27:00,134 - INFO - 🔥 MPS Iter 3 takes 1.034 seconds. Loss: 0.160
2025-08-23 15:27:00,603 - INFO - 🔥 MPS Iter 4 takes 1.517 seconds. Loss: 0.049
2025-08-23 15:27:01,073 - INFO - 🔥 MPS Iter 5 takes 1.986 seconds. Loss: 0.017
2025-08-23 15:27:01,545 - INFO - 🔥 MPS Iter 6 takes 2.457 seconds. Loss: 0.006
2025-08-23 15:27:01,546 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:01,546 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:01,559 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:01,777 - INFO -    RWR 耗时: 3.160 秒
2025-08-23 15:27:01,803 - INFO -    归一化耗时: 0.026 秒
2025-08-23 15:27:02,006 - INFO -    ✅ 完成，总耗时: 3.453 秒
2025-08-23 15:27:02,008 - INFO -   ✅ chr5: 完成，耗时 3.66 秒
2025-08-23 15:27:02,008 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-23 15:27:02,009 - INFO -    染色体 chr6 大小: 149,736,546 bp, bins: 7487
2025-08-23 15:27:02,011 - INFO -    数据形状: (5180, 3)
2025-08-23 15:27:02,011 - INFO -    bin 范围: 31-1494, 31-1495
2025-08-23 15:27:02,012 - INFO -    矩阵大小: (7487, 7487), 非零元素: 9,359, 稀疏度: 0.000167
2025-08-23 15:27:02,012 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:02,012 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-23 15:27:02,098 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:02,294 - INFO -    卷积耗时: 0.282 秒
2025-08-23 15:27:02,296 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0009)
2025-08-23 15:27:02,296 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-23 15:27:02,296 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-23 15:27:02,386 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-23 15:27:02,891 - INFO - 🔥 MPS Iter 1 takes 0.097 seconds. Loss: 3.615
2025-08-23 15:27:03,393 - INFO - 🔥 MPS Iter 2 takes 0.596 seconds. Loss: 0.597
2025-08-23 15:27:03,867 - INFO - 🔥 MPS Iter 3 takes 1.099 seconds. Loss: 0.150
2025-08-23 15:27:04,389 - INFO - 🔥 MPS Iter 4 takes 1.572 seconds. Loss: 0.046
2025-08-23 15:27:04,957 - INFO - 🔥 MPS Iter 5 takes 2.095 seconds. Loss: 0.016
2025-08-23 15:27:05,483 - INFO - 🔥 MPS Iter 6 takes 2.662 seconds. Loss: 0.006
2025-08-23 15:27:05,484 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:05,484 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:05,499 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:05,712 - INFO -    RWR 耗时: 3.418 秒
2025-08-23 15:27:05,737 - INFO -    归一化耗时: 0.025 秒
2025-08-23 15:27:05,942 - INFO -    ✅ 完成，总耗时: 3.725 秒
2025-08-23 15:27:05,945 - INFO -   ✅ chr6: 完成，耗时 3.94 秒
2025-08-23 15:27:05,945 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-23 15:27:05,945 - INFO -    染色体 chr7 大小: 145,441,459 bp, bins: 7273
2025-08-23 15:27:05,948 - INFO -    数据形状: (5035, 3)
2025-08-23 15:27:05,948 - INFO -    bin 范围: 31-1453, 31-1453
2025-08-23 15:27:05,948 - INFO -    矩阵大小: (7273, 7273), 非零元素: 9,089, 稀疏度: 0.000172
2025-08-23 15:27:05,949 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:05,949 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-23 15:27:06,034 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:06,219 - INFO -    卷积耗时: 0.270 秒
2025-08-23 15:27:06,220 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0009)
2025-08-23 15:27:06,220 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-23 15:27:06,220 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-23 15:27:06,293 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-23 15:27:06,780 - INFO - 🔥 MPS Iter 1 takes 0.080 seconds. Loss: 3.629
2025-08-23 15:27:07,332 - INFO - 🔥 MPS Iter 2 takes 0.561 seconds. Loss: 0.615
2025-08-23 15:27:07,870 - INFO - 🔥 MPS Iter 3 takes 1.112 seconds. Loss: 0.157
2025-08-23 15:27:08,350 - INFO - 🔥 MPS Iter 4 takes 1.651 seconds. Loss: 0.047
2025-08-23 15:27:08,751 - INFO - 🔥 MPS Iter 5 takes 2.131 seconds. Loss: 0.016
2025-08-23 15:27:09,153 - INFO - 🔥 MPS Iter 6 takes 2.532 seconds. Loss: 0.006
2025-08-23 15:27:09,154 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:09,154 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:09,172 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:09,378 - INFO -    RWR 耗时: 3.158 秒
2025-08-23 15:27:09,404 - INFO -    归一化耗时: 0.027 秒
2025-08-23 15:27:09,591 - INFO -    ✅ 完成，总耗时: 3.455 秒
2025-08-23 15:27:09,593 - INFO -   ✅ chr7: 完成，耗时 3.65 秒
2025-08-23 15:27:09,593 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-23 15:27:09,594 - INFO -    染色体 chr8 大小: 129,401,213 bp, bins: 6471
2025-08-23 15:27:09,596 - INFO -    数据形状: (4227, 3)
2025-08-23 15:27:09,596 - INFO -    bin 范围: 30-1292, 31-1292
2025-08-23 15:27:09,597 - INFO -    矩阵大小: (6471, 6471), 非零元素: 7,568, 稀疏度: 0.000181
2025-08-23 15:27:09,597 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:09,597 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-23 15:27:09,678 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:09,831 - INFO -    卷积耗时: 0.234 秒
2025-08-23 15:27:09,833 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0009)
2025-08-23 15:27:09,833 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-23 15:27:09,833 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-23 15:27:09,911 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-23 15:27:10,218 - INFO - 🔥 MPS Iter 1 takes 0.084 seconds. Loss: 3.505
2025-08-23 15:27:10,542 - INFO - 🔥 MPS Iter 2 takes 0.386 seconds. Loss: 0.595
2025-08-23 15:27:10,841 - INFO - 🔥 MPS Iter 3 takes 0.710 seconds. Loss: 0.149
2025-08-23 15:27:11,130 - INFO - 🔥 MPS Iter 4 takes 1.009 seconds. Loss: 0.045
2025-08-23 15:27:11,423 - INFO - 🔥 MPS Iter 5 takes 1.298 seconds. Loss: 0.016
2025-08-23 15:27:11,711 - INFO - 🔥 MPS Iter 6 takes 1.591 seconds. Loss: 0.006
2025-08-23 15:27:11,711 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:11,712 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:11,721 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:11,887 - INFO -    RWR 耗时: 2.056 秒
2025-08-23 15:27:11,908 - INFO -    归一化耗时: 0.021 秒
2025-08-23 15:27:12,060 - INFO -    ✅ 完成，总耗时: 2.311 秒
2025-08-23 15:27:12,063 - INFO -   ✅ chr8: 完成，耗时 2.47 秒
2025-08-23 15:27:12,063 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-23 15:27:12,063 - INFO -    染色体 chr9 大小: 124,595,110 bp, bins: 6230
2025-08-23 15:27:12,065 - INFO -    数据形状: (4953, 3)
2025-08-23 15:27:12,066 - INFO -    bin 范围: 30-1244, 30-1244
2025-08-23 15:27:12,066 - INFO -    矩阵大小: (6230, 6230), 非零元素: 8,995, 稀疏度: 0.000232
2025-08-23 15:27:12,066 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:12,066 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-23 15:27:12,150 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:12,281 - INFO -    卷积耗时: 0.214 秒
2025-08-23 15:27:12,282 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0012)
2025-08-23 15:27:12,282 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-23 15:27:12,282 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-23 15:27:12,358 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-23 15:27:12,624 - INFO - 🔥 MPS Iter 1 takes 0.084 seconds. Loss: 3.093
2025-08-23 15:27:12,910 - INFO - 🔥 MPS Iter 2 takes 0.343 seconds. Loss: 0.499
2025-08-23 15:27:13,158 - INFO - 🔥 MPS Iter 3 takes 0.629 seconds. Loss: 0.123
2025-08-23 15:27:13,411 - INFO - 🔥 MPS Iter 4 takes 0.877 seconds. Loss: 0.038
2025-08-23 15:27:13,667 - INFO - 🔥 MPS Iter 5 takes 1.129 seconds. Loss: 0.013
2025-08-23 15:27:13,917 - INFO - 🔥 MPS Iter 6 takes 1.385 seconds. Loss: 0.005
2025-08-23 15:27:13,918 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:13,918 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:13,938 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:14,084 - INFO -    RWR 耗时: 1.803 秒
2025-08-23 15:27:14,100 - INFO -    归一化耗时: 0.017 秒
2025-08-23 15:27:14,252 - INFO -    ✅ 完成，总耗时: 2.033 秒
2025-08-23 15:27:14,254 - INFO -   ✅ chr9: 完成，耗时 2.19 秒
2025-08-23 15:27:14,254 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-23 15:27:14,255 - INFO -    染色体 chr10 大小: 130,694,993 bp, bins: 6535
2025-08-23 15:27:14,257 - INFO -    数据形状: (4352, 3)
2025-08-23 15:27:14,257 - INFO -    bin 范围: 31-1305, 31-1305
2025-08-23 15:27:14,257 - INFO -    矩阵大小: (6535, 6535), 非零元素: 7,826, 稀疏度: 0.000183
2025-08-23 15:27:14,257 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:14,257 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-23 15:27:14,321 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:14,475 - INFO -    卷积耗时: 0.218 秒
2025-08-23 15:27:14,477 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0009)
2025-08-23 15:27:14,477 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-23 15:27:14,477 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-23 15:27:14,539 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-23 15:27:14,852 - INFO - 🔥 MPS Iter 1 takes 0.069 seconds. Loss: 3.457
2025-08-23 15:27:15,198 - INFO - 🔥 MPS Iter 2 takes 0.376 seconds. Loss: 0.573
2025-08-23 15:27:15,505 - INFO - 🔥 MPS Iter 3 takes 0.723 seconds. Loss: 0.141
2025-08-23 15:27:15,805 - INFO - 🔥 MPS Iter 4 takes 1.029 seconds. Loss: 0.043
2025-08-23 15:27:16,110 - INFO - 🔥 MPS Iter 5 takes 1.329 seconds. Loss: 0.015
2025-08-23 15:27:16,412 - INFO - 🔥 MPS Iter 6 takes 1.634 seconds. Loss: 0.006
2025-08-23 15:27:16,413 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:16,413 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:16,443 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:16,605 - INFO -    RWR 耗时: 2.129 秒
2025-08-23 15:27:16,626 - INFO -    归一化耗时: 0.021 秒
2025-08-23 15:27:16,782 - INFO -    ✅ 完成，总耗时: 2.368 秒
2025-08-23 15:27:16,783 - INFO -   ✅ chr10: 完成，耗时 2.53 秒
2025-08-23 15:27:16,783 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-23 15:27:16,784 - INFO -    染色体 chr11 大小: 122,082,543 bp, bins: 6105
2025-08-23 15:27:16,786 - INFO -    数据形状: (4566, 3)
2025-08-23 15:27:16,786 - INFO -    bin 范围: 31-1218, 31-1219
2025-08-23 15:27:16,787 - INFO -    矩阵大小: (6105, 6105), 非零元素: 8,237, 稀疏度: 0.000221
2025-08-23 15:27:16,788 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:16,788 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-23 15:27:16,864 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:16,999 - INFO -    卷积耗时: 0.211 秒
2025-08-23 15:27:17,000 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0011)
2025-08-23 15:27:17,000 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-23 15:27:17,000 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-23 15:27:17,060 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-23 15:27:17,307 - INFO - 🔥 MPS Iter 1 takes 0.068 seconds. Loss: 3.161
2025-08-23 15:27:17,579 - INFO - 🔥 MPS Iter 2 takes 0.308 seconds. Loss: 0.511
2025-08-23 15:27:17,819 - INFO - 🔥 MPS Iter 3 takes 0.580 seconds. Loss: 0.128
2025-08-23 15:27:18,058 - INFO - 🔥 MPS Iter 4 takes 0.819 seconds. Loss: 0.040
2025-08-23 15:27:18,302 - INFO - 🔥 MPS Iter 5 takes 1.059 seconds. Loss: 0.014
2025-08-23 15:27:18,544 - INFO - 🔥 MPS Iter 6 takes 1.302 seconds. Loss: 0.006
2025-08-23 15:27:18,545 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:18,545 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:18,561 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:18,708 - INFO -    RWR 耗时: 1.709 秒
2025-08-23 15:27:18,724 - INFO -    归一化耗时: 0.016 秒
2025-08-23 15:27:18,861 - INFO -    ✅ 完成，总耗时: 1.936 秒
2025-08-23 15:27:18,863 - INFO -   ✅ chr11: 完成，耗时 2.08 秒
2025-08-23 15:27:18,864 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-23 15:27:18,864 - INFO -    染色体 chr12 大小: 120,129,022 bp, bins: 6007
2025-08-23 15:27:18,866 - INFO -    数据形状: (3567, 3)
2025-08-23 15:27:18,866 - INFO -    bin 范围: 30-1199, 31-1199
2025-08-23 15:27:18,866 - INFO -    矩阵大小: (6007, 6007), 非零元素: 6,414, 稀疏度: 0.000178
2025-08-23 15:27:18,867 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:18,867 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-23 15:27:18,962 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:19,081 - INFO -    卷积耗时: 0.214 秒
2025-08-23 15:27:19,083 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0009)
2025-08-23 15:27:19,083 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-23 15:27:19,083 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-23 15:27:19,157 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-23 15:27:19,392 - INFO - 🔥 MPS Iter 1 takes 0.080 seconds. Loss: 3.620
2025-08-23 15:27:19,645 - INFO - 🔥 MPS Iter 2 takes 0.310 seconds. Loss: 0.640
2025-08-23 15:27:19,873 - INFO - 🔥 MPS Iter 3 takes 0.564 seconds. Loss: 0.167
2025-08-23 15:27:20,103 - INFO - 🔥 MPS Iter 4 takes 0.792 seconds. Loss: 0.050
2025-08-23 15:27:20,326 - INFO - 🔥 MPS Iter 5 takes 1.021 seconds. Loss: 0.017
2025-08-23 15:27:20,552 - INFO - 🔥 MPS Iter 6 takes 1.244 seconds. Loss: 0.006
2025-08-23 15:27:20,552 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:20,552 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:20,562 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:20,695 - INFO -    RWR 耗时: 1.614 秒
2025-08-23 15:27:20,713 - INFO -    归一化耗时: 0.017 秒
2025-08-23 15:27:20,845 - INFO -    ✅ 完成，总耗时: 1.845 秒
2025-08-23 15:27:20,847 - INFO -   ✅ chr12: 完成，耗时 1.98 秒
2025-08-23 15:27:20,847 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-23 15:27:20,848 - INFO -    染色体 chr13 大小: 120,421,639 bp, bins: 6022
2025-08-23 15:27:20,850 - INFO -    数据形状: (4460, 3)
2025-08-23 15:27:20,850 - INFO -    bin 范围: 30-1203, 30-1203
2025-08-23 15:27:20,850 - INFO -    矩阵大小: (6022, 6022), 非零元素: 8,094, 稀疏度: 0.000223
2025-08-23 15:27:20,851 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:20,851 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-23 15:27:20,939 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:21,063 - INFO -    卷积耗时: 0.212 秒
2025-08-23 15:27:21,064 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0011)
2025-08-23 15:27:21,064 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-23 15:27:21,064 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-23 15:27:21,139 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-23 15:27:21,373 - INFO - 🔥 MPS Iter 1 takes 0.082 seconds. Loss: 3.111
2025-08-23 15:27:21,626 - INFO - 🔥 MPS Iter 2 takes 0.310 seconds. Loss: 0.502
2025-08-23 15:27:21,860 - INFO - 🔥 MPS Iter 3 takes 0.563 seconds. Loss: 0.125
2025-08-23 15:27:22,091 - INFO - 🔥 MPS Iter 4 takes 0.796 seconds. Loss: 0.038
2025-08-23 15:27:22,318 - INFO - 🔥 MPS Iter 5 takes 1.028 seconds. Loss: 0.013
2025-08-23 15:27:22,548 - INFO - 🔥 MPS Iter 6 takes 1.255 seconds. Loss: 0.005
2025-08-23 15:27:22,549 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:22,549 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:22,558 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:22,695 - INFO -    RWR 耗时: 1.632 秒
2025-08-23 15:27:22,712 - INFO -    归一化耗时: 0.016 秒
2025-08-23 15:27:22,847 - INFO -    ✅ 完成，总耗时: 1.860 秒
2025-08-23 15:27:22,849 - INFO -   ✅ chr13: 完成，耗时 2.00 秒
2025-08-23 15:27:22,849 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-23 15:27:22,850 - INFO -    染色体 chr14 大小: 124,902,244 bp, bins: 6246
2025-08-23 15:27:22,852 - INFO -    数据形状: (3847, 3)
2025-08-23 15:27:22,852 - INFO -    bin 范围: 39-1247, 42-1247
2025-08-23 15:27:22,853 - INFO -    矩阵大小: (6246, 6246), 非零元素: 6,940, 稀疏度: 0.000178
2025-08-23 15:27:22,853 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:22,853 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-23 15:27:22,956 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:23,093 - INFO -    卷积耗时: 0.240 秒
2025-08-23 15:27:23,094 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0009)
2025-08-23 15:27:23,095 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-23 15:27:23,095 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-23 15:27:23,169 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-23 15:27:23,441 - INFO - 🔥 MPS Iter 1 takes 0.081 seconds. Loss: 3.748
2025-08-23 15:27:23,716 - INFO - 🔥 MPS Iter 2 takes 0.347 seconds. Loss: 0.728
2025-08-23 15:27:23,974 - INFO - 🔥 MPS Iter 3 takes 0.622 seconds. Loss: 0.210
2025-08-23 15:27:24,232 - INFO - 🔥 MPS Iter 4 takes 0.880 seconds. Loss: 0.068
2025-08-23 15:27:24,500 - INFO - 🔥 MPS Iter 5 takes 1.138 seconds. Loss: 0.024
2025-08-23 15:27:24,762 - INFO - 🔥 MPS Iter 6 takes 1.412 seconds. Loss: 0.009
2025-08-23 15:27:24,762 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:24,762 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:24,783 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:24,931 - INFO -    RWR 耗时: 1.837 秒
2025-08-23 15:27:24,950 - INFO -    归一化耗时: 0.019 秒
2025-08-23 15:27:25,082 - INFO -    ✅ 完成，总耗时: 2.096 秒
2025-08-23 15:27:25,084 - INFO -   ✅ chr14: 完成，耗时 2.23 秒
2025-08-23 15:27:25,084 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-23 15:27:25,085 - INFO -    染色体 chr15 大小: 104,043,685 bp, bins: 5203
2025-08-23 15:27:25,088 - INFO -    数据形状: (3201, 3)
2025-08-23 15:27:25,088 - INFO -    bin 范围: 31-1038, 31-1039
2025-08-23 15:27:25,089 - INFO -    矩阵大小: (5203, 5203), 非零元素: 5,718, 稀疏度: 0.000211
2025-08-23 15:27:25,089 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:25,089 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-23 15:27:25,139 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:25,241 - INFO -    卷积耗时: 0.152 秒
2025-08-23 15:27:25,242 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0011)
2025-08-23 15:27:25,242 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-23 15:27:25,242 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-23 15:27:25,302 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-23 15:27:25,459 - INFO - 🔥 MPS Iter 1 takes 0.065 seconds. Loss: 3.256
2025-08-23 15:27:25,604 - INFO - 🔥 MPS Iter 2 takes 0.217 seconds. Loss: 0.556
2025-08-23 15:27:25,753 - INFO - 🔥 MPS Iter 3 takes 0.362 seconds. Loss: 0.138
2025-08-23 15:27:25,900 - INFO - 🔥 MPS Iter 4 takes 0.511 seconds. Loss: 0.041
2025-08-23 15:27:26,049 - INFO - 🔥 MPS Iter 5 takes 0.659 seconds. Loss: 0.015
2025-08-23 15:27:26,197 - INFO - 🔥 MPS Iter 6 takes 0.808 seconds. Loss: 0.006
2025-08-23 15:27:26,198 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:26,198 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:26,202 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:26,312 - INFO -    RWR 耗时: 1.070 秒
2025-08-23 15:27:26,324 - INFO -    归一化耗时: 0.012 秒
2025-08-23 15:27:26,424 - INFO -    ✅ 完成，总耗时: 1.234 秒
2025-08-23 15:27:26,425 - INFO -   ✅ chr15: 完成，耗时 1.34 秒
2025-08-23 15:27:26,425 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-23 15:27:26,426 - INFO -    染色体 chr16 大小: 98,207,768 bp, bins: 4911
2025-08-23 15:27:26,427 - INFO -    数据形状: (3022, 3)
2025-08-23 15:27:26,428 - INFO -    bin 范围: 32-980, 32-980
2025-08-23 15:27:26,428 - INFO -    矩阵大小: (4911, 4911), 非零元素: 5,471, 稀疏度: 0.000227
2025-08-23 15:27:26,428 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:26,428 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-23 15:27:26,473 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:26,555 - INFO -    卷积耗时: 0.127 秒
2025-08-23 15:27:26,557 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0012)
2025-08-23 15:27:26,557 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-23 15:27:26,557 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-23 15:27:26,622 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-23 15:27:26,751 - INFO - 🔥 MPS Iter 1 takes 0.070 seconds. Loss: 2.977
2025-08-23 15:27:26,882 - INFO - 🔥 MPS Iter 2 takes 0.195 seconds. Loss: 0.498
2025-08-23 15:27:27,005 - INFO - 🔥 MPS Iter 3 takes 0.326 seconds. Loss: 0.122
2025-08-23 15:27:27,126 - INFO - 🔥 MPS Iter 4 takes 0.449 seconds. Loss: 0.036
2025-08-23 15:27:27,255 - INFO - 🔥 MPS Iter 5 takes 0.570 seconds. Loss: 0.013
2025-08-23 15:27:27,378 - INFO - 🔥 MPS Iter 6 takes 0.699 seconds. Loss: 0.005
2025-08-23 15:27:27,378 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:27,378 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:27,382 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:27,477 - INFO -    RWR 耗时: 0.921 秒
2025-08-23 15:27:27,488 - INFO -    归一化耗时: 0.010 秒
2025-08-23 15:27:27,582 - INFO -    ✅ 完成，总耗时: 1.059 秒
2025-08-23 15:27:27,583 - INFO -   ✅ chr16: 完成，耗时 1.16 秒
2025-08-23 15:27:27,583 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-23 15:27:27,583 - INFO -    染色体 chr17 大小: 94,987,271 bp, bins: 4750
2025-08-23 15:27:27,585 - INFO -    数据形状: (3109, 3)
2025-08-23 15:27:27,585 - INFO -    bin 范围: 30-948, 30-948
2025-08-23 15:27:27,586 - INFO -    矩阵大小: (4750, 4750), 非零元素: 5,587, 稀疏度: 0.000248
2025-08-23 15:27:27,586 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:27,586 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-23 15:27:27,630 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:27,716 - INFO -    卷积耗时: 0.130 秒
2025-08-23 15:27:27,717 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0012)
2025-08-23 15:27:27,717 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-23 15:27:27,717 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-23 15:27:27,770 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-23 15:27:27,885 - INFO - 🔥 MPS Iter 1 takes 0.058 seconds. Loss: 2.956
2025-08-23 15:27:27,995 - INFO - 🔥 MPS Iter 2 takes 0.170 seconds. Loss: 0.486
2025-08-23 15:27:28,107 - INFO - 🔥 MPS Iter 3 takes 0.279 seconds. Loss: 0.121
2025-08-23 15:27:28,218 - INFO - 🔥 MPS Iter 4 takes 0.392 seconds. Loss: 0.037
2025-08-23 15:27:28,329 - INFO - 🔥 MPS Iter 5 takes 0.502 seconds. Loss: 0.013
2025-08-23 15:27:28,440 - INFO - 🔥 MPS Iter 6 takes 0.613 seconds. Loss: 0.005
2025-08-23 15:27:28,440 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:28,440 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:28,444 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:28,533 - INFO -    RWR 耗时: 0.817 秒
2025-08-23 15:27:28,543 - INFO -    归一化耗时: 0.010 秒
2025-08-23 15:27:28,632 - INFO -    ✅ 完成，总耗时: 0.956 秒
2025-08-23 15:27:28,633 - INFO -   ✅ chr17: 完成，耗时 1.05 秒
2025-08-23 15:27:28,633 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-23 15:27:28,634 - INFO -    染色体 chr18 大小: 90,702,639 bp, bins: 4536
2025-08-23 15:27:28,635 - INFO -    数据形状: (3135, 3)
2025-08-23 15:27:28,635 - INFO -    bin 范围: 30-904, 30-905
2025-08-23 15:27:28,636 - INFO -    矩阵大小: (4536, 4536), 非零元素: 5,670, 稀疏度: 0.000276
2025-08-23 15:27:28,636 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:28,636 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-23 15:27:28,677 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:28,754 - INFO -    卷积耗时: 0.118 秒
2025-08-23 15:27:28,755 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0014)
2025-08-23 15:27:28,755 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-23 15:27:28,755 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-23 15:27:28,819 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-23 15:27:28,919 - INFO - 🔥 MPS Iter 1 takes 0.069 seconds. Loss: 2.796
2025-08-23 15:27:29,012 - INFO - 🔥 MPS Iter 2 takes 0.165 seconds. Loss: 0.455
2025-08-23 15:27:29,108 - INFO - 🔥 MPS Iter 3 takes 0.257 seconds. Loss: 0.112
2025-08-23 15:27:29,199 - INFO - 🔥 MPS Iter 4 takes 0.353 seconds. Loss: 0.034
2025-08-23 15:27:29,294 - INFO - 🔥 MPS Iter 5 takes 0.444 seconds. Loss: 0.012
2025-08-23 15:27:29,387 - INFO - 🔥 MPS Iter 6 takes 0.539 seconds. Loss: 0.005
2025-08-23 15:27:29,388 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:29,388 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:29,391 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:29,472 - INFO -    RWR 耗时: 0.718 秒
2025-08-23 15:27:29,481 - INFO -    归一化耗时: 0.009 秒
2025-08-23 15:27:29,562 - INFO -    ✅ 完成，总耗时: 0.845 秒
2025-08-23 15:27:29,563 - INFO -   ✅ chr18: 完成，耗时 0.93 秒
2025-08-23 15:27:29,563 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-23 15:27:29,564 - INFO -    染色体 chr19 大小: 61,431,566 bp, bins: 3072
2025-08-23 15:27:29,565 - INFO -    数据形状: (1977, 3)
2025-08-23 15:27:29,565 - INFO -    bin 范围: 31-613, 31-613
2025-08-23 15:27:29,565 - INFO -    矩阵大小: (3072, 3072), 非零元素: 3,525, 稀疏度: 0.000374
2025-08-23 15:27:29,566 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:29,566 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-23 15:27:29,596 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:29,632 - INFO -    卷积耗时: 0.066 秒
2025-08-23 15:27:29,633 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0019)
2025-08-23 15:27:29,633 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-23 15:27:29,633 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-23 15:27:29,688 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-23 15:27:29,727 - INFO - 🔥 MPS Iter 1 takes 0.061 seconds. Loss: 2.360
2025-08-23 15:27:29,758 - INFO - 🔥 MPS Iter 2 takes 0.096 seconds. Loss: 0.388
2025-08-23 15:27:29,789 - INFO - 🔥 MPS Iter 3 takes 0.126 seconds. Loss: 0.097
2025-08-23 15:27:29,819 - INFO - 🔥 MPS Iter 4 takes 0.157 seconds. Loss: 0.030
2025-08-23 15:27:29,850 - INFO - 🔥 MPS Iter 5 takes 0.187 seconds. Loss: 0.011
2025-08-23 15:27:29,881 - INFO - 🔥 MPS Iter 6 takes 0.219 seconds. Loss: 0.004
2025-08-23 15:27:29,882 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:27:29,882 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:29,884 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:29,922 - INFO -    RWR 耗时: 0.290 秒
2025-08-23 15:27:29,927 - INFO -    归一化耗时: 0.005 秒
2025-08-23 15:27:29,965 - INFO -    ✅ 完成，总耗时: 0.361 秒
2025-08-23 15:27:29,965 - INFO -   ✅ chr19: 完成，耗时 0.40 秒
2025-08-23 15:27:29,966 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-23 15:27:29,966 - INFO -    染色体 chrX 大小: 171,031,299 bp, bins: 8552
2025-08-23 15:27:29,968 - INFO -    数据形状: (2286, 3)
2025-08-23 15:27:29,968 - INFO -    bin 范围: 45-1699, 56-1699
2025-08-23 15:27:29,968 - INFO -    矩阵大小: (8552, 8552), 非零元素: 4,063, 稀疏度: 0.000056
2025-08-23 15:27:29,969 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:27:29,969 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-23 15:27:30,090 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:27:30,350 - INFO -    卷积耗时: 0.381 秒
2025-08-23 15:27:30,351 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0004)
2025-08-23 15:27:30,351 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-23 15:27:30,351 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-23 15:27:30,467 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-23 15:27:31,264 - INFO - 🔥 MPS Iter 1 takes 0.124 seconds. Loss: 5.970
2025-08-23 15:27:32,058 - INFO - 🔥 MPS Iter 2 takes 0.914 seconds. Loss: 1.407
2025-08-23 15:27:32,746 - INFO - 🔥 MPS Iter 3 takes 1.707 seconds. Loss: 0.457
2025-08-23 15:27:33,434 - INFO - 🔥 MPS Iter 4 takes 2.396 seconds. Loss: 0.163
2025-08-23 15:27:34,121 - INFO - 🔥 MPS Iter 5 takes 3.084 seconds. Loss: 0.066
2025-08-23 15:27:34,804 - INFO - 🔥 MPS Iter 6 takes 3.771 seconds. Loss: 0.028
2025-08-23 15:27:35,490 - INFO - 🔥 MPS Iter 7 takes 4.454 seconds. Loss: 0.012
2025-08-23 15:27:36,185 - INFO - 🔥 MPS Iter 8 takes 5.139 seconds. Loss: 0.005
2025-08-23 15:27:36,186 - INFO - ✅ Converged after 8 iterations
2025-08-23 15:27:36,186 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:27:36,250 - INFO - 🧹 GPU memory cleared
2025-08-23 15:27:36,513 - INFO -    RWR 耗时: 6.163 秒
2025-08-23 15:27:36,539 - INFO -    归一化耗时: 0.026 秒
2025-08-23 15:27:36,703 - INFO -    ✅ 完成，总耗时: 6.570 秒
2025-08-23 15:27:36,734 - INFO -   ✅ chrX: 完成，耗时 6.77 秒
2025-08-23 15:27:36,734 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 1.0 分钟
2025-08-23 15:27:36,734 - INFO - 📦 批次完成: 20 成功, 0 失败, 耗时 1.0 分钟
2025-08-23 15:27:36,734 - INFO - 🎊 Stage E70 完成: 20 个矩阵成功, 0 个失败
2025-08-23 15:27:36,734 - INFO -    总耗时: 0.02 小时
2025-08-23 15:27:36,735 - INFO - 
============================================================
2025-08-23 15:27:36,735 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:27:36,735 - INFO - 📊 总计: 20 个矩阵成功, 0 个失败
2025-08-23 15:27:36,735 - INFO - ⏱️  总耗时: 0.02 小时
2025-08-23 15:27:36,735 - INFO - 💡 M4 MPS 加速比: 18.8x
2025-08-23 15:27:36,735 - INFO - 💡 预计节省时间: 0.0 小时 (相比 M4 CPU)
2025-08-23 15:27:36,735 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:31:27,210 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:31:27,220 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:31:27,220 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:31:27,220 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:31:27,220 - INFO - 🔧 使用 MPS: True
2025-08-23 15:31:27,220 - INFO - 🎯 处理 stages: ['E70', 'E75', 'E80', 'E85', 'E95', 'EX05', 'EX15']
2025-08-23 15:31:27,220 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:31:27,387 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:31:28,147 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:31:28,147 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:31:28,147 - INFO - 
==================================================
2025-08-23 15:31:28,147 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:31:28,147 - INFO - ==================================================
2025-08-23 15:31:28,149 - INFO - 🗂️  Stage E70: 发现 557 个细胞
2025-08-23 15:31:28,149 - INFO - 📦 大数据集检测，使用 M4 优化批次大小: 10
2025-08-23 15:31:28,149 - INFO - 📦 M4 批次处理 1: 细胞 1-10/557
2025-08-23 15:31:28,149 - INFO - 📊 处理: GasfE703153 (1/557)
2025-08-23 15:31:28,149 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:31:28,149 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 15:31:28,149 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 15:31:28,149 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 15:31:28,149 - INFO - 📊 处理: GasfE703154 (2/557)
2025-08-23 15:31:28,149 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:31:28,159 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-23 15:31:28,160 - INFO -    染色体 chr1 大小: 195,471,971 bp, bins: 9774
2025-08-23 15:31:28,162 - INFO -    数据形状: (4208, 3)
2025-08-23 15:31:28,162 - INFO -    bin 范围: 30-1947, 30-1953
2025-08-23 15:31:28,163 - INFO -    矩阵大小: (9774, 9774), 非零元素: 7,744, 稀疏度: 0.000081
2025-08-23 15:31:28,164 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:31:28,164 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-23 15:31:28,358 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:31:28,673 - INFO -    卷积耗时: 0.509 秒
2025-08-23 15:31:28,674 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0006)
2025-08-23 15:31:28,674 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-23 15:31:28,674 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-23 15:31:28,780 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-23 15:31:29,996 - INFO - 🔥 MPS Iter 1 takes 0.116 seconds. Loss: 4.687
2025-08-23 15:31:31,242 - INFO - 🔥 MPS Iter 2 takes 1.329 seconds. Loss: 0.858
2025-08-23 15:31:32,370 - INFO - 🔥 MPS Iter 3 takes 2.568 seconds. Loss: 0.198
2025-08-23 15:31:33,514 - INFO - 🔥 MPS Iter 4 takes 3.697 seconds. Loss: 0.050
2025-08-23 15:31:34,624 - INFO - 🔥 MPS Iter 5 takes 4.840 seconds. Loss: 0.014
2025-08-23 15:31:35,772 - INFO - 🔥 MPS Iter 6 takes 5.951 seconds. Loss: 0.005
2025-08-23 15:31:35,773 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:31:35,773 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:31:35,845 - INFO - 🧹 GPU memory cleared
2025-08-23 15:31:36,218 - INFO -    RWR 耗时: 7.545 秒
2025-08-23 15:31:36,260 - INFO -    归一化耗时: 0.042 秒
2025-08-23 15:31:36,614 - INFO -    ✅ 完成，总耗时: 8.096 秒
2025-08-23 15:31:36,616 - INFO -   ✅ chr1: 完成，耗时 8.46 秒
2025-08-23 15:31:36,616 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-23 15:31:36,617 - INFO -    染色体 chr2 大小: 182,113,224 bp, bins: 9106
2025-08-23 15:31:36,635 - INFO -    数据形状: (3686, 3)
2025-08-23 15:31:36,635 - INFO -    bin 范围: 30-1818, 33-1820
2025-08-23 15:31:36,636 - INFO -    矩阵大小: (9106, 9106), 非零元素: 6,694, 稀疏度: 0.000081
2025-08-23 15:31:36,636 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:31:36,636 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-23 15:31:36,755 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:31:37,022 - INFO -    卷积耗时: 0.386 秒
2025-08-23 15:31:37,023 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0006)
2025-08-23 15:31:37,023 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-23 15:31:37,024 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-23 15:31:37,116 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-23 15:31:38,058 - INFO - 🔥 MPS Iter 1 takes 0.100 seconds. Loss: 4.785
2025-08-23 15:31:38,977 - INFO - 🔥 MPS Iter 2 takes 1.035 seconds. Loss: 0.909
2025-08-23 15:31:39,854 - INFO - 🔥 MPS Iter 3 takes 1.954 seconds. Loss: 0.220
2025-08-23 15:31:40,737 - INFO - 🔥 MPS Iter 4 takes 2.832 seconds. Loss: 0.058
2025-08-23 15:31:41,622 - INFO - 🔥 MPS Iter 5 takes 3.715 seconds. Loss: 0.017
2025-08-23 15:31:42,506 - INFO - 🔥 MPS Iter 6 takes 4.599 seconds. Loss: 0.006
2025-08-23 15:31:42,507 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:31:42,507 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:31:42,534 - INFO - 🧹 GPU memory cleared
2025-08-23 15:31:42,859 - INFO -    RWR 耗时: 5.837 秒
2025-08-23 15:31:42,896 - INFO -    归一化耗时: 0.037 秒
2025-08-23 15:31:43,207 - INFO -    ✅ 完成，总耗时: 6.260 秒
2025-08-23 15:31:43,210 - INFO -   ✅ chr2: 完成，耗时 6.59 秒
2025-08-23 15:31:43,210 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-23 15:31:43,211 - INFO -    染色体 chr3 大小: 160,039,680 bp, bins: 8002
2025-08-23 15:31:43,227 - INFO -    数据形状: (3112, 3)
2025-08-23 15:31:43,227 - INFO -    bin 范围: 30-1598, 30-1599
2025-08-23 15:31:43,228 - INFO -    矩阵大小: (8002, 8002), 非零元素: 5,680, 稀疏度: 0.000089
2025-08-23 15:31:43,228 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:31:43,228 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-23 15:31:43,322 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:31:43,528 - INFO -    卷积耗时: 0.300 秒
2025-08-23 15:31:43,529 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0007)
2025-08-23 15:31:43,529 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-23 15:31:43,529 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-23 15:31:43,607 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-23 15:33:38,319 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:33:38,328 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:33:38,328 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:33:38,328 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:33:38,328 - INFO - 🔧 使用 MPS: True
2025-08-23 15:33:38,328 - INFO - 🎯 处理 stages: ['E70', 'E75', 'E80', 'E85', 'E95', 'EX05', 'EX15']
2025-08-23 15:33:38,328 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:33:38,478 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:33:39,202 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:33:39,202 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:33:39,202 - INFO - 
==================================================
2025-08-23 15:33:39,202 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:33:39,202 - INFO - ==================================================
2025-08-23 15:33:39,203 - INFO - 🗂️  Stage E70: 发现 557 个细胞
2025-08-23 15:33:39,203 - INFO - 📦 大数据集检测，使用 M4 优化批次大小: 10
2025-08-23 15:33:39,203 - INFO - 📦 M4 批次处理 1: 细胞 1-10/557
2025-08-23 15:33:39,203 - INFO - 📊 处理: GasfE703153 (1/557)
2025-08-23 15:33:39,203 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:33:39,203 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 15:33:39,203 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 15:33:39,204 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 15:33:39,204 - INFO - 📊 处理: GasfE703154 (2/557)
2025-08-23 15:33:39,204 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:33:39,204 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:33:39,204 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:33:39,209 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-23 15:33:39,210 - INFO -    染色体 chr3 大小: 160,039,680 bp, bins: 8002
2025-08-23 15:33:39,210 - INFO -    数据形状: (3112, 3)
2025-08-23 15:33:39,211 - INFO -    bin 范围: 30-1598, 30-1599
2025-08-23 15:33:39,211 - INFO -    矩阵大小: (8002, 8002), 非零元素: 5,680, 稀疏度: 0.000089
2025-08-23 15:33:39,211 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:33:39,211 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-23 15:33:39,362 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:33:39,571 - INFO -    卷积耗时: 0.360 秒
2025-08-23 15:33:39,573 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0007)
2025-08-23 15:33:39,573 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-23 15:33:39,573 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-23 15:33:39,651 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-23 15:33:40,251 - INFO - 🔥 MPS Iter 1 takes 0.087 seconds. Loss: 4.526
2025-08-23 15:33:40,820 - INFO - 🔥 MPS Iter 2 takes 0.682 seconds. Loss: 0.863
2025-08-23 15:33:41,394 - INFO - 🔥 MPS Iter 3 takes 1.247 seconds. Loss: 0.208
2025-08-23 15:33:41,963 - INFO - 🔥 MPS Iter 4 takes 1.822 seconds. Loss: 0.053
2025-08-23 15:37:26,623 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:37:26,632 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:37:26,632 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:37:26,632 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:37:26,632 - INFO - 🔧 使用 MPS: True
2025-08-23 15:37:26,633 - INFO - 🎯 处理 stages: ['E70', 'E75', 'E80', 'E85', 'E95', 'EX05', 'EX15']
2025-08-23 15:37:26,633 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:37:26,763 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:37:27,437 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:37:27,437 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:37:27,437 - INFO - 
==================================================
2025-08-23 15:37:27,437 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:37:27,437 - INFO - ==================================================
2025-08-23 15:37:27,439 - INFO - 🗂️  Stage E70: 发现 557 个细胞
2025-08-23 15:37:27,439 - INFO - 📦 大数据集检测，使用 M4 优化批次大小: 10
2025-08-23 15:37:27,439 - INFO - 📦 M4 批次处理 1: 细胞 1-10/557
2025-08-23 15:37:27,439 - INFO - 📊 处理: GasfE703153 (1/557)
2025-08-23 15:37:27,439 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:37:27,439 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 15:37:27,439 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 15:37:27,440 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 15:37:27,440 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 15:37:27,440 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 15:37:27,440 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 15:37:27,440 - INFO - 📊 处理: GasfE703154 (2/557)
2025-08-23 15:37:27,440 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:37:27,440 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:37:27,440 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:37:27,440 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-23 15:37:27,441 - INFO -    染色体 chr3 大小: 160,039,680 bp, bins: 8002
2025-08-23 15:37:27,442 - INFO -    数据形状: (3112, 3)
2025-08-23 15:37:27,442 - INFO -    bin 范围: 30-1598, 30-1599
2025-08-23 15:37:27,442 - INFO -    矩阵大小: (8002, 8002), 非零元素: 5,680, 稀疏度: 0.000089
2025-08-23 15:37:27,443 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:37:27,443 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-23 15:37:27,590 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:37:27,796 - INFO -    卷积耗时: 0.354 秒
2025-08-23 15:37:27,798 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0007)
2025-08-23 15:37:27,798 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-23 15:37:27,798 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-23 15:37:27,880 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-23 15:37:28,479 - INFO - 🔥 MPS Iter 1 takes 0.092 seconds. Loss: 4.526
2025-08-23 15:37:29,042 - INFO - 🔥 MPS Iter 2 takes 0.685 seconds. Loss: 0.863
2025-08-23 15:37:29,612 - INFO - 🔥 MPS Iter 3 takes 1.245 seconds. Loss: 0.208
2025-08-23 15:37:30,179 - INFO - 🔥 MPS Iter 4 takes 1.815 seconds. Loss: 0.053
2025-08-23 15:37:30,753 - INFO - 🔥 MPS Iter 5 takes 2.382 seconds. Loss: 0.016
2025-08-23 15:37:31,327 - INFO - 🔥 MPS Iter 6 takes 2.956 seconds. Loss: 0.005
2025-08-23 15:37:31,328 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:37:31,328 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:37:31,341 - INFO - 🧹 GPU memory cleared
2025-08-23 15:37:31,581 - INFO -    RWR 耗时: 3.785 秒
2025-08-23 15:37:31,609 - INFO -    归一化耗时: 0.028 秒
2025-08-23 15:37:31,850 - INFO -    ✅ 完成，总耗时: 4.166 秒
2025-08-23 15:37:31,852 - INFO -   ✅ chr3: 完成，耗时 4.41 秒
2025-08-23 15:37:31,852 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-23 15:37:31,853 - INFO -    染色体 chr4 大小: 156,508,116 bp, bins: 7826
2025-08-23 15:37:31,871 - INFO -    数据形状: (2911, 3)
2025-08-23 15:37:31,871 - INFO -    bin 范围: 30-1563, 32-1563
2025-08-23 15:37:31,872 - INFO -    矩阵大小: (7826, 7826), 非零元素: 5,309, 稀疏度: 0.000087
2025-08-23 15:37:31,872 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:37:31,872 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-23 15:37:31,964 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:37:32,163 - INFO -    卷积耗时: 0.291 秒
2025-08-23 15:37:32,165 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0007)
2025-08-23 15:37:32,165 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-23 15:37:32,165 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-23 15:37:32,251 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-23 15:37:32,812 - INFO - 🔥 MPS Iter 1 takes 0.094 seconds. Loss: 4.648
2025-08-23 15:37:33,342 - INFO - 🔥 MPS Iter 2 takes 0.648 seconds. Loss: 0.891
2025-08-23 15:37:33,869 - INFO - 🔥 MPS Iter 3 takes 1.178 seconds. Loss: 0.217
2025-08-23 15:37:34,403 - INFO - 🔥 MPS Iter 4 takes 1.704 seconds. Loss: 0.056
2025-08-23 15:37:34,941 - INFO - 🔥 MPS Iter 5 takes 2.239 seconds. Loss: 0.017
2025-08-23 15:37:35,457 - INFO - 🔥 MPS Iter 6 takes 2.777 seconds. Loss: 0.005
2025-08-23 15:37:35,458 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:37:35,458 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:37:35,480 - INFO - 🧹 GPU memory cleared
2025-08-23 15:37:35,704 - INFO -    RWR 耗时: 3.540 秒
2025-08-23 15:37:35,731 - INFO -    归一化耗时: 0.027 秒
2025-08-23 15:37:35,953 - INFO -    ✅ 完成，总耗时: 3.858 秒
2025-08-23 15:37:35,955 - INFO -   ✅ chr4: 完成，耗时 4.10 秒
2025-08-23 15:37:35,955 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-23 15:37:35,956 - INFO -    染色体 chr5 大小: 151,834,684 bp, bins: 7592
2025-08-23 15:37:35,971 - INFO -    数据形状: (3058, 3)
2025-08-23 15:37:35,971 - INFO -    bin 范围: 30-1516, 32-1516
2025-08-23 15:37:35,971 - INFO -    矩阵大小: (7592, 7592), 非零元素: 5,586, 稀疏度: 0.000097
2025-08-23 15:37:35,972 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:37:35,972 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-23 15:37:36,043 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:37:36,232 - INFO -    卷积耗时: 0.260 秒
2025-08-23 15:37:36,233 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0007)
2025-08-23 15:37:36,233 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-23 15:37:36,233 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-23 15:37:36,307 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-23 15:37:36,805 - INFO - 🔥 MPS Iter 1 takes 0.082 seconds. Loss: 4.328
2025-08-23 15:37:37,270 - INFO - 🔥 MPS Iter 2 takes 0.572 seconds. Loss: 0.791
2025-08-23 15:37:37,732 - INFO - 🔥 MPS Iter 3 takes 1.037 seconds. Loss: 0.188
2025-08-23 15:37:38,201 - INFO - 🔥 MPS Iter 4 takes 1.499 seconds. Loss: 0.047
2025-08-23 15:37:56,320 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:37:56,330 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:37:56,330 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:37:56,330 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:37:56,330 - INFO - 🔧 使用 MPS: True
2025-08-23 15:37:56,330 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:37:56,330 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:37:56,453 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:37:57,155 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:37:57,155 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:37:57,155 - INFO - 
==================================================
2025-08-23 15:37:57,155 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:37:57,155 - INFO - ==================================================
2025-08-23 15:37:57,156 - INFO - 🗂️  Stage E70: 发现 2 个细胞
2025-08-23 15:37:57,156 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:37:57,156 - INFO - 📦 M4 批次处理 1: 细胞 1-2/2
2025-08-23 15:37:57,156 - INFO - 📊 处理: GasfE703153 (1/2)
2025-08-23 15:37:57,156 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:37:57,156 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:37:57,156 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:37:57,156 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 15:37:57,157 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 15:37:57,157 - INFO - 📊 处理: GasfE703154 (2/2)
2025-08-23 15:37:57,157 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:37:57,157 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:37:57,157 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:37:57,158 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-23 15:37:57,159 - INFO -    染色体 chr5 大小: 151,834,684 bp, bins: 7592
2025-08-23 15:37:57,159 - INFO -    数据形状: (3058, 3)
2025-08-23 15:37:57,159 - INFO -    bin 范围: 30-1516, 32-1516
2025-08-23 15:37:57,160 - INFO -    矩阵大小: (7592, 7592), 非零元素: 5,586, 稀疏度: 0.000097
2025-08-23 15:37:57,160 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:37:57,160 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-23 15:37:57,308 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:37:57,498 - INFO -    卷积耗时: 0.338 秒
2025-08-23 15:37:57,500 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0007)
2025-08-23 15:37:57,500 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-23 15:37:57,500 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-23 15:37:57,588 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-23 15:37:58,087 - INFO - 🔥 MPS Iter 1 takes 0.098 seconds. Loss: 4.328
2025-08-23 15:37:58,565 - INFO - 🔥 MPS Iter 2 takes 0.591 seconds. Loss: 0.791
2025-08-23 15:37:59,029 - INFO - 🔥 MPS Iter 3 takes 1.066 seconds. Loss: 0.188
2025-08-23 15:37:59,507 - INFO - 🔥 MPS Iter 4 takes 1.530 seconds. Loss: 0.047
2025-08-23 15:37:59,989 - INFO - 🔥 MPS Iter 5 takes 2.008 seconds. Loss: 0.014
2025-08-23 15:38:00,461 - INFO - 🔥 MPS Iter 6 takes 2.490 seconds. Loss: 0.004
2025-08-23 15:38:00,462 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:00,462 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:00,473 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:00,695 - INFO -    RWR 耗时: 3.196 秒
2025-08-23 15:38:00,721 - INFO -    归一化耗时: 0.026 秒
2025-08-23 15:38:00,925 - INFO -    ✅ 完成，总耗时: 3.560 秒
2025-08-23 15:38:00,926 - INFO -   ✅ chr5: 完成，耗时 3.77 秒
2025-08-23 15:38:00,926 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-23 15:38:00,927 - INFO -    染色体 chr6 大小: 149,736,546 bp, bins: 7487
2025-08-23 15:38:00,946 - INFO -    数据形状: (2980, 3)
2025-08-23 15:38:00,946 - INFO -    bin 范围: 32-1492, 32-1495
2025-08-23 15:38:00,947 - INFO -    矩阵大小: (7487, 7487), 非零元素: 5,439, 稀疏度: 0.000097
2025-08-23 15:38:00,947 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:00,947 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-23 15:38:01,039 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:01,234 - INFO -    卷积耗时: 0.287 秒
2025-08-23 15:38:01,236 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0008)
2025-08-23 15:38:01,236 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-23 15:38:01,236 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-23 15:38:01,309 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-23 15:38:01,816 - INFO - 🔥 MPS Iter 1 takes 0.082 seconds. Loss: 4.366
2025-08-23 15:38:02,302 - INFO - 🔥 MPS Iter 2 takes 0.582 seconds. Loss: 0.837
2025-08-23 15:38:02,778 - INFO - 🔥 MPS Iter 3 takes 1.068 seconds. Loss: 0.200
2025-08-23 15:38:03,255 - INFO - 🔥 MPS Iter 4 takes 1.543 seconds. Loss: 0.051
2025-08-23 15:38:03,724 - INFO - 🔥 MPS Iter 5 takes 2.020 seconds. Loss: 0.015
2025-08-23 15:38:04,189 - INFO - 🔥 MPS Iter 6 takes 2.490 seconds. Loss: 0.005
2025-08-23 15:38:04,190 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:04,190 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:04,212 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:04,421 - INFO -    RWR 耗时: 3.186 秒
2025-08-23 15:38:04,443 - INFO -    归一化耗时: 0.022 秒
2025-08-23 15:38:04,650 - INFO -    ✅ 完成，总耗时: 3.495 秒
2025-08-23 15:38:04,652 - INFO -   ✅ chr6: 完成，耗时 3.73 秒
2025-08-23 15:38:04,652 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-23 15:38:04,653 - INFO -    染色体 chr7 大小: 145,441,459 bp, bins: 7273
2025-08-23 15:38:04,670 - INFO -    数据形状: (2875, 3)
2025-08-23 15:38:04,670 - INFO -    bin 范围: 31-1452, 31-1453
2025-08-23 15:38:04,670 - INFO -    矩阵大小: (7273, 7273), 非零元素: 5,272, 稀疏度: 0.000100
2025-08-23 15:38:04,670 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:04,670 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-23 15:38:04,742 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:04,926 - INFO -    卷积耗时: 0.255 秒
2025-08-23 15:38:04,927 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0008)
2025-08-23 15:38:04,927 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-23 15:38:04,927 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-23 15:38:05,001 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-23 15:38:05,470 - INFO - 🔥 MPS Iter 1 takes 0.082 seconds. Loss: 4.278
2025-08-23 15:38:05,903 - INFO - 🔥 MPS Iter 2 takes 0.544 seconds. Loss: 0.833
2025-08-23 15:38:06,350 - INFO - 🔥 MPS Iter 3 takes 0.976 seconds. Loss: 0.211
2025-08-23 15:38:06,784 - INFO - 🔥 MPS Iter 4 takes 1.423 seconds. Loss: 0.056
2025-08-23 15:38:07,228 - INFO - 🔥 MPS Iter 5 takes 1.857 seconds. Loss: 0.017
2025-08-23 15:38:07,659 - INFO - 🔥 MPS Iter 6 takes 2.302 seconds. Loss: 0.005
2025-08-23 15:38:07,659 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:07,659 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:07,673 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:07,870 - INFO -    RWR 耗时: 2.944 秒
2025-08-23 15:38:07,897 - INFO -    归一化耗时: 0.027 秒
2025-08-23 15:38:08,081 - INFO -    ✅ 完成，总耗时: 3.226 秒
2025-08-23 15:38:08,083 - INFO -   ✅ chr7: 完成，耗时 3.43 秒
2025-08-23 15:38:08,083 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-23 15:38:08,084 - INFO -    染色体 chr8 大小: 129,401,213 bp, bins: 6471
2025-08-23 15:38:08,098 - INFO -    数据形状: (2655, 3)
2025-08-23 15:38:08,099 - INFO -    bin 范围: 30-1289, 31-1292
2025-08-23 15:38:08,099 - INFO -    矩阵大小: (6471, 6471), 非零元素: 4,827, 稀疏度: 0.000115
2025-08-23 15:38:08,099 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:08,099 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-23 15:38:08,174 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:08,311 - INFO -    卷积耗时: 0.212 秒
2025-08-23 15:38:08,313 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0009)
2025-08-23 15:38:08,313 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-23 15:38:08,313 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-23 15:38:08,390 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-23 15:38:08,694 - INFO - 🔥 MPS Iter 1 takes 0.083 seconds. Loss: 4.000
2025-08-23 15:38:09,011 - INFO - 🔥 MPS Iter 2 takes 0.382 seconds. Loss: 0.767
2025-08-23 15:38:09,309 - INFO - 🔥 MPS Iter 3 takes 0.699 seconds. Loss: 0.186
2025-08-23 15:38:09,602 - INFO - 🔥 MPS Iter 4 takes 0.997 seconds. Loss: 0.048
2025-08-23 15:38:09,894 - INFO - 🔥 MPS Iter 5 takes 1.290 seconds. Loss: 0.014
2025-08-23 15:38:10,190 - INFO - 🔥 MPS Iter 6 takes 1.582 seconds. Loss: 0.004
2025-08-23 15:38:10,191 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:10,191 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:10,200 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:10,360 - INFO -    RWR 耗时: 2.048 秒
2025-08-23 15:38:10,380 - INFO -    归一化耗时: 0.020 秒
2025-08-23 15:38:10,541 - INFO -    ✅ 完成，总耗时: 2.280 秒
2025-08-23 15:38:10,543 - INFO -   ✅ chr8: 完成，耗时 2.46 秒
2025-08-23 15:38:10,543 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-23 15:38:10,544 - INFO -    染色体 chr9 大小: 124,595,110 bp, bins: 6230
2025-08-23 15:38:10,556 - INFO -    数据形状: (2521, 3)
2025-08-23 15:38:10,556 - INFO -    bin 范围: 30-1243, 30-1243
2025-08-23 15:38:10,556 - INFO -    矩阵大小: (6230, 6230), 非零元素: 4,572, 稀疏度: 0.000118
2025-08-23 15:38:10,557 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:10,557 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-23 15:38:10,631 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:10,766 - INFO -    卷积耗时: 0.210 秒
2025-08-23 15:38:10,768 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0009)
2025-08-23 15:38:10,768 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-23 15:38:10,768 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-23 15:38:10,843 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-23 15:38:11,113 - INFO - 🔥 MPS Iter 1 takes 0.082 seconds. Loss: 3.968
2025-08-23 15:38:11,397 - INFO - 🔥 MPS Iter 2 takes 0.347 seconds. Loss: 0.750
2025-08-23 15:38:11,650 - INFO - 🔥 MPS Iter 3 takes 0.631 seconds. Loss: 0.181
2025-08-23 15:38:11,911 - INFO - 🔥 MPS Iter 4 takes 0.883 seconds. Loss: 0.047
2025-08-23 15:38:12,167 - INFO - 🔥 MPS Iter 5 takes 1.144 seconds. Loss: 0.014
2025-08-23 15:38:12,428 - INFO - 🔥 MPS Iter 6 takes 1.400 seconds. Loss: 0.004
2025-08-23 15:38:12,429 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:12,429 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:12,438 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:12,586 - INFO -    RWR 耗时: 1.820 秒
2025-08-23 15:38:12,604 - INFO -    归一化耗时: 0.018 秒
2025-08-23 15:38:12,750 - INFO -    ✅ 完成，总耗时: 2.047 秒
2025-08-23 15:38:12,752 - INFO -   ✅ chr9: 完成，耗时 2.21 秒
2025-08-23 15:38:12,752 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-23 15:38:12,753 - INFO -    染色体 chr10 大小: 130,694,993 bp, bins: 6535
2025-08-23 15:38:12,764 - INFO -    数据形状: (2558, 3)
2025-08-23 15:38:12,765 - INFO -    bin 范围: 31-1301, 31-1305
2025-08-23 15:38:12,765 - INFO -    矩阵大小: (6535, 6535), 非零元素: 4,672, 稀疏度: 0.000109
2025-08-23 15:38:12,765 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:12,765 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-23 15:38:12,872 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:13,036 - INFO -    卷积耗时: 0.271 秒
2025-08-23 15:38:13,038 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0008)
2025-08-23 15:38:13,038 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-23 15:38:13,038 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-23 15:38:13,118 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-23 15:38:13,445 - INFO - 🔥 MPS Iter 1 takes 0.089 seconds. Loss: 4.096
2025-08-23 15:38:13,774 - INFO - 🔥 MPS Iter 2 takes 0.407 seconds. Loss: 0.783
2025-08-23 15:38:14,073 - INFO - 🔥 MPS Iter 3 takes 0.737 seconds. Loss: 0.191
2025-08-23 15:38:14,378 - INFO - 🔥 MPS Iter 4 takes 1.035 seconds. Loss: 0.050
2025-08-23 15:38:14,679 - INFO - 🔥 MPS Iter 5 takes 1.341 seconds. Loss: 0.015
2025-08-23 15:38:14,983 - INFO - 🔥 MPS Iter 6 takes 1.642 seconds. Loss: 0.005
2025-08-23 15:38:14,984 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:14,984 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:15,003 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:15,181 - INFO -    RWR 耗时: 2.144 秒
2025-08-23 15:38:15,201 - INFO -    归一化耗时: 0.020 秒
2025-08-23 15:38:15,359 - INFO -    ✅ 完成，总耗时: 2.435 秒
2025-08-23 15:38:15,362 - INFO -   ✅ chr10: 完成，耗时 2.61 秒
2025-08-23 15:38:15,362 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-23 15:38:15,363 - INFO -    染色体 chr11 大小: 122,082,543 bp, bins: 6105
2025-08-23 15:38:15,375 - INFO -    数据形状: (2459, 3)
2025-08-23 15:38:15,375 - INFO -    bin 范围: 31-1217, 31-1219
2025-08-23 15:38:15,375 - INFO -    矩阵大小: (6105, 6105), 非零元素: 4,451, 稀疏度: 0.000119
2025-08-23 15:38:15,375 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:15,376 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-23 15:38:15,432 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:15,554 - INFO -    卷积耗时: 0.178 秒
2025-08-23 15:38:15,555 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0009)
2025-08-23 15:38:15,555 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-23 15:38:15,555 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-23 15:38:15,631 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-23 15:38:15,887 - INFO - 🔥 MPS Iter 1 takes 0.084 seconds. Loss: 3.973
2025-08-23 15:38:16,149 - INFO - 🔥 MPS Iter 2 takes 0.333 seconds. Loss: 0.753
2025-08-23 15:38:16,392 - INFO - 🔥 MPS Iter 3 takes 0.594 seconds. Loss: 0.183
2025-08-23 15:38:16,642 - INFO - 🔥 MPS Iter 4 takes 0.838 seconds. Loss: 0.047
2025-08-23 15:38:16,886 - INFO - 🔥 MPS Iter 5 takes 1.087 seconds. Loss: 0.014
2025-08-23 15:38:17,128 - INFO - 🔥 MPS Iter 6 takes 1.332 seconds. Loss: 0.004
2025-08-23 15:38:17,129 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:17,129 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:17,141 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:17,298 - INFO -    RWR 耗时: 1.743 秒
2025-08-23 15:38:17,316 - INFO -    归一化耗时: 0.018 秒
2025-08-23 15:38:17,454 - INFO -    ✅ 完成，总耗时: 1.940 秒
2025-08-23 15:38:17,456 - INFO -   ✅ chr11: 完成，耗时 2.09 秒
2025-08-23 15:38:17,456 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-23 15:38:17,457 - INFO -    染色体 chr12 大小: 120,129,022 bp, bins: 6007
2025-08-23 15:38:17,467 - INFO -    数据形状: (2311, 3)
2025-08-23 15:38:17,467 - INFO -    bin 范围: 30-1198, 33-1200
2025-08-23 15:38:17,468 - INFO -    矩阵大小: (6007, 6007), 非零元素: 4,253, 稀疏度: 0.000118
2025-08-23 15:38:17,468 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:17,468 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-23 15:38:17,547 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:17,674 - INFO -    卷积耗时: 0.206 秒
2025-08-23 15:38:17,676 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0009)
2025-08-23 15:38:17,676 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-23 15:38:17,676 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-23 15:38:17,733 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-23 15:38:17,977 - INFO - 🔥 MPS Iter 1 takes 0.062 seconds. Loss: 4.002
2025-08-23 15:38:18,244 - INFO - 🔥 MPS Iter 2 takes 0.303 seconds. Loss: 0.768
2025-08-23 15:38:18,470 - INFO - 🔥 MPS Iter 3 takes 0.569 seconds. Loss: 0.193
2025-08-23 15:38:18,696 - INFO - 🔥 MPS Iter 4 takes 0.795 seconds. Loss: 0.051
2025-08-23 15:38:18,926 - INFO - 🔥 MPS Iter 5 takes 1.022 seconds. Loss: 0.016
2025-08-23 15:38:19,157 - INFO - 🔥 MPS Iter 6 takes 1.251 seconds. Loss: 0.005
2025-08-23 15:38:19,157 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:19,157 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:19,179 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:19,315 - INFO -    RWR 耗时: 1.640 秒
2025-08-23 15:38:19,332 - INFO -    归一化耗时: 0.018 秒
2025-08-23 15:38:19,468 - INFO -    ✅ 完成，总耗时: 1.864 秒
2025-08-23 15:38:19,470 - INFO -   ✅ chr12: 完成，耗时 2.01 秒
2025-08-23 15:38:19,470 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-23 15:38:19,471 - INFO -    染色体 chr13 大小: 120,421,639 bp, bins: 6022
2025-08-23 15:38:19,481 - INFO -    数据形状: (2281, 3)
2025-08-23 15:38:19,481 - INFO -    bin 范围: 31-1197, 31-1203
2025-08-23 15:38:19,482 - INFO -    矩阵大小: (6022, 6022), 非零元素: 4,137, 稀疏度: 0.000114
2025-08-23 15:38:19,482 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:19,482 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-23 15:38:19,535 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:19,660 - INFO -    卷积耗时: 0.178 秒
2025-08-23 15:38:19,661 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0009)
2025-08-23 15:38:19,661 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-23 15:38:19,661 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-23 15:38:19,722 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-23 15:38:19,963 - INFO - 🔥 MPS Iter 1 takes 0.068 seconds. Loss: 4.108
2025-08-23 15:38:20,228 - INFO - 🔥 MPS Iter 2 takes 0.303 seconds. Loss: 0.806
2025-08-23 15:38:20,459 - INFO - 🔥 MPS Iter 3 takes 0.567 seconds. Loss: 0.206
2025-08-23 15:38:20,691 - INFO - 🔥 MPS Iter 4 takes 0.799 seconds. Loss: 0.056
2025-08-23 15:38:20,919 - INFO - 🔥 MPS Iter 5 takes 1.030 seconds. Loss: 0.017
2025-08-23 15:38:21,146 - INFO - 🔥 MPS Iter 6 takes 1.258 seconds. Loss: 0.006
2025-08-23 15:38:21,147 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:21,147 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:21,172 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:21,312 - INFO -    RWR 耗时: 1.651 秒
2025-08-23 15:38:21,330 - INFO -    归一化耗时: 0.018 秒
2025-08-23 15:38:21,466 - INFO -    ✅ 完成，总耗时: 1.847 秒
2025-08-23 15:38:21,468 - INFO -   ✅ chr13: 完成，耗时 2.00 秒
2025-08-23 15:38:21,469 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-23 15:38:21,469 - INFO -    染色体 chr14 大小: 124,902,244 bp, bins: 6246
2025-08-23 15:38:21,479 - INFO -    数据形状: (2226, 3)
2025-08-23 15:38:21,479 - INFO -    bin 范围: 39-1245, 59-1247
2025-08-23 15:38:21,479 - INFO -    矩阵大小: (6246, 6246), 非零元素: 4,044, 稀疏度: 0.000104
2025-08-23 15:38:21,480 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:21,480 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-23 15:38:21,561 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:21,701 - INFO -    卷积耗时: 0.221 秒
2025-08-23 15:38:21,702 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0008)
2025-08-23 15:38:21,702 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-23 15:38:21,702 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-23 15:38:21,767 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-23 15:38:22,033 - INFO - 🔥 MPS Iter 1 takes 0.072 seconds. Loss: 4.214
2025-08-23 15:38:22,318 - INFO - 🔥 MPS Iter 2 takes 0.332 seconds. Loss: 0.818
2025-08-23 15:38:22,578 - INFO - 🔥 MPS Iter 3 takes 0.617 seconds. Loss: 0.214
2025-08-23 15:38:22,841 - INFO - 🔥 MPS Iter 4 takes 0.877 seconds. Loss: 0.057
2025-08-23 15:38:23,104 - INFO - 🔥 MPS Iter 5 takes 1.140 seconds. Loss: 0.018
2025-08-23 15:38:23,366 - INFO - 🔥 MPS Iter 6 takes 1.403 seconds. Loss: 0.006
2025-08-23 15:38:23,367 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:23,367 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:23,378 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:23,545 - INFO -    RWR 耗时: 1.844 秒
2025-08-23 15:38:23,567 - INFO -    归一化耗时: 0.022 秒
2025-08-23 15:38:23,704 - INFO -    ✅ 完成，总耗时: 2.087 秒
2025-08-23 15:38:23,705 - INFO -   ✅ chr14: 完成，耗时 2.24 秒
2025-08-23 15:38:23,705 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-23 15:38:23,706 - INFO -    染色体 chr15 大小: 104,043,685 bp, bins: 5203
2025-08-23 15:38:23,716 - INFO -    数据形状: (1935, 3)
2025-08-23 15:38:23,717 - INFO -    bin 范围: 31-1038, 32-1039
2025-08-23 15:38:23,717 - INFO -    矩阵大小: (5203, 5203), 非零元素: 3,510, 稀疏度: 0.000130
2025-08-23 15:38:23,717 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:23,718 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-23 15:38:23,787 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:23,884 - INFO -    卷积耗时: 0.166 秒
2025-08-23 15:38:23,885 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0010)
2025-08-23 15:38:23,885 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-23 15:38:23,885 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-23 15:38:23,951 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-23 15:38:24,111 - INFO - 🔥 MPS Iter 1 takes 0.072 seconds. Loss: 3.755
2025-08-23 15:38:24,266 - INFO - 🔥 MPS Iter 2 takes 0.227 seconds. Loss: 0.737
2025-08-23 15:38:24,430 - INFO - 🔥 MPS Iter 3 takes 0.381 seconds. Loss: 0.181
2025-08-23 15:38:24,580 - INFO - 🔥 MPS Iter 4 takes 0.545 seconds. Loss: 0.047
2025-08-23 15:38:24,736 - INFO - 🔥 MPS Iter 5 takes 0.702 seconds. Loss: 0.014
2025-08-23 15:38:24,887 - INFO - 🔥 MPS Iter 6 takes 0.852 seconds. Loss: 0.004
2025-08-23 15:38:24,888 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:24,888 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:24,896 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:25,025 - INFO -    RWR 耗时: 1.141 秒
2025-08-23 15:38:25,038 - INFO -    归一化耗时: 0.013 秒
2025-08-23 15:38:25,143 - INFO -    ✅ 完成，总耗时: 1.320 秒
2025-08-23 15:38:25,144 - INFO -   ✅ chr15: 完成，耗时 1.44 秒
2025-08-23 15:38:25,144 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-23 15:38:25,146 - INFO -    染色体 chr16 大小: 98,207,768 bp, bins: 4911
2025-08-23 15:38:25,155 - INFO -    数据形状: (1889, 3)
2025-08-23 15:38:25,155 - INFO -    bin 范围: 33-979, 34-980
2025-08-23 15:38:25,156 - INFO -    矩阵大小: (4911, 4911), 非零元素: 3,424, 稀疏度: 0.000142
2025-08-23 15:38:25,156 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:25,156 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-23 15:38:25,202 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:25,282 - INFO -    卷积耗时: 0.126 秒
2025-08-23 15:38:25,283 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0011)
2025-08-23 15:38:25,283 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-23 15:38:25,283 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-23 15:38:25,351 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-23 15:38:25,485 - INFO - 🔥 MPS Iter 1 takes 0.074 seconds. Loss: 3.676
2025-08-23 15:38:25,609 - INFO - 🔥 MPS Iter 2 takes 0.203 seconds. Loss: 0.721
2025-08-23 15:38:25,736 - INFO - 🔥 MPS Iter 3 takes 0.327 seconds. Loss: 0.180
2025-08-23 15:38:25,866 - INFO - 🔥 MPS Iter 4 takes 0.454 seconds. Loss: 0.048
2025-08-23 15:38:25,994 - INFO - 🔥 MPS Iter 5 takes 0.584 seconds. Loss: 0.014
2025-08-23 15:38:26,121 - INFO - 🔥 MPS Iter 6 takes 0.712 seconds. Loss: 0.005
2025-08-23 15:38:26,122 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:26,123 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:26,130 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:26,245 - INFO -    RWR 耗时: 0.963 秒
2025-08-23 15:38:26,257 - INFO -    归一化耗时: 0.012 秒
2025-08-23 15:38:26,354 - INFO -    ✅ 完成，总耗时: 1.100 秒
2025-08-23 15:38:26,355 - INFO -   ✅ chr16: 完成，耗时 1.21 秒
2025-08-23 15:38:26,355 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-23 15:38:26,356 - INFO -    染色体 chr17 大小: 94,987,271 bp, bins: 4750
2025-08-23 15:38:26,363 - INFO -    数据形状: (1734, 3)
2025-08-23 15:38:26,364 - INFO -    bin 范围: 30-946, 31-948
2025-08-23 15:38:26,364 - INFO -    矩阵大小: (4750, 4750), 非零元素: 3,170, 稀疏度: 0.000140
2025-08-23 15:38:26,364 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:26,364 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-23 15:38:26,408 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:26,489 - INFO -    卷积耗时: 0.125 秒
2025-08-23 15:38:26,490 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0011)
2025-08-23 15:38:26,490 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-23 15:38:26,490 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-23 15:38:26,555 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-23 15:38:26,672 - INFO - 🔥 MPS Iter 1 takes 0.070 seconds. Loss: 3.646
2025-08-23 15:38:26,784 - INFO - 🔥 MPS Iter 2 takes 0.182 seconds. Loss: 0.719
2025-08-23 15:38:26,895 - INFO - 🔥 MPS Iter 3 takes 0.294 seconds. Loss: 0.182
2025-08-23 15:38:27,007 - INFO - 🔥 MPS Iter 4 takes 0.406 seconds. Loss: 0.049
2025-08-23 15:38:27,116 - INFO - 🔥 MPS Iter 5 takes 0.517 seconds. Loss: 0.015
2025-08-23 15:38:27,226 - INFO - 🔥 MPS Iter 6 takes 0.626 seconds. Loss: 0.005
2025-08-23 15:38:27,226 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:27,226 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:27,230 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:27,319 - INFO -    RWR 耗时: 0.830 秒
2025-08-23 15:38:27,330 - INFO -    归一化耗时: 0.011 秒
2025-08-23 15:38:27,421 - INFO -    ✅ 完成，总耗时: 0.965 秒
2025-08-23 15:38:27,422 - INFO -   ✅ chr17: 完成，耗时 1.07 秒
2025-08-23 15:38:27,422 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-23 15:38:27,422 - INFO -    染色体 chr18 大小: 90,702,639 bp, bins: 4536
2025-08-23 15:38:27,429 - INFO -    数据形状: (1800, 3)
2025-08-23 15:38:27,430 - INFO -    bin 范围: 30-903, 30-905
2025-08-23 15:38:27,430 - INFO -    矩阵大小: (4536, 4536), 非零元素: 3,267, 稀疏度: 0.000159
2025-08-23 15:38:27,430 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:27,431 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-23 15:38:27,472 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:27,545 - INFO -    卷积耗时: 0.115 秒
2025-08-23 15:38:27,547 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0012)
2025-08-23 15:38:27,547 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-23 15:38:27,547 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-23 15:38:27,611 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-23 15:38:27,709 - INFO - 🔥 MPS Iter 1 takes 0.069 seconds. Loss: 3.317
2025-08-23 15:38:27,802 - INFO - 🔥 MPS Iter 2 takes 0.164 seconds. Loss: 0.619
2025-08-23 15:38:27,894 - INFO - 🔥 MPS Iter 3 takes 0.256 seconds. Loss: 0.144
2025-08-23 15:38:27,986 - INFO - 🔥 MPS Iter 4 takes 0.347 seconds. Loss: 0.037
2025-08-23 15:38:28,080 - INFO - 🔥 MPS Iter 5 takes 0.441 seconds. Loss: 0.011
2025-08-23 15:38:28,175 - INFO - 🔥 MPS Iter 6 takes 0.535 seconds. Loss: 0.003
2025-08-23 15:38:28,176 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:28,176 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:28,181 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:28,290 - INFO -    RWR 耗时: 0.745 秒
2025-08-23 15:38:28,299 - INFO -    归一化耗时: 0.009 秒
2025-08-23 15:38:28,385 - INFO -    ✅ 完成，总耗时: 0.868 秒
2025-08-23 15:38:28,386 - INFO -   ✅ chr18: 完成，耗时 0.96 秒
2025-08-23 15:38:28,386 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-23 15:38:28,387 - INFO -    染色体 chr19 大小: 61,431,566 bp, bins: 3072
2025-08-23 15:38:28,392 - INFO -    数据形状: (1081, 3)
2025-08-23 15:38:28,392 - INFO -    bin 范围: 30-612, 34-613
2025-08-23 15:38:28,393 - INFO -    矩阵大小: (3072, 3072), 非零元素: 1,949, 稀疏度: 0.000207
2025-08-23 15:38:28,393 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:28,393 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-23 15:38:28,423 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:28,455 - INFO -    卷积耗时: 0.063 秒
2025-08-23 15:38:28,456 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0015)
2025-08-23 15:38:28,456 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-23 15:38:28,456 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-23 15:38:28,510 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-23 15:38:28,549 - INFO - 🔥 MPS Iter 1 takes 0.059 seconds. Loss: 3.131
2025-08-23 15:38:28,580 - INFO - 🔥 MPS Iter 2 takes 0.093 seconds. Loss: 0.690
2025-08-23 15:38:28,611 - INFO - 🔥 MPS Iter 3 takes 0.125 seconds. Loss: 0.194
2025-08-23 15:38:28,643 - INFO - 🔥 MPS Iter 4 takes 0.156 seconds. Loss: 0.059
2025-08-23 15:38:28,674 - INFO - 🔥 MPS Iter 5 takes 0.187 seconds. Loss: 0.020
2025-08-23 15:38:28,705 - INFO - 🔥 MPS Iter 6 takes 0.218 seconds. Loss: 0.007
2025-08-23 15:38:28,706 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:38:28,706 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:28,708 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:28,746 - INFO -    RWR 耗时: 0.290 秒
2025-08-23 15:38:28,751 - INFO -    归一化耗时: 0.005 秒
2025-08-23 15:38:28,789 - INFO -    ✅ 完成，总耗时: 0.357 秒
2025-08-23 15:38:28,790 - INFO -   ✅ chr19: 完成，耗时 0.40 秒
2025-08-23 15:38:28,790 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-23 15:38:28,791 - INFO -    染色体 chrX 大小: 171,031,299 bp, bins: 8552
2025-08-23 15:38:28,793 - INFO -    数据形状: (2615, 3)
2025-08-23 15:38:28,793 - INFO -    bin 范围: 40-1699, 54-1699
2025-08-23 15:38:28,793 - INFO -    矩阵大小: (8552, 8552), 非零元素: 4,821, 稀疏度: 0.000066
2025-08-23 15:38:28,793 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:38:28,793 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-23 15:38:28,916 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:38:29,163 - INFO -    卷积耗时: 0.370 秒
2025-08-23 15:38:29,165 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0006)
2025-08-23 15:38:29,165 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-23 15:38:29,165 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-23 15:38:29,282 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-23 15:38:30,051 - INFO - 🔥 MPS Iter 1 takes 0.125 seconds. Loss: 5.087
2025-08-23 15:38:30,850 - INFO - 🔥 MPS Iter 2 takes 0.887 seconds. Loss: 1.098
2025-08-23 15:38:31,552 - INFO - 🔥 MPS Iter 3 takes 1.686 seconds. Loss: 0.333
2025-08-23 15:38:32,267 - INFO - 🔥 MPS Iter 4 takes 2.388 seconds. Loss: 0.117
2025-08-23 15:38:32,984 - INFO - 🔥 MPS Iter 5 takes 3.103 seconds. Loss: 0.049
2025-08-23 15:38:33,675 - INFO - 🔥 MPS Iter 6 takes 3.820 seconds. Loss: 0.021
2025-08-23 15:38:34,368 - INFO - 🔥 MPS Iter 7 takes 4.512 seconds. Loss: 0.010
2025-08-23 15:38:34,368 - INFO - ✅ Converged after 7 iterations
2025-08-23 15:38:34,368 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:38:34,415 - INFO - 🧹 GPU memory cleared
2025-08-23 15:38:34,679 - INFO -    RWR 耗时: 5.515 秒
2025-08-23 15:38:34,710 - INFO -    归一化耗时: 0.030 秒
2025-08-23 15:38:34,943 - INFO -    ✅ 完成，总耗时: 5.915 秒
2025-08-23 15:38:34,947 - INFO -   ✅ chrX: 完成，耗时 6.16 秒
2025-08-23 15:38:34,947 - INFO - 🎯 细胞 GasfE703154 完成: 20 成功, 0 失败, 总耗时 0.6 分钟
2025-08-23 15:38:34,948 - INFO - 📦 批次完成: 40 成功, 0 失败, 耗时 0.6 分钟
2025-08-23 15:38:34,948 - INFO - 🎊 Stage E70 完成: 40 个矩阵成功, 0 个失败
2025-08-23 15:38:34,948 - INFO -    总耗时: 0.01 小时
2025-08-23 15:38:34,948 - INFO - 
============================================================
2025-08-23 15:38:34,948 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:38:34,948 - INFO - 📊 总计: 40 个矩阵成功, 0 个失败
2025-08-23 15:38:34,948 - INFO - ⏱️  总耗时: 0.01 小时
2025-08-23 15:38:34,948 - INFO - 💡 M4 MPS 加速比: 18.8x
2025-08-23 15:38:34,948 - INFO - 💡 预计节省时间: 0.0 小时 (相比 M4 CPU)
2025-08-23 15:38:34,948 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:46:38,911 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:46:38,911 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:46:38,911 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:46:38,911 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:46:38,911 - INFO - 🔧 使用 MPS: True
2025-08-23 15:46:38,911 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:46:38,911 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:46:39,066 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:46:39,827 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:46:39,827 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:46:39,828 - INFO - 
==================================================
2025-08-23 15:46:39,828 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:46:39,828 - INFO - ==================================================
2025-08-23 15:46:39,829 - INFO - 🗂️  Stage E70: 发现 2 个细胞
2025-08-23 15:46:39,829 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:46:39,835 - INFO - 📦 M4 批次处理 1: 细胞 1-2/2
2025-08-23 15:46:39,835 - INFO - 📊 处理: GasfE703153 (1/2)
2025-08-23 15:46:39,835 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:46:39,840 - ERROR -   ❌ 染色体 chr1 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,840 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,840 - ERROR -   ❌ chr1: 插补失败
2025-08-23 15:46:39,840 - ERROR -   ❌ 染色体 chr2 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,840 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,840 - ERROR -   ❌ chr2: 插补失败
2025-08-23 15:46:39,840 - ERROR -   ❌ 染色体 chr3 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,840 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,840 - ERROR -   ❌ chr3: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr4 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr4: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr5 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr5: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr6 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr6: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr7 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr7: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr8 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr8: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr9 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr9: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr10 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr10: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr11 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr11: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr12 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr12: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr13 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr13: 插补失败
2025-08-23 15:46:39,841 - ERROR -   ❌ 染色体 chr14 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,841 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,841 - ERROR -   ❌ chr14: 插补失败
2025-08-23 15:46:39,842 - ERROR -   ❌ 染色体 chr15 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,842 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,842 - ERROR -   ❌ chr15: 插补失败
2025-08-23 15:46:39,842 - ERROR -   ❌ 染色体 chr16 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,842 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,842 - ERROR -   ❌ chr16: 插补失败
2025-08-23 15:46:39,842 - ERROR -   ❌ 染色体 chr17 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,842 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,842 - ERROR -   ❌ chr17: 插补失败
2025-08-23 15:46:39,842 - ERROR -   ❌ 染色体 chr18 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,842 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,842 - ERROR -   ❌ chr18: 插补失败
2025-08-23 15:46:39,842 - ERROR -   ❌ 染色体 chr19 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,842 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,842 - ERROR -   ❌ chr19: 插补失败
2025-08-23 15:46:39,842 - ERROR -   ❌ 染色体 chrX 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,842 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,842 - ERROR -   ❌ chrX: 插补失败
2025-08-23 15:46:39,842 - INFO - 🎯 细胞 GasfE703153 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-23 15:46:39,842 - INFO - 📊 处理: GasfE703154 (2/2)
2025-08-23 15:46:39,842 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr1 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr1: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr2 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr2: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr3 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr3: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr4 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr4: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr5 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr5: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr6 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr6: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr7 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr7: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr8 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr8: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr9 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr9: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr10 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr10: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr11 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr11: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr12 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr12: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr13 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,844 - ERROR -   ❌ chr13: 插补失败
2025-08-23 15:46:39,844 - ERROR -   ❌ 染色体 chr14 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,844 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,845 - ERROR -   ❌ chr14: 插补失败
2025-08-23 15:46:39,845 - ERROR -   ❌ 染色体 chr15 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,845 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,845 - ERROR -   ❌ chr15: 插补失败
2025-08-23 15:46:39,845 - ERROR -   ❌ 染色体 chr16 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,845 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,845 - ERROR -   ❌ chr16: 插补失败
2025-08-23 15:46:39,845 - ERROR -   ❌ 染色体 chr17 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,845 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,845 - ERROR -   ❌ chr17: 插补失败
2025-08-23 15:46:39,845 - ERROR -   ❌ 染色体 chr18 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,845 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,845 - ERROR -   ❌ chr18: 插补失败
2025-08-23 15:46:39,845 - ERROR -   ❌ 染色体 chr19 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,845 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,845 - ERROR -   ❌ chr19: 插补失败
2025-08-23 15:46:39,845 - ERROR -   ❌ 染色体 chrX 插补失败: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'
2025-08-23 15:46:39,845 - ERROR - Traceback (most recent call last):
  File "/Volumes/SumSung500/CSU/0_HiRES/lwh_schicluster_impute_code/imputation_mac/core/batch_mps_imputation_v2.py", line 57, in impute_single_chromosome
    success = impute_bin_matrix(
              ^^^^^^^^^^^^^^^^^^
TypeError: impute_bin_matrix() got an unexpected keyword argument 'bin_contact_file'

2025-08-23 15:46:39,845 - ERROR -   ❌ chrX: 插补失败
2025-08-23 15:46:39,845 - INFO - 🎯 细胞 GasfE703154 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-23 15:46:39,845 - INFO - 📦 批次完成: 0 成功, 40 失败, 耗时 0.0 分钟
2025-08-23 15:46:39,845 - INFO - 🎊 Stage E70 完成: 0 个矩阵成功, 40 个失败
2025-08-23 15:46:39,845 - INFO -    总耗时: 0.00 小时
2025-08-23 15:46:39,845 - INFO - 
============================================================
2025-08-23 15:46:39,845 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:46:39,845 - INFO - 📊 总计: 0 个矩阵成功, 40 个失败
2025-08-23 15:46:39,845 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 15:46:39,845 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:47:02,647 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:47:02,657 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:47:02,657 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:47:02,657 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:47:02,657 - INFO - 🔧 使用 MPS: True
2025-08-23 15:47:02,657 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:47:02,657 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:47:02,781 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:47:03,474 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:47:03,474 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:47:03,474 - INFO - 
==================================================
2025-08-23 15:47:03,474 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:47:03,474 - INFO - ==================================================
2025-08-23 15:47:03,476 - INFO - 🗂️  Stage E70: 发现 2 个细胞
2025-08-23 15:47:03,476 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:47:03,476 - INFO - 📦 M4 批次处理 1: 细胞 1-2/2
2025-08-23 15:47:03,476 - INFO - 📊 处理: GasfE703153 (1/2)
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-23 15:47:03,476 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,476 - ERROR -   ❌ chr1: 插补失败
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-23 15:47:03,476 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,476 - ERROR -   ❌ chr2: 插补失败
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-23 15:47:03,476 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,476 - ERROR -   ❌ chr3: 插补失败
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-23 15:47:03,476 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,476 - ERROR -   ❌ chr4: 插补失败
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-23 15:47:03,476 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,476 - ERROR -   ❌ chr5: 插补失败
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-23 15:47:03,476 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,476 - ERROR -   ❌ chr6: 插补失败
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-23 15:47:03,476 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,476 - ERROR -   ❌ chr7: 插补失败
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-23 15:47:03,476 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,476 - ERROR -   ❌ chr8: 插补失败
2025-08-23 15:47:03,476 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr9: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr10: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr11: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr12: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr13: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr14: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr15: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr16: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr17: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr18: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr19: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chrX: 插补失败
2025-08-23 15:47:03,477 - INFO - 🎯 细胞 GasfE703153 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-23 15:47:03,477 - INFO - 📊 处理: GasfE703154 (2/2)
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr1: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr2: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr3: 插补失败
2025-08-23 15:47:03,477 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-23 15:47:03,477 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,477 - ERROR -   ❌ chr4: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr5: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr6: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr7: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr8: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr9: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr10: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr11: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr12: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr13: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr14: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr15: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr16: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr17: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr18: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chr19: 插补失败
2025-08-23 15:47:03,478 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-23 15:47:03,478 - ERROR -    读取染色体大小文件失败: name 'chrom_size_file' is not defined
2025-08-23 15:47:03,478 - ERROR -   ❌ chrX: 插补失败
2025-08-23 15:47:03,478 - INFO - 🎯 细胞 GasfE703154 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-23 15:47:03,478 - INFO - 📦 批次完成: 0 成功, 40 失败, 耗时 0.0 分钟
2025-08-23 15:47:03,478 - INFO - 🎊 Stage E70 完成: 0 个矩阵成功, 40 个失败
2025-08-23 15:47:03,479 - INFO -    总耗时: 0.00 小时
2025-08-23 15:47:03,479 - INFO - 
============================================================
2025-08-23 15:47:03,479 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:47:03,479 - INFO - 📊 总计: 0 个矩阵成功, 40 个失败
2025-08-23 15:47:03,479 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 15:47:03,479 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:47:42,838 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:47:42,838 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:47:42,838 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:47:42,838 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:47:42,838 - INFO - 🔧 使用 MPS: True
2025-08-23 15:47:42,838 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:47:42,838 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:47:42,958 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:47:43,648 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:47:43,648 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:47:43,648 - INFO - 
==================================================
2025-08-23 15:47:43,648 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:47:43,648 - INFO - ==================================================
2025-08-23 15:47:43,649 - INFO - 🗂️  Stage E70: 发现 2 个细胞
2025-08-23 15:47:43,649 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:47:43,649 - INFO - 📦 M4 批次处理 1: 细胞 1-2/2
2025-08-23 15:47:43,649 - INFO - 📊 处理: GasfE703153 (1/2)
2025-08-23 15:47:43,649 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:47:43,657 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-23 15:47:43,659 - INFO -    染色体 chr1 大小: 195,471,971 bp, bins: 1955
2025-08-23 15:47:43,660 - INFO -    数据形状: (6643, 3)
2025-08-23 15:47:43,660 - INFO -    bin 范围: 30-1952, 32-1952
2025-08-23 15:47:43,661 - INFO -    矩阵大小: (1955, 1955), 非零元素: 12,039, 稀疏度: 0.003150
2025-08-23 15:47:43,661 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:43,661 - INFO - 🔥 MPS Gaussian filter: 1955x1955 matrix, 内存需求: 58.4MB
2025-08-23 15:47:43,761 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:43,775 - INFO -    卷积耗时: 0.114 秒
2025-08-23 15:47:43,777 - INFO - 🚀 MPS 加速: 1955x1955 矩阵 (内存需求: 0.04GB, 稀疏度: 0.0148)
2025-08-23 15:47:43,777 - INFO - 🚀 Using MPS for 1955x1955 matrix with 24GB GPU memory
2025-08-23 15:47:43,777 - INFO - Converting 1955x1955 sparse matrix to dense for MPS...
2025-08-23 15:47:43,839 - INFO - 💾 Estimated GPU memory usage: 43.7 MB
2025-08-23 15:47:43,867 - INFO - 🔥 MPS Iter 1 takes 0.073 seconds. Loss: 4.054
2025-08-23 15:47:43,889 - INFO - 🔥 MPS Iter 2 takes 0.095 seconds. Loss: 0.664
2025-08-23 15:47:43,912 - INFO - 🔥 MPS Iter 3 takes 0.121 seconds. Loss: 0.163
2025-08-23 15:47:43,993 - INFO - 🔥 MPS Iter 4 takes 0.188 seconds. Loss: 0.049
2025-08-23 15:47:44,008 - INFO - 🔥 MPS Iter 5 takes 0.218 seconds. Loss: 0.017
2025-08-23 15:47:44,025 - INFO - 🔥 MPS Iter 6 takes 0.234 seconds. Loss: 0.006
2025-08-23 15:47:44,027 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:44,027 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:44,029 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:44,139 - INFO -    RWR 耗时: 0.362 秒
2025-08-23 15:47:44,186 - INFO -    归一化耗时: 0.047 秒
2025-08-23 15:47:44,541 - INFO -    ✅ 完成，总耗时: 0.524 秒
2025-08-23 15:47:44,541 - INFO -   ✅ chr1: 完成，耗时 0.89 秒
2025-08-23 15:47:44,542 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-23 15:47:44,542 - INFO -    染色体 chr2 大小: 182,113,224 bp, bins: 1822
2025-08-23 15:47:44,545 - INFO -    数据形状: (6596, 3)
2025-08-23 15:47:44,545 - INFO -    bin 范围: 30-1819, 31-1819
2025-08-23 15:47:44,546 - INFO -    矩阵大小: (1822, 1822), 非零元素: 11,972, 稀疏度: 0.003606
2025-08-23 15:47:44,546 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:44,546 - INFO - 🔥 MPS Gaussian filter: 1822x1822 matrix, 内存需求: 50.7MB
2025-08-23 15:47:44,568 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:44,581 - INFO -    卷积耗时: 0.035 秒
2025-08-23 15:47:44,582 - INFO - 🚀 MPS 加速: 1822x1822 矩阵 (内存需求: 0.04GB, 稀疏度: 0.0169)
2025-08-23 15:47:44,582 - INFO - 🚀 Using MPS for 1822x1822 matrix with 24GB GPU memory
2025-08-23 15:47:44,583 - INFO - Converting 1822x1822 sparse matrix to dense for MPS...
2025-08-23 15:47:44,637 - INFO - 💾 Estimated GPU memory usage: 38.0 MB
2025-08-23 15:47:44,659 - INFO - 🔥 MPS Iter 1 takes 0.059 seconds. Loss: 3.845
2025-08-23 15:47:44,669 - INFO - 🔥 MPS Iter 2 takes 0.078 seconds. Loss: 0.628
2025-08-23 15:47:44,679 - INFO - 🔥 MPS Iter 3 takes 0.088 seconds. Loss: 0.156
2025-08-23 15:47:44,688 - INFO - 🔥 MPS Iter 4 takes 0.097 seconds. Loss: 0.047
2025-08-23 15:47:44,697 - INFO - 🔥 MPS Iter 5 takes 0.106 seconds. Loss: 0.017
2025-08-23 15:47:44,706 - INFO - 🔥 MPS Iter 6 takes 0.115 seconds. Loss: 0.006
2025-08-23 15:47:44,707 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:44,707 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:44,708 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:44,751 - INFO -    RWR 耗时: 0.169 秒
2025-08-23 15:47:44,789 - INFO -    归一化耗时: 0.038 秒
2025-08-23 15:47:45,103 - INFO -    ✅ 完成，总耗时: 0.243 秒
2025-08-23 15:47:45,104 - INFO -   ✅ chr2: 完成，耗时 0.56 秒
2025-08-23 15:47:45,104 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-23 15:47:45,105 - INFO -    染色体 chr3 大小: 160,039,680 bp, bins: 1601
2025-08-23 15:47:45,106 - INFO -    数据形状: (4946, 3)
2025-08-23 15:47:45,107 - INFO -    bin 范围: 30-1598, 31-1599
2025-08-23 15:47:45,107 - INFO -    矩阵大小: (1601, 1601), 非零元素: 8,912, 稀疏度: 0.003477
2025-08-23 15:47:45,107 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:45,107 - INFO - 🔥 MPS Gaussian filter: 1601x1601 matrix, 内存需求: 39.2MB
2025-08-23 15:47:45,130 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:45,140 - INFO -    卷积耗时: 0.032 秒
2025-08-23 15:47:45,141 - INFO - 🚀 MPS 加速: 1601x1601 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0159)
2025-08-23 15:47:45,141 - INFO - 🚀 Using MPS for 1601x1601 matrix with 24GB GPU memory
2025-08-23 15:47:45,141 - INFO - Converting 1601x1601 sparse matrix to dense for MPS...
2025-08-23 15:47:45,151 - INFO - 💾 Estimated GPU memory usage: 29.3 MB
2025-08-23 15:47:45,171 - INFO - 🔥 MPS Iter 1 takes 0.015 seconds. Loss: 4.010
2025-08-23 15:47:45,178 - INFO - 🔥 MPS Iter 2 takes 0.031 seconds. Loss: 0.679
2025-08-23 15:47:45,184 - INFO - 🔥 MPS Iter 3 takes 0.038 seconds. Loss: 0.167
2025-08-23 15:47:45,191 - INFO - 🔥 MPS Iter 4 takes 0.044 seconds. Loss: 0.050
2025-08-23 15:47:45,199 - INFO - 🔥 MPS Iter 5 takes 0.052 seconds. Loss: 0.017
2025-08-23 15:47:45,206 - INFO - 🔥 MPS Iter 6 takes 0.059 seconds. Loss: 0.007
2025-08-23 15:47:45,206 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:45,206 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:45,208 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:45,244 - INFO -    RWR 耗时: 0.104 秒
2025-08-23 15:47:45,277 - INFO -    归一化耗时: 0.032 秒
2025-08-23 15:47:45,507 - INFO -    ✅ 完成，总耗时: 0.169 秒
2025-08-23 15:47:45,508 - INFO -   ✅ chr3: 完成，耗时 0.40 秒
2025-08-23 15:47:45,508 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-23 15:47:45,509 - INFO -    染色体 chr4 大小: 156,508,116 bp, bins: 1566
2025-08-23 15:47:45,511 - INFO -    数据形状: (4876, 3)
2025-08-23 15:47:45,511 - INFO -    bin 范围: 30-1563, 30-1563
2025-08-23 15:47:45,511 - INFO -    矩阵大小: (1566, 1566), 非零元素: 8,783, 稀疏度: 0.003581
2025-08-23 15:47:45,511 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:45,511 - INFO - 🔥 MPS Gaussian filter: 1566x1566 matrix, 内存需求: 37.5MB
2025-08-23 15:47:45,522 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:45,533 - INFO -    卷积耗时: 0.021 秒
2025-08-23 15:47:45,534 - INFO - 🚀 MPS 加速: 1566x1566 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0163)
2025-08-23 15:47:45,534 - INFO - 🚀 Using MPS for 1566x1566 matrix with 24GB GPU memory
2025-08-23 15:47:45,534 - INFO - Converting 1566x1566 sparse matrix to dense for MPS...
2025-08-23 15:47:45,541 - INFO - 💾 Estimated GPU memory usage: 28.1 MB
2025-08-23 15:47:45,557 - INFO - 🔥 MPS Iter 1 takes 0.011 seconds. Loss: 3.964
2025-08-23 15:47:45,567 - INFO - 🔥 MPS Iter 2 takes 0.024 seconds. Loss: 0.649
2025-08-23 15:47:45,573 - INFO - 🔥 MPS Iter 3 takes 0.033 seconds. Loss: 0.159
2025-08-23 15:47:45,580 - INFO - 🔥 MPS Iter 4 takes 0.040 seconds. Loss: 0.047
2025-08-23 15:47:45,586 - INFO - 🔥 MPS Iter 5 takes 0.046 seconds. Loss: 0.016
2025-08-23 15:47:45,592 - INFO - 🔥 MPS Iter 6 takes 0.053 seconds. Loss: 0.006
2025-08-23 15:47:45,593 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:45,593 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:45,595 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:45,629 - INFO -    RWR 耗时: 0.096 秒
2025-08-23 15:47:45,657 - INFO -    归一化耗时: 0.028 秒
2025-08-23 15:47:45,871 - INFO -    ✅ 完成，总耗时: 0.145 秒
2025-08-23 15:47:45,871 - INFO -   ✅ chr4: 完成，耗时 0.36 秒
2025-08-23 15:47:45,871 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-23 15:47:45,872 - INFO -    染色体 chr5 大小: 151,834,684 bp, bins: 1519
2025-08-23 15:47:45,873 - INFO -    数据形状: (4990, 3)
2025-08-23 15:47:45,873 - INFO -    bin 范围: 30-1517, 31-1517
2025-08-23 15:47:45,874 - INFO -    矩阵大小: (1519, 1519), 非零元素: 8,945, 稀疏度: 0.003877
2025-08-23 15:47:45,874 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:45,874 - INFO - 🔥 MPS Gaussian filter: 1519x1519 matrix, 内存需求: 35.3MB
2025-08-23 15:47:45,885 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:45,894 - INFO -    卷积耗时: 0.020 秒
2025-08-23 15:47:45,896 - INFO - 🚀 MPS 加速: 1519x1519 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0167)
2025-08-23 15:47:45,896 - INFO - 🚀 Using MPS for 1519x1519 matrix with 24GB GPU memory
2025-08-23 15:47:45,896 - INFO - Converting 1519x1519 sparse matrix to dense for MPS...
2025-08-23 15:47:45,902 - INFO - 💾 Estimated GPU memory usage: 26.4 MB
2025-08-23 15:47:45,922 - INFO - 🔥 MPS Iter 1 takes 0.011 seconds. Loss: 3.793
2025-08-23 15:47:45,931 - INFO - 🔥 MPS Iter 2 takes 0.027 seconds. Loss: 0.638
2025-08-23 15:47:45,937 - INFO - 🔥 MPS Iter 3 takes 0.036 seconds. Loss: 0.160
2025-08-23 15:47:45,944 - INFO - 🔥 MPS Iter 4 takes 0.043 seconds. Loss: 0.049
2025-08-23 15:47:45,950 - INFO - 🔥 MPS Iter 5 takes 0.050 seconds. Loss: 0.017
2025-08-23 15:47:45,957 - INFO - 🔥 MPS Iter 6 takes 0.056 seconds. Loss: 0.006
2025-08-23 15:47:45,957 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:45,957 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:45,959 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:45,989 - INFO -    RWR 耗时: 0.094 秒
2025-08-23 15:47:46,016 - INFO -    归一化耗时: 0.027 秒
2025-08-23 15:47:46,221 - INFO -    ✅ 完成，总耗时: 0.141 秒
2025-08-23 15:47:46,221 - INFO -   ✅ chr5: 完成，耗时 0.35 秒
2025-08-23 15:47:46,222 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-23 15:47:46,222 - INFO -    染色体 chr6 大小: 149,736,546 bp, bins: 1498
2025-08-23 15:47:46,224 - INFO -    数据形状: (5180, 3)
2025-08-23 15:47:46,225 - INFO -    bin 范围: 31-1494, 31-1495
2025-08-23 15:47:46,225 - INFO -    矩阵大小: (1498, 1498), 非零元素: 9,359, 稀疏度: 0.004171
2025-08-23 15:47:46,225 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:46,225 - INFO - 🔥 MPS Gaussian filter: 1498x1498 matrix, 内存需求: 34.3MB
2025-08-23 15:47:46,236 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:46,245 - INFO -    卷积耗时: 0.019 秒
2025-08-23 15:47:46,246 - INFO - 🚀 MPS 加速: 1498x1498 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0190)
2025-08-23 15:47:46,246 - INFO - 🚀 Using MPS for 1498x1498 matrix with 24GB GPU memory
2025-08-23 15:47:46,246 - INFO - Converting 1498x1498 sparse matrix to dense for MPS...
2025-08-23 15:47:46,253 - INFO - 💾 Estimated GPU memory usage: 25.7 MB
2025-08-23 15:47:46,269 - INFO - 🔥 MPS Iter 1 takes 0.011 seconds. Loss: 3.615
2025-08-23 15:47:46,275 - INFO - 🔥 MPS Iter 2 takes 0.024 seconds. Loss: 0.597
2025-08-23 15:47:46,281 - INFO - 🔥 MPS Iter 3 takes 0.030 seconds. Loss: 0.150
2025-08-23 15:47:46,286 - INFO - 🔥 MPS Iter 4 takes 0.035 seconds. Loss: 0.046
2025-08-23 15:47:46,292 - INFO - 🔥 MPS Iter 5 takes 0.041 seconds. Loss: 0.016
2025-08-23 15:47:46,298 - INFO - 🔥 MPS Iter 6 takes 0.047 seconds. Loss: 0.006
2025-08-23 15:47:46,299 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:46,299 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:46,301 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:46,331 - INFO -    RWR 耗时: 0.086 秒
2025-08-23 15:47:46,355 - INFO -    归一化耗时: 0.024 秒
2025-08-23 15:47:46,557 - INFO -    ✅ 完成，总耗时: 0.130 秒
2025-08-23 15:47:46,557 - INFO -   ✅ chr6: 完成，耗时 0.34 秒
2025-08-23 15:47:46,557 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-23 15:47:46,558 - INFO -    染色体 chr7 大小: 145,441,459 bp, bins: 1455
2025-08-23 15:47:46,560 - INFO -    数据形状: (5035, 3)
2025-08-23 15:47:46,560 - INFO -    bin 范围: 31-1453, 31-1453
2025-08-23 15:47:46,561 - INFO -    矩阵大小: (1455, 1455), 非零元素: 9,089, 稀疏度: 0.004293
2025-08-23 15:47:46,561 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:46,561 - INFO - 🔥 MPS Gaussian filter: 1455x1455 matrix, 内存需求: 32.3MB
2025-08-23 15:47:46,571 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:46,580 - INFO -    卷积耗时: 0.019 秒
2025-08-23 15:47:46,582 - INFO - 🚀 MPS 加速: 1455x1455 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0198)
2025-08-23 15:47:46,582 - INFO - 🚀 Using MPS for 1455x1455 matrix with 24GB GPU memory
2025-08-23 15:47:46,582 - INFO - Converting 1455x1455 sparse matrix to dense for MPS...
2025-08-23 15:47:46,589 - INFO - 💾 Estimated GPU memory usage: 24.2 MB
2025-08-23 15:47:46,606 - INFO - 🔥 MPS Iter 1 takes 0.012 seconds. Loss: 3.629
2025-08-23 15:47:46,614 - INFO - 🔥 MPS Iter 2 takes 0.025 seconds. Loss: 0.615
2025-08-23 15:47:46,620 - INFO - 🔥 MPS Iter 3 takes 0.033 seconds. Loss: 0.157
2025-08-23 15:47:46,624 - INFO - 🔥 MPS Iter 4 takes 0.039 seconds. Loss: 0.047
2025-08-23 15:47:46,630 - INFO - 🔥 MPS Iter 5 takes 0.044 seconds. Loss: 0.016
2025-08-23 15:47:46,636 - INFO - 🔥 MPS Iter 6 takes 0.050 seconds. Loss: 0.006
2025-08-23 15:47:46,637 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:46,637 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:46,638 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:46,667 - INFO -    RWR 耗时: 0.086 秒
2025-08-23 15:47:46,694 - INFO -    归一化耗时: 0.027 秒
2025-08-23 15:47:46,882 - INFO -    ✅ 完成，总耗时: 0.133 秒
2025-08-23 15:47:46,882 - INFO -   ✅ chr7: 完成，耗时 0.33 秒
2025-08-23 15:47:46,882 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-23 15:47:46,883 - INFO -    染色体 chr8 大小: 129,401,213 bp, bins: 1295
2025-08-23 15:47:46,885 - INFO -    数据形状: (4227, 3)
2025-08-23 15:47:46,885 - INFO -    bin 范围: 30-1292, 31-1292
2025-08-23 15:47:46,885 - INFO -    矩阵大小: (1295, 1295), 非零元素: 7,568, 稀疏度: 0.004513
2025-08-23 15:47:46,885 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:46,885 - INFO - 🔥 MPS Gaussian filter: 1295x1295 matrix, 内存需求: 25.6MB
2025-08-23 15:47:46,896 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:46,903 - INFO -    卷积耗时: 0.018 秒
2025-08-23 15:47:46,904 - INFO - 🚀 MPS 加速: 1295x1295 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0200)
2025-08-23 15:47:46,904 - INFO - 🚀 Using MPS for 1295x1295 matrix with 24GB GPU memory
2025-08-23 15:47:46,904 - INFO - Converting 1295x1295 sparse matrix to dense for MPS...
2025-08-23 15:47:46,910 - INFO - 💾 Estimated GPU memory usage: 19.2 MB
2025-08-23 15:47:46,926 - INFO - 🔥 MPS Iter 1 takes 0.010 seconds. Loss: 3.505
2025-08-23 15:47:46,931 - INFO - 🔥 MPS Iter 2 takes 0.023 seconds. Loss: 0.595
2025-08-23 15:47:46,936 - INFO - 🔥 MPS Iter 3 takes 0.027 seconds. Loss: 0.149
2025-08-23 15:47:46,940 - INFO - 🔥 MPS Iter 4 takes 0.032 seconds. Loss: 0.045
2025-08-23 15:47:46,944 - INFO - 🔥 MPS Iter 5 takes 0.036 seconds. Loss: 0.016
2025-08-23 15:47:46,948 - INFO - 🔥 MPS Iter 6 takes 0.041 seconds. Loss: 0.006
2025-08-23 15:47:46,949 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:46,949 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:46,950 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:46,973 - INFO -    RWR 耗时: 0.070 秒
2025-08-23 15:47:46,994 - INFO -    归一化耗时: 0.020 秒
2025-08-23 15:47:47,150 - INFO -    ✅ 完成，总耗时: 0.108 秒
2025-08-23 15:47:47,150 - INFO -   ✅ chr8: 完成，耗时 0.27 秒
2025-08-23 15:47:47,150 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-23 15:47:47,151 - INFO -    染色体 chr9 大小: 124,595,110 bp, bins: 1246
2025-08-23 15:47:47,155 - INFO -    数据形状: (4953, 3)
2025-08-23 15:47:47,155 - INFO -    bin 范围: 30-1244, 30-1244
2025-08-23 15:47:47,155 - INFO -    矩阵大小: (1246, 1246), 非零元素: 8,995, 稀疏度: 0.005794
2025-08-23 15:47:47,155 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:47,155 - INFO - 🔥 MPS Gaussian filter: 1246x1246 matrix, 内存需求: 23.7MB
2025-08-23 15:47:47,165 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:47,171 - INFO -    卷积耗时: 0.016 秒
2025-08-23 15:47:47,172 - INFO - 🚀 MPS 加速: 1246x1246 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0259)
2025-08-23 15:47:47,172 - INFO - 🚀 Using MPS for 1246x1246 matrix with 24GB GPU memory
2025-08-23 15:47:47,173 - INFO - Converting 1246x1246 sparse matrix to dense for MPS...
2025-08-23 15:47:47,178 - INFO - 💾 Estimated GPU memory usage: 17.8 MB
2025-08-23 15:47:47,189 - INFO - 🔥 MPS Iter 1 takes 0.011 seconds. Loss: 3.092
2025-08-23 15:47:47,194 - INFO - 🔥 MPS Iter 2 takes 0.017 seconds. Loss: 0.499
2025-08-23 15:47:47,197 - INFO - 🔥 MPS Iter 3 takes 0.022 seconds. Loss: 0.123
2025-08-23 15:47:47,202 - INFO - 🔥 MPS Iter 4 takes 0.025 seconds. Loss: 0.038
2025-08-23 15:47:47,205 - INFO - 🔥 MPS Iter 5 takes 0.030 seconds. Loss: 0.013
2025-08-23 15:47:47,209 - INFO - 🔥 MPS Iter 6 takes 0.033 seconds. Loss: 0.005
2025-08-23 15:47:47,209 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:47,209 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:47,211 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:47,234 - INFO -    RWR 耗时: 0.062 秒
2025-08-23 15:47:47,252 - INFO -    归一化耗时: 0.017 秒
2025-08-23 15:47:47,399 - INFO -    ✅ 完成，总耗时: 0.096 秒
2025-08-23 15:47:47,399 - INFO -   ✅ chr9: 完成，耗时 0.25 秒
2025-08-23 15:47:47,400 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-23 15:47:47,401 - INFO -    染色体 chr10 大小: 130,694,993 bp, bins: 1307
2025-08-23 15:47:47,403 - INFO -    数据形状: (4352, 3)
2025-08-23 15:47:47,403 - INFO -    bin 范围: 31-1305, 31-1305
2025-08-23 15:47:47,403 - INFO -    矩阵大小: (1307, 1307), 非零元素: 7,826, 稀疏度: 0.004581
2025-08-23 15:47:47,404 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:47,404 - INFO - 🔥 MPS Gaussian filter: 1307x1307 matrix, 内存需求: 26.1MB
2025-08-23 15:47:47,414 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:47,422 - INFO -    卷积耗时: 0.018 秒
2025-08-23 15:47:47,423 - INFO - 🚀 MPS 加速: 1307x1307 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0201)
2025-08-23 15:47:47,423 - INFO - 🚀 Using MPS for 1307x1307 matrix with 24GB GPU memory
2025-08-23 15:47:47,423 - INFO - Converting 1307x1307 sparse matrix to dense for MPS...
2025-08-23 15:47:47,429 - INFO - 💾 Estimated GPU memory usage: 19.5 MB
2025-08-23 15:47:47,442 - INFO - 🔥 MPS Iter 1 takes 0.011 seconds. Loss: 3.457
2025-08-23 15:47:47,446 - INFO - 🔥 MPS Iter 2 takes 0.020 seconds. Loss: 0.573
2025-08-23 15:47:47,451 - INFO - 🔥 MPS Iter 3 takes 0.024 seconds. Loss: 0.141
2025-08-23 15:47:47,455 - INFO - 🔥 MPS Iter 4 takes 0.029 seconds. Loss: 0.043
2025-08-23 15:47:47,459 - INFO - 🔥 MPS Iter 5 takes 0.033 seconds. Loss: 0.015
2025-08-23 15:47:47,464 - INFO - 🔥 MPS Iter 6 takes 0.037 seconds. Loss: 0.006
2025-08-23 15:47:47,464 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:47,464 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:47,466 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:47,489 - INFO -    RWR 耗时: 0.067 秒
2025-08-23 15:47:47,510 - INFO -    归一化耗时: 0.021 秒
2025-08-23 15:47:47,663 - INFO -    ✅ 完成，总耗时: 0.106 秒
2025-08-23 15:47:47,663 - INFO -   ✅ chr10: 完成，耗时 0.26 秒
2025-08-23 15:47:47,663 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-23 15:47:47,664 - INFO -    染色体 chr11 大小: 122,082,543 bp, bins: 1221
2025-08-23 15:47:47,666 - INFO -    数据形状: (4566, 3)
2025-08-23 15:47:47,666 - INFO -    bin 范围: 31-1218, 31-1219
2025-08-23 15:47:47,667 - INFO -    矩阵大小: (1221, 1221), 非零元素: 8,237, 稀疏度: 0.005525
2025-08-23 15:47:47,667 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:47,667 - INFO - 🔥 MPS Gaussian filter: 1221x1221 matrix, 内存需求: 22.8MB
2025-08-23 15:47:47,677 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:47,683 - INFO -    卷积耗时: 0.016 秒
2025-08-23 15:47:47,685 - INFO - 🚀 MPS 加速: 1221x1221 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0235)
2025-08-23 15:47:47,685 - INFO - 🚀 Using MPS for 1221x1221 matrix with 24GB GPU memory
2025-08-23 15:47:47,685 - INFO - Converting 1221x1221 sparse matrix to dense for MPS...
2025-08-23 15:47:47,690 - INFO - 💾 Estimated GPU memory usage: 17.1 MB
2025-08-23 15:47:47,700 - INFO - 🔥 MPS Iter 1 takes 0.010 seconds. Loss: 3.161
2025-08-23 15:47:47,705 - INFO - 🔥 MPS Iter 2 takes 0.016 seconds. Loss: 0.511
2025-08-23 15:47:47,709 - INFO - 🔥 MPS Iter 3 takes 0.021 seconds. Loss: 0.128
2025-08-23 15:47:47,713 - INFO - 🔥 MPS Iter 4 takes 0.025 seconds. Loss: 0.040
2025-08-23 15:47:47,717 - INFO - 🔥 MPS Iter 5 takes 0.029 seconds. Loss: 0.014
2025-08-23 15:47:47,721 - INFO - 🔥 MPS Iter 6 takes 0.033 seconds. Loss: 0.006
2025-08-23 15:47:47,721 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:47,721 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:47,723 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:47,744 - INFO -    RWR 耗时: 0.061 秒
2025-08-23 15:47:47,761 - INFO -    归一化耗时: 0.017 秒
2025-08-23 15:47:47,899 - INFO -    ✅ 完成，总耗时: 0.094 秒
2025-08-23 15:47:47,899 - INFO -   ✅ chr11: 完成，耗时 0.24 秒
2025-08-23 15:47:47,899 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-23 15:47:47,900 - INFO -    染色体 chr12 大小: 120,129,022 bp, bins: 1202
2025-08-23 15:47:47,902 - INFO -    数据形状: (3567, 3)
2025-08-23 15:47:47,902 - INFO -    bin 范围: 30-1199, 31-1199
2025-08-23 15:47:47,903 - INFO -    矩阵大小: (1202, 1202), 非零元素: 6,414, 稀疏度: 0.004439
2025-08-23 15:47:47,903 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:47,903 - INFO - 🔥 MPS Gaussian filter: 1202x1202 matrix, 内存需求: 22.1MB
2025-08-23 15:47:47,913 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:47,919 - INFO -    卷积耗时: 0.015 秒
2025-08-23 15:47:47,920 - INFO - 🚀 MPS 加速: 1202x1202 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0194)
2025-08-23 15:47:47,920 - INFO - 🚀 Using MPS for 1202x1202 matrix with 24GB GPU memory
2025-08-23 15:47:47,920 - INFO - Converting 1202x1202 sparse matrix to dense for MPS...
2025-08-23 15:47:47,926 - INFO - 💾 Estimated GPU memory usage: 16.5 MB
2025-08-23 15:47:47,942 - INFO - 🔥 MPS Iter 1 takes 0.011 seconds. Loss: 3.620
2025-08-23 15:47:47,947 - INFO - 🔥 MPS Iter 2 takes 0.023 seconds. Loss: 0.640
2025-08-23 15:47:47,951 - INFO - 🔥 MPS Iter 3 takes 0.028 seconds. Loss: 0.167
2025-08-23 15:47:47,954 - INFO - 🔥 MPS Iter 4 takes 0.032 seconds. Loss: 0.050
2025-08-23 15:47:47,957 - INFO - 🔥 MPS Iter 5 takes 0.035 seconds. Loss: 0.017
2025-08-23 15:47:47,961 - INFO - 🔥 MPS Iter 6 takes 0.038 seconds. Loss: 0.006
2025-08-23 15:47:47,962 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:47,962 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:47,964 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:47,985 - INFO -    RWR 耗时: 0.066 秒
2025-08-23 15:47:48,003 - INFO -    归一化耗时: 0.018 秒
2025-08-23 15:47:48,137 - INFO -    ✅ 完成，总耗时: 0.099 秒
2025-08-23 15:47:48,137 - INFO -   ✅ chr12: 完成，耗时 0.24 秒
2025-08-23 15:47:48,138 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-23 15:47:48,138 - INFO -    染色体 chr13 大小: 120,421,639 bp, bins: 1205
2025-08-23 15:47:48,140 - INFO -    数据形状: (4460, 3)
2025-08-23 15:47:48,140 - INFO -    bin 范围: 30-1203, 30-1203
2025-08-23 15:47:48,141 - INFO -    矩阵大小: (1205, 1205), 非零元素: 8,094, 稀疏度: 0.005574
2025-08-23 15:47:48,141 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:48,141 - INFO - 🔥 MPS Gaussian filter: 1205x1205 matrix, 内存需求: 22.2MB
2025-08-23 15:47:48,151 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:48,157 - INFO -    卷积耗时: 0.016 秒
2025-08-23 15:47:48,159 - INFO - 🚀 MPS 加速: 1205x1205 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0253)
2025-08-23 15:47:48,159 - INFO - 🚀 Using MPS for 1205x1205 matrix with 24GB GPU memory
2025-08-23 15:47:48,159 - INFO - Converting 1205x1205 sparse matrix to dense for MPS...
2025-08-23 15:47:48,165 - INFO - 💾 Estimated GPU memory usage: 16.6 MB
2025-08-23 15:47:48,180 - INFO - 🔥 MPS Iter 1 takes 0.011 seconds. Loss: 3.112
2025-08-23 15:47:48,185 - INFO - 🔥 MPS Iter 2 takes 0.021 seconds. Loss: 0.503
2025-08-23 15:47:48,189 - INFO - 🔥 MPS Iter 3 takes 0.027 seconds. Loss: 0.125
2025-08-23 15:47:48,193 - INFO - 🔥 MPS Iter 4 takes 0.030 seconds. Loss: 0.038
2025-08-23 15:47:48,196 - INFO - 🔥 MPS Iter 5 takes 0.034 seconds. Loss: 0.013
2025-08-23 15:47:48,201 - INFO - 🔥 MPS Iter 6 takes 0.038 seconds. Loss: 0.005
2025-08-23 15:47:48,201 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:48,201 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:48,202 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:48,223 - INFO -    RWR 耗时: 0.065 秒
2025-08-23 15:47:48,239 - INFO -    归一化耗时: 0.016 秒
2025-08-23 15:47:48,372 - INFO -    ✅ 完成，总耗时: 0.097 秒
2025-08-23 15:47:48,373 - INFO -   ✅ chr13: 完成，耗时 0.24 秒
2025-08-23 15:47:48,373 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-23 15:47:48,374 - INFO -    染色体 chr14 大小: 124,902,244 bp, bins: 1250
2025-08-23 15:47:48,376 - INFO -    数据形状: (3847, 3)
2025-08-23 15:47:48,376 - INFO -    bin 范围: 39-1247, 42-1247
2025-08-23 15:47:48,376 - INFO -    矩阵大小: (1250, 1250), 非零元素: 6,940, 稀疏度: 0.004442
2025-08-23 15:47:48,377 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:48,377 - INFO - 🔥 MPS Gaussian filter: 1250x1250 matrix, 内存需求: 23.9MB
2025-08-23 15:47:48,386 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:48,393 - INFO -    卷积耗时: 0.016 秒
2025-08-23 15:47:48,395 - INFO - 🚀 MPS 加速: 1250x1250 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0197)
2025-08-23 15:47:48,395 - INFO - 🚀 Using MPS for 1250x1250 matrix with 24GB GPU memory
2025-08-23 15:47:48,395 - INFO - Converting 1250x1250 sparse matrix to dense for MPS...
2025-08-23 15:47:48,401 - INFO - 💾 Estimated GPU memory usage: 17.9 MB
2025-08-23 15:47:48,413 - INFO - 🔥 MPS Iter 1 takes 0.011 seconds. Loss: 3.748
2025-08-23 15:47:48,418 - INFO - 🔥 MPS Iter 2 takes 0.019 seconds. Loss: 0.728
2025-08-23 15:47:48,424 - INFO - 🔥 MPS Iter 3 takes 0.025 seconds. Loss: 0.210
2025-08-23 15:47:48,428 - INFO - 🔥 MPS Iter 4 takes 0.030 seconds. Loss: 0.068
2025-08-23 15:47:48,432 - INFO - 🔥 MPS Iter 5 takes 0.034 seconds. Loss: 0.024
2025-08-23 15:47:48,437 - INFO - 🔥 MPS Iter 6 takes 0.038 seconds. Loss: 0.009
2025-08-23 15:47:48,437 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:48,437 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:48,438 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:48,460 - INFO -    RWR 耗时: 0.067 秒
2025-08-23 15:47:48,479 - INFO -    归一化耗时: 0.019 秒
2025-08-23 15:47:48,614 - INFO -    ✅ 完成，总耗时: 0.101 秒
2025-08-23 15:47:48,614 - INFO -   ✅ chr14: 完成，耗时 0.24 秒
2025-08-23 15:47:48,614 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-23 15:47:48,615 - INFO -    染色体 chr15 大小: 104,043,685 bp, bins: 1041
2025-08-23 15:47:48,617 - INFO -    数据形状: (3201, 3)
2025-08-23 15:47:48,617 - INFO -    bin 范围: 31-1038, 31-1039
2025-08-23 15:47:48,617 - INFO -    矩阵大小: (1041, 1041), 非零元素: 5,718, 稀疏度: 0.005276
2025-08-23 15:47:48,617 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:48,617 - INFO - 🔥 MPS Gaussian filter: 1041x1041 matrix, 内存需求: 16.6MB
2025-08-23 15:47:48,627 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:48,632 - INFO -    卷积耗时: 0.015 秒
2025-08-23 15:47:48,633 - INFO - 🚀 MPS 加速: 1041x1041 矩阵 (内存需求: 0.01GB, 稀疏度: 0.0225)
2025-08-23 15:47:48,633 - INFO - 🚀 Using MPS for 1041x1041 matrix with 24GB GPU memory
2025-08-23 15:47:48,633 - INFO - Converting 1041x1041 sparse matrix to dense for MPS...
2025-08-23 15:47:48,639 - INFO - 💾 Estimated GPU memory usage: 12.4 MB
2025-08-23 15:47:48,647 - INFO - 🔥 MPS Iter 1 takes 0.010 seconds. Loss: 3.255
2025-08-23 15:47:48,652 - INFO - 🔥 MPS Iter 2 takes 0.014 seconds. Loss: 0.556
2025-08-23 15:47:48,656 - INFO - 🔥 MPS Iter 3 takes 0.019 seconds. Loss: 0.138
2025-08-23 15:47:48,661 - INFO - 🔥 MPS Iter 4 takes 0.024 seconds. Loss: 0.041
2025-08-23 15:47:48,664 - INFO - 🔥 MPS Iter 5 takes 0.028 seconds. Loss: 0.015
2025-08-23 15:47:48,668 - INFO - 🔥 MPS Iter 6 takes 0.031 seconds. Loss: 0.006
2025-08-23 15:47:48,669 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:48,669 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:48,669 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:48,685 - INFO -    RWR 耗时: 0.053 秒
2025-08-23 15:47:48,697 - INFO -    归一化耗时: 0.012 秒
2025-08-23 15:47:48,794 - INFO -    ✅ 完成，总耗时: 0.079 秒
2025-08-23 15:47:48,795 - INFO -   ✅ chr15: 完成，耗时 0.18 秒
2025-08-23 15:47:48,795 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-23 15:47:48,796 - INFO -    染色体 chr16 大小: 98,207,768 bp, bins: 983
2025-08-23 15:47:48,797 - INFO -    数据形状: (3022, 3)
2025-08-23 15:47:48,798 - INFO -    bin 范围: 32-980, 32-980
2025-08-23 15:47:48,798 - INFO -    矩阵大小: (983, 983), 非零元素: 5,471, 稀疏度: 0.005662
2025-08-23 15:47:48,798 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:48,798 - INFO - 🔥 MPS Gaussian filter: 983x983 matrix, 内存需求: 14.8MB
2025-08-23 15:47:48,807 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:48,811 - INFO -    卷积耗时: 0.013 秒
2025-08-23 15:47:48,813 - INFO - 🚀 MPS 加速: 983x983 矩阵 (内存需求: 0.01GB, 稀疏度: 0.0256)
2025-08-23 15:47:48,813 - INFO - 🚀 Using MPS for 983x983 matrix with 24GB GPU memory
2025-08-23 15:47:48,813 - INFO - Converting 983x983 sparse matrix to dense for MPS...
2025-08-23 15:47:48,817 - INFO - 💾 Estimated GPU memory usage: 11.1 MB
2025-08-23 15:47:48,911 - INFO - 🔥 MPS Iter 1 takes 0.092 seconds. Loss: 2.977
2025-08-23 15:47:48,915 - INFO - 🔥 MPS Iter 2 takes 0.099 seconds. Loss: 0.498
2025-08-23 15:47:48,917 - INFO - 🔥 MPS Iter 3 takes 0.102 seconds. Loss: 0.122
2025-08-23 15:47:48,920 - INFO - 🔥 MPS Iter 4 takes 0.105 seconds. Loss: 0.036
2025-08-23 15:47:48,922 - INFO - 🔥 MPS Iter 5 takes 0.108 seconds. Loss: 0.013
2025-08-23 15:47:48,924 - INFO - 🔥 MPS Iter 6 takes 0.110 seconds. Loss: 0.005
2025-08-23 15:47:48,924 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:48,925 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:48,925 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:48,938 - INFO -    RWR 耗时: 0.127 秒
2025-08-23 15:47:48,949 - INFO -    归一化耗时: 0.010 秒
2025-08-23 15:47:49,038 - INFO -    ✅ 完成，总耗时: 0.150 秒
2025-08-23 15:47:49,038 - INFO -   ✅ chr16: 完成，耗时 0.24 秒
2025-08-23 15:47:49,039 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-23 15:47:49,040 - INFO -    染色体 chr17 大小: 94,987,271 bp, bins: 950
2025-08-23 15:47:49,041 - INFO -    数据形状: (3109, 3)
2025-08-23 15:47:49,041 - INFO -    bin 范围: 30-948, 30-948
2025-08-23 15:47:49,042 - INFO -    矩阵大小: (950, 950), 非零元素: 5,587, 稀疏度: 0.006191
2025-08-23 15:47:49,043 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:49,043 - INFO - 🔥 MPS Gaussian filter: 950x950 matrix, 内存需求: 13.8MB
2025-08-23 15:47:49,052 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:49,056 - INFO -    卷积耗时: 0.014 秒
2025-08-23 15:47:49,057 - INFO - 🚀 MPS 加速: 950x950 矩阵 (内存需求: 0.01GB, 稀疏度: 0.0270)
2025-08-23 15:47:49,057 - INFO - 🚀 Using MPS for 950x950 matrix with 24GB GPU memory
2025-08-23 15:47:49,057 - INFO - Converting 950x950 sparse matrix to dense for MPS...
2025-08-23 15:47:49,064 - INFO - 💾 Estimated GPU memory usage: 10.3 MB
2025-08-23 15:47:49,075 - INFO - 🔥 MPS Iter 1 takes 0.013 seconds. Loss: 2.956
2025-08-23 15:47:49,082 - INFO - 🔥 MPS Iter 2 takes 0.019 seconds. Loss: 0.486
2025-08-23 15:47:49,087 - INFO - 🔥 MPS Iter 3 takes 0.026 seconds. Loss: 0.121
2025-08-23 15:47:49,091 - INFO - 🔥 MPS Iter 4 takes 0.031 seconds. Loss: 0.037
2025-08-23 15:47:49,094 - INFO - 🔥 MPS Iter 5 takes 0.035 seconds. Loss: 0.013
2025-08-23 15:47:49,098 - INFO - 🔥 MPS Iter 6 takes 0.038 seconds. Loss: 0.005
2025-08-23 15:47:49,098 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:49,098 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:49,100 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:49,112 - INFO -    RWR 耗时: 0.056 秒
2025-08-23 15:47:49,122 - INFO -    归一化耗时: 0.010 秒
2025-08-23 15:47:49,207 - INFO -    ✅ 完成，总耗时: 0.079 秒
2025-08-23 15:47:49,208 - INFO -   ✅ chr17: 完成，耗时 0.17 秒
2025-08-23 15:47:49,208 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-23 15:47:49,208 - INFO -    染色体 chr18 大小: 90,702,639 bp, bins: 908
2025-08-23 15:47:49,210 - INFO -    数据形状: (3135, 3)
2025-08-23 15:47:49,210 - INFO -    bin 范围: 30-904, 30-905
2025-08-23 15:47:49,210 - INFO -    矩阵大小: (908, 908), 非零元素: 5,670, 稀疏度: 0.006877
2025-08-23 15:47:49,211 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:49,211 - INFO - 🔥 MPS Gaussian filter: 908x908 matrix, 内存需求: 12.6MB
2025-08-23 15:47:49,219 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:49,223 - INFO -    卷积耗时: 0.012 秒
2025-08-23 15:47:49,223 - INFO - 🚀 MPS 加速: 908x908 矩阵 (内存需求: 0.01GB, 稀疏度: 0.0303)
2025-08-23 15:47:49,223 - INFO - 🚀 Using MPS for 908x908 matrix with 24GB GPU memory
2025-08-23 15:47:49,223 - INFO - Converting 908x908 sparse matrix to dense for MPS...
2025-08-23 15:47:49,228 - INFO - 💾 Estimated GPU memory usage: 9.4 MB
2025-08-23 15:47:49,300 - INFO - 🔥 MPS Iter 1 takes 0.073 seconds. Loss: 2.796
2025-08-23 15:47:49,306 - INFO - 🔥 MPS Iter 2 takes 0.078 seconds. Loss: 0.455
2025-08-23 15:47:49,310 - INFO - 🔥 MPS Iter 3 takes 0.084 seconds. Loss: 0.112
2025-08-23 15:47:49,313 - INFO - 🔥 MPS Iter 4 takes 0.087 seconds. Loss: 0.034
2025-08-23 15:47:49,316 - INFO - 🔥 MPS Iter 5 takes 0.090 seconds. Loss: 0.012
2025-08-23 15:47:49,318 - INFO - 🔥 MPS Iter 6 takes 0.094 seconds. Loss: 0.005
2025-08-23 15:47:49,319 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:49,319 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:49,320 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:49,332 - INFO -    RWR 耗时: 0.109 秒
2025-08-23 15:47:49,341 - INFO -    归一化耗时: 0.009 秒
2025-08-23 15:47:49,445 - INFO -    ✅ 完成，总耗时: 0.130 秒
2025-08-23 15:47:49,446 - INFO -   ✅ chr18: 完成，耗时 0.24 秒
2025-08-23 15:47:49,446 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-23 15:47:49,447 - INFO -    染色体 chr19 大小: 61,431,566 bp, bins: 615
2025-08-23 15:47:49,449 - INFO -    数据形状: (1977, 3)
2025-08-23 15:47:49,449 - INFO -    bin 范围: 31-613, 31-613
2025-08-23 15:47:49,449 - INFO -    矩阵大小: (615, 615), 非零元素: 3,525, 稀疏度: 0.009320
2025-08-23 15:47:49,449 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:49,449 - INFO - 🔥 MPS Gaussian filter: 615x615 matrix, 内存需求: 5.8MB
2025-08-23 15:47:49,456 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:49,458 - INFO -    卷积耗时: 0.009 秒
2025-08-23 15:47:49,459 - INFO - 🚀 MPS 加速: 615x615 矩阵 (内存需求: 0.00GB, 稀疏度: 0.0407)
2025-08-23 15:47:49,459 - INFO - 🚀 Using MPS for 615x615 matrix with 24GB GPU memory
2025-08-23 15:47:49,459 - INFO - Converting 615x615 sparse matrix to dense for MPS...
2025-08-23 15:47:49,463 - INFO - 💾 Estimated GPU memory usage: 4.3 MB
2025-08-23 15:47:49,470 - INFO - 🔥 MPS Iter 1 takes 0.010 seconds. Loss: 2.360
2025-08-23 15:47:49,474 - INFO - 🔥 MPS Iter 2 takes 0.013 seconds. Loss: 0.388
2025-08-23 15:47:49,475 - INFO - 🔥 MPS Iter 3 takes 0.015 seconds. Loss: 0.097
2025-08-23 15:47:49,479 - INFO - 🔥 MPS Iter 4 takes 0.017 seconds. Loss: 0.030
2025-08-23 15:47:49,482 - INFO - 🔥 MPS Iter 5 takes 0.021 seconds. Loss: 0.011
2025-08-23 15:47:49,483 - INFO - 🔥 MPS Iter 6 takes 0.023 seconds. Loss: 0.004
2025-08-23 15:47:49,484 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:49,484 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:49,484 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:49,490 - INFO -    RWR 耗时: 0.031 秒
2025-08-23 15:47:49,495 - INFO -    归一化耗时: 0.006 秒
2025-08-23 15:47:49,532 - INFO -    ✅ 完成，总耗时: 0.046 秒
2025-08-23 15:47:49,532 - INFO -   ✅ chr19: 完成，耗时 0.09 秒
2025-08-23 15:47:49,532 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-23 15:47:49,533 - INFO -    染色体 chrX 大小: 171,031,299 bp, bins: 1711
2025-08-23 15:47:49,534 - INFO -    数据形状: (2286, 3)
2025-08-23 15:47:49,535 - INFO -    bin 范围: 45-1699, 56-1699
2025-08-23 15:47:49,535 - INFO -    矩阵大小: (1711, 1711), 非零元素: 4,063, 稀疏度: 0.001388
2025-08-23 15:47:49,535 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:49,535 - INFO - 🔥 MPS Gaussian filter: 1711x1711 matrix, 内存需求: 44.7MB
2025-08-23 15:47:49,582 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:49,594 - INFO -    卷积耗时: 0.059 秒
2025-08-23 15:47:49,595 - INFO - 🚀 MPS 加速: 1711x1711 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0076)
2025-08-23 15:47:49,595 - INFO - 🚀 Using MPS for 1711x1711 matrix with 24GB GPU memory
2025-08-23 15:47:49,595 - INFO - Converting 1711x1711 sparse matrix to dense for MPS...
2025-08-23 15:47:49,652 - INFO - 💾 Estimated GPU memory usage: 33.5 MB
2025-08-23 15:47:49,670 - INFO - 🔥 MPS Iter 1 takes 0.061 seconds. Loss: 5.970
2025-08-23 15:47:49,678 - INFO - 🔥 MPS Iter 2 takes 0.075 seconds. Loss: 1.407
2025-08-23 15:47:49,685 - INFO - 🔥 MPS Iter 3 takes 0.083 seconds. Loss: 0.457
2025-08-23 15:47:49,693 - INFO - 🔥 MPS Iter 4 takes 0.091 seconds. Loss: 0.163
2025-08-23 15:47:49,701 - INFO - 🔥 MPS Iter 5 takes 0.099 seconds. Loss: 0.066
2025-08-23 15:47:49,708 - INFO - 🔥 MPS Iter 6 takes 0.106 seconds. Loss: 0.028
2025-08-23 15:47:49,717 - INFO - 🔥 MPS Iter 7 takes 0.114 seconds. Loss: 0.012
2025-08-23 15:47:49,724 - INFO - 🔥 MPS Iter 8 takes 0.123 seconds. Loss: 0.005
2025-08-23 15:47:49,726 - INFO - ✅ Converged after 8 iterations
2025-08-23 15:47:49,726 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:49,727 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:49,759 - INFO -    RWR 耗时: 0.165 秒
2025-08-23 15:47:49,783 - INFO -    归一化耗时: 0.023 秒
2025-08-23 15:47:49,949 - INFO -    ✅ 完成，总耗时: 0.247 秒
2025-08-23 15:47:49,949 - INFO -   ✅ chrX: 完成，耗时 0.42 秒
2025-08-23 15:47:49,949 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 0.1 分钟
2025-08-23 15:47:49,949 - INFO - 📊 处理: GasfE703154 (2/2)
2025-08-23 15:47:49,949 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:47:49,949 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-23 15:47:49,950 - INFO -    染色体 chr1 大小: 195,471,971 bp, bins: 1955
2025-08-23 15:47:49,952 - INFO -    数据形状: (4208, 3)
2025-08-23 15:47:49,952 - INFO -    bin 范围: 30-1947, 30-1953
2025-08-23 15:47:49,952 - INFO -    矩阵大小: (1955, 1955), 非零元素: 7,744, 稀疏度: 0.002026
2025-08-23 15:47:49,952 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:49,952 - INFO - 🔥 MPS Gaussian filter: 1955x1955 matrix, 内存需求: 58.4MB
2025-08-23 15:47:49,971 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:49,988 - INFO -    卷积耗时: 0.035 秒
2025-08-23 15:47:49,989 - INFO - 🚀 MPS 加速: 1955x1955 矩阵 (内存需求: 0.04GB, 稀疏度: 0.0138)
2025-08-23 15:47:49,989 - INFO - 🚀 Using MPS for 1955x1955 matrix with 24GB GPU memory
2025-08-23 15:47:49,989 - INFO - Converting 1955x1955 sparse matrix to dense for MPS...
2025-08-23 15:47:50,032 - INFO - 💾 Estimated GPU memory usage: 43.7 MB
2025-08-23 15:47:50,043 - INFO - 🔥 MPS Iter 1 takes 0.043 seconds. Loss: 4.688
2025-08-23 15:47:50,055 - INFO - 🔥 MPS Iter 2 takes 0.056 seconds. Loss: 0.858
2025-08-23 15:47:50,066 - INFO - 🔥 MPS Iter 3 takes 0.067 seconds. Loss: 0.198
2025-08-23 15:47:50,077 - INFO - 🔥 MPS Iter 4 takes 0.079 seconds. Loss: 0.050
2025-08-23 15:47:50,088 - INFO - 🔥 MPS Iter 5 takes 0.089 seconds. Loss: 0.014
2025-08-23 15:47:50,100 - INFO - 🔥 MPS Iter 6 takes 0.100 seconds. Loss: 0.005
2025-08-23 15:47:50,101 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:50,101 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:50,102 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:50,155 - INFO -    RWR 耗时: 0.167 秒
2025-08-23 15:47:50,196 - INFO -    归一化耗时: 0.041 秒
2025-08-23 15:47:50,546 - INFO -    ✅ 完成，总耗时: 0.243 秒
2025-08-23 15:47:50,547 - INFO -   ✅ chr1: 完成，耗时 0.60 秒
2025-08-23 15:47:50,547 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-23 15:47:50,547 - INFO -    染色体 chr2 大小: 182,113,224 bp, bins: 1822
2025-08-23 15:47:50,549 - INFO -    数据形状: (3686, 3)
2025-08-23 15:47:50,549 - INFO -    bin 范围: 30-1818, 33-1820
2025-08-23 15:47:50,550 - INFO -    矩阵大小: (1822, 1822), 非零元素: 6,694, 稀疏度: 0.002016
2025-08-23 15:47:50,550 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:50,550 - INFO - 🔥 MPS Gaussian filter: 1822x1822 matrix, 内存需求: 50.7MB
2025-08-23 15:47:50,568 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:50,582 - INFO -    卷积耗时: 0.032 秒
2025-08-23 15:47:50,583 - INFO - 🚀 MPS 加速: 1822x1822 矩阵 (内存需求: 0.04GB, 稀疏度: 0.0133)
2025-08-23 15:47:50,583 - INFO - 🚀 Using MPS for 1822x1822 matrix with 24GB GPU memory
2025-08-23 15:47:50,583 - INFO - Converting 1822x1822 sparse matrix to dense for MPS...
2025-08-23 15:47:50,628 - INFO - 💾 Estimated GPU memory usage: 38.0 MB
2025-08-23 15:47:50,645 - INFO - 🔥 MPS Iter 1 takes 0.045 seconds. Loss: 4.785
2025-08-23 15:47:50,655 - INFO - 🔥 MPS Iter 2 takes 0.063 seconds. Loss: 0.909
2025-08-23 15:47:50,664 - INFO - 🔥 MPS Iter 3 takes 0.073 seconds. Loss: 0.220
2025-08-23 15:47:50,673 - INFO - 🔥 MPS Iter 4 takes 0.081 seconds. Loss: 0.058
2025-08-23 15:47:50,682 - INFO - 🔥 MPS Iter 5 takes 0.090 seconds. Loss: 0.017
2025-08-23 15:47:50,691 - INFO - 🔥 MPS Iter 6 takes 0.099 seconds. Loss: 0.006
2025-08-23 15:47:50,691 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:50,691 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:50,693 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:50,737 - INFO -    RWR 耗时: 0.155 秒
2025-08-23 15:47:50,777 - INFO -    归一化耗时: 0.039 秒
2025-08-23 15:47:51,066 - INFO -    ✅ 完成，总耗时: 0.226 秒
2025-08-23 15:47:51,067 - INFO -   ✅ chr2: 完成，耗时 0.52 秒
2025-08-23 15:47:51,067 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-23 15:47:51,068 - INFO -    染色体 chr3 大小: 160,039,680 bp, bins: 1601
2025-08-23 15:47:51,070 - INFO -    数据形状: (3112, 3)
2025-08-23 15:47:51,070 - INFO -    bin 范围: 30-1598, 30-1599
2025-08-23 15:47:51,070 - INFO -    矩阵大小: (1601, 1601), 非零元素: 5,680, 稀疏度: 0.002216
2025-08-23 15:47:51,070 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:51,070 - INFO - 🔥 MPS Gaussian filter: 1601x1601 matrix, 内存需求: 39.2MB
2025-08-23 15:47:51,087 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:51,098 - INFO -    卷积耗时: 0.028 秒
2025-08-23 15:47:51,100 - INFO - 🚀 MPS 加速: 1601x1601 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0149)
2025-08-23 15:47:51,100 - INFO - 🚀 Using MPS for 1601x1601 matrix with 24GB GPU memory
2025-08-23 15:47:51,100 - INFO - Converting 1601x1601 sparse matrix to dense for MPS...
2025-08-23 15:47:51,106 - INFO - 💾 Estimated GPU memory usage: 29.3 MB
2025-08-23 15:47:51,124 - INFO - 🔥 MPS Iter 1 takes 0.006 seconds. Loss: 4.526
2025-08-23 15:47:51,132 - INFO - 🔥 MPS Iter 2 takes 0.025 seconds. Loss: 0.863
2025-08-23 15:47:51,138 - INFO - 🔥 MPS Iter 3 takes 0.032 seconds. Loss: 0.208
2025-08-23 15:47:51,145 - INFO - 🔥 MPS Iter 4 takes 0.038 seconds. Loss: 0.053
2025-08-23 15:47:51,150 - INFO - 🔥 MPS Iter 5 takes 0.045 seconds. Loss: 0.016
2025-08-23 15:47:51,157 - INFO - 🔥 MPS Iter 6 takes 0.051 seconds. Loss: 0.005
2025-08-23 15:47:51,158 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:51,158 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:51,160 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:51,194 - INFO -    RWR 耗时: 0.095 秒
2025-08-23 15:47:51,224 - INFO -    归一化耗时: 0.030 秒
2025-08-23 15:47:51,460 - INFO -    ✅ 完成，总耗时: 0.153 秒
2025-08-23 15:47:51,460 - INFO -   ✅ chr3: 完成，耗时 0.39 秒
2025-08-23 15:47:51,460 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-23 15:47:51,461 - INFO -    染色体 chr4 大小: 156,508,116 bp, bins: 1566
2025-08-23 15:47:51,463 - INFO -    数据形状: (2911, 3)
2025-08-23 15:47:51,463 - INFO -    bin 范围: 30-1563, 32-1563
2025-08-23 15:47:51,463 - INFO -    矩阵大小: (1566, 1566), 非零元素: 5,309, 稀疏度: 0.002165
2025-08-23 15:47:51,464 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:51,464 - INFO - 🔥 MPS Gaussian filter: 1566x1566 matrix, 内存需求: 37.5MB
2025-08-23 15:47:51,470 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:51,481 - INFO -    卷积耗时: 0.017 秒
2025-08-23 15:47:51,482 - INFO - 🚀 MPS 加速: 1566x1566 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0144)
2025-08-23 15:47:51,482 - INFO - 🚀 Using MPS for 1566x1566 matrix with 24GB GPU memory
2025-08-23 15:47:51,482 - INFO - Converting 1566x1566 sparse matrix to dense for MPS...
2025-08-23 15:47:51,486 - INFO - 💾 Estimated GPU memory usage: 28.1 MB
2025-08-23 15:47:51,501 - INFO - 🔥 MPS Iter 1 takes 0.004 seconds. Loss: 4.648
2025-08-23 15:47:51,509 - INFO - 🔥 MPS Iter 2 takes 0.021 seconds. Loss: 0.891
2025-08-23 15:47:51,515 - INFO - 🔥 MPS Iter 3 takes 0.028 seconds. Loss: 0.217
2025-08-23 15:47:51,522 - INFO - 🔥 MPS Iter 4 takes 0.035 seconds. Loss: 0.056
2025-08-23 15:47:51,528 - INFO - 🔥 MPS Iter 5 takes 0.041 seconds. Loss: 0.017
2025-08-23 15:47:51,534 - INFO - 🔥 MPS Iter 6 takes 0.047 seconds. Loss: 0.005
2025-08-23 15:47:51,535 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:51,535 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:51,536 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:51,570 - INFO -    RWR 耗时: 0.089 秒
2025-08-23 15:47:51,599 - INFO -    归一化耗时: 0.029 秒
2025-08-23 15:47:51,819 - INFO -    ✅ 完成，总耗时: 0.135 秒
2025-08-23 15:47:51,820 - INFO -   ✅ chr4: 完成，耗时 0.36 秒
2025-08-23 15:47:51,820 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-23 15:47:51,820 - INFO -    染色体 chr5 大小: 151,834,684 bp, bins: 1519
2025-08-23 15:47:51,822 - INFO -    数据形状: (3058, 3)
2025-08-23 15:47:51,822 - INFO -    bin 范围: 30-1516, 32-1516
2025-08-23 15:47:51,822 - INFO -    矩阵大小: (1519, 1519), 非零元素: 5,586, 稀疏度: 0.002421
2025-08-23 15:47:51,823 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:51,823 - INFO - 🔥 MPS Gaussian filter: 1519x1519 matrix, 内存需求: 35.3MB
2025-08-23 15:47:51,829 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:51,838 - INFO -    卷积耗时: 0.015 秒
2025-08-23 15:47:51,839 - INFO - 🚀 MPS 加速: 1519x1519 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0159)
2025-08-23 15:47:51,839 - INFO - 🚀 Using MPS for 1519x1519 matrix with 24GB GPU memory
2025-08-23 15:47:51,839 - INFO - Converting 1519x1519 sparse matrix to dense for MPS...
2025-08-23 15:47:51,842 - INFO - 💾 Estimated GPU memory usage: 26.4 MB
2025-08-23 15:47:51,851 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 4.328
2025-08-23 15:47:51,858 - INFO - 🔥 MPS Iter 2 takes 0.014 seconds. Loss: 0.791
2025-08-23 15:47:51,865 - INFO - 🔥 MPS Iter 3 takes 0.021 seconds. Loss: 0.188
2025-08-23 15:47:51,870 - INFO - 🔥 MPS Iter 4 takes 0.027 seconds. Loss: 0.047
2025-08-23 15:47:51,876 - INFO - 🔥 MPS Iter 5 takes 0.033 seconds. Loss: 0.014
2025-08-23 15:47:51,882 - INFO - 🔥 MPS Iter 6 takes 0.039 seconds. Loss: 0.004
2025-08-23 15:47:51,883 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:51,883 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:51,885 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:51,914 - INFO -    RWR 耗时: 0.076 秒
2025-08-23 15:47:51,943 - INFO -    归一化耗时: 0.028 秒
2025-08-23 15:47:52,148 - INFO -    ✅ 完成，总耗时: 0.119 秒
2025-08-23 15:47:52,148 - INFO -   ✅ chr5: 完成，耗时 0.33 秒
2025-08-23 15:47:52,149 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-23 15:47:52,149 - INFO -    染色体 chr6 大小: 149,736,546 bp, bins: 1498
2025-08-23 15:47:52,151 - INFO -    数据形状: (2980, 3)
2025-08-23 15:47:52,151 - INFO -    bin 范围: 32-1492, 32-1495
2025-08-23 15:47:52,151 - INFO -    矩阵大小: (1498, 1498), 非零元素: 5,439, 稀疏度: 0.002424
2025-08-23 15:47:52,152 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:52,152 - INFO - 🔥 MPS Gaussian filter: 1498x1498 matrix, 内存需求: 34.3MB
2025-08-23 15:47:52,158 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:52,167 - INFO -    卷积耗时: 0.015 秒
2025-08-23 15:47:52,168 - INFO - 🚀 MPS 加速: 1498x1498 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0161)
2025-08-23 15:47:52,168 - INFO - 🚀 Using MPS for 1498x1498 matrix with 24GB GPU memory
2025-08-23 15:47:52,168 - INFO - Converting 1498x1498 sparse matrix to dense for MPS...
2025-08-23 15:47:52,171 - INFO - 💾 Estimated GPU memory usage: 25.7 MB
2025-08-23 15:47:52,184 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 4.366
2025-08-23 15:47:52,191 - INFO - 🔥 MPS Iter 2 takes 0.016 seconds. Loss: 0.837
2025-08-23 15:47:52,198 - INFO - 🔥 MPS Iter 3 takes 0.024 seconds. Loss: 0.200
2025-08-23 15:47:52,203 - INFO - 🔥 MPS Iter 4 takes 0.030 seconds. Loss: 0.051
2025-08-23 15:47:52,210 - INFO - 🔥 MPS Iter 5 takes 0.037 seconds. Loss: 0.015
2025-08-23 15:47:52,216 - INFO - 🔥 MPS Iter 6 takes 0.043 seconds. Loss: 0.005
2025-08-23 15:47:52,216 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:52,216 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:52,218 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:52,249 - INFO -    RWR 耗时: 0.082 秒
2025-08-23 15:47:52,276 - INFO -    归一化耗时: 0.026 秒
2025-08-23 15:47:52,480 - INFO -    ✅ 完成，总耗时: 0.123 秒
2025-08-23 15:47:52,481 - INFO -   ✅ chr6: 完成，耗时 0.33 秒
2025-08-23 15:47:52,481 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-23 15:47:52,482 - INFO -    染色体 chr7 大小: 145,441,459 bp, bins: 1455
2025-08-23 15:47:52,484 - INFO -    数据形状: (2875, 3)
2025-08-23 15:47:52,484 - INFO -    bin 范围: 31-1452, 31-1453
2025-08-23 15:47:52,484 - INFO -    矩阵大小: (1455, 1455), 非零元素: 5,272, 稀疏度: 0.002490
2025-08-23 15:47:52,485 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:52,485 - INFO - 🔥 MPS Gaussian filter: 1455x1455 matrix, 内存需求: 32.3MB
2025-08-23 15:47:52,491 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:52,500 - INFO -    卷积耗时: 0.016 秒
2025-08-23 15:47:52,501 - INFO - 🚀 MPS 加速: 1455x1455 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0166)
2025-08-23 15:47:52,501 - INFO - 🚀 Using MPS for 1455x1455 matrix with 24GB GPU memory
2025-08-23 15:47:52,501 - INFO - Converting 1455x1455 sparse matrix to dense for MPS...
2025-08-23 15:47:52,505 - INFO - 💾 Estimated GPU memory usage: 24.2 MB
2025-08-23 15:47:52,518 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 4.278
2025-08-23 15:47:52,528 - INFO - 🔥 MPS Iter 2 takes 0.019 seconds. Loss: 0.833
2025-08-23 15:47:52,533 - INFO - 🔥 MPS Iter 3 takes 0.027 seconds. Loss: 0.211
2025-08-23 15:47:52,537 - INFO - 🔥 MPS Iter 4 takes 0.032 seconds. Loss: 0.056
2025-08-23 15:47:52,543 - INFO - 🔥 MPS Iter 5 takes 0.036 seconds. Loss: 0.017
2025-08-23 15:47:52,548 - INFO - 🔥 MPS Iter 6 takes 0.042 seconds. Loss: 0.005
2025-08-23 15:47:52,548 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:52,548 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:52,549 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:52,577 - INFO -    RWR 耗时: 0.077 秒
2025-08-23 15:47:52,604 - INFO -    归一化耗时: 0.027 秒
2025-08-23 15:47:52,786 - INFO -    ✅ 完成，总耗时: 0.119 秒
2025-08-23 15:47:52,787 - INFO -   ✅ chr7: 完成，耗时 0.31 秒
2025-08-23 15:47:52,787 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-23 15:47:52,788 - INFO -    染色体 chr8 大小: 129,401,213 bp, bins: 1295
2025-08-23 15:47:52,789 - INFO -    数据形状: (2655, 3)
2025-08-23 15:47:52,789 - INFO -    bin 范围: 30-1289, 31-1292
2025-08-23 15:47:52,790 - INFO -    矩阵大小: (1295, 1295), 非零元素: 4,827, 稀疏度: 0.002878
2025-08-23 15:47:52,790 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:52,790 - INFO - 🔥 MPS Gaussian filter: 1295x1295 matrix, 内存需求: 25.6MB
2025-08-23 15:47:52,796 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:52,803 - INFO -    卷积耗时: 0.014 秒
2025-08-23 15:47:52,805 - INFO - 🚀 MPS 加速: 1295x1295 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0189)
2025-08-23 15:47:52,805 - INFO - 🚀 Using MPS for 1295x1295 matrix with 24GB GPU memory
2025-08-23 15:47:52,805 - INFO - Converting 1295x1295 sparse matrix to dense for MPS...
2025-08-23 15:47:52,808 - INFO - 💾 Estimated GPU memory usage: 19.2 MB
2025-08-23 15:47:52,813 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 4.000
2025-08-23 15:47:52,818 - INFO - 🔥 MPS Iter 2 takes 0.009 seconds. Loss: 0.767
2025-08-23 15:47:52,822 - INFO - 🔥 MPS Iter 3 takes 0.014 seconds. Loss: 0.186
2025-08-23 15:47:52,826 - INFO - 🔥 MPS Iter 4 takes 0.017 seconds. Loss: 0.048
2025-08-23 15:47:52,830 - INFO - 🔥 MPS Iter 5 takes 0.022 seconds. Loss: 0.014
2025-08-23 15:47:52,834 - INFO - 🔥 MPS Iter 6 takes 0.026 seconds. Loss: 0.004
2025-08-23 15:47:52,834 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:52,834 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:52,836 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:52,858 - INFO -    RWR 耗时: 0.054 秒
2025-08-23 15:47:52,880 - INFO -    归一化耗时: 0.022 秒
2025-08-23 15:47:53,038 - INFO -    ✅ 完成，总耗时: 0.089 秒
2025-08-23 15:47:53,039 - INFO -   ✅ chr8: 完成，耗时 0.25 秒
2025-08-23 15:47:53,039 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-23 15:47:53,040 - INFO -    染色体 chr9 大小: 124,595,110 bp, bins: 1246
2025-08-23 15:47:53,042 - INFO -    数据形状: (2521, 3)
2025-08-23 15:47:53,042 - INFO -    bin 范围: 30-1243, 30-1243
2025-08-23 15:47:53,043 - INFO -    矩阵大小: (1246, 1246), 非零元素: 4,572, 稀疏度: 0.002945
2025-08-23 15:47:53,043 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:53,043 - INFO - 🔥 MPS Gaussian filter: 1246x1246 matrix, 内存需求: 23.7MB
2025-08-23 15:47:53,048 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:53,055 - INFO -    卷积耗时: 0.012 秒
2025-08-23 15:47:53,056 - INFO - 🚀 MPS 加速: 1246x1246 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0189)
2025-08-23 15:47:53,056 - INFO - 🚀 Using MPS for 1246x1246 matrix with 24GB GPU memory
2025-08-23 15:47:53,056 - INFO - Converting 1246x1246 sparse matrix to dense for MPS...
2025-08-23 15:47:53,058 - INFO - 💾 Estimated GPU memory usage: 17.8 MB
2025-08-23 15:47:53,071 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 3.968
2025-08-23 15:47:53,075 - INFO - 🔥 MPS Iter 2 takes 0.016 seconds. Loss: 0.750
2025-08-23 15:47:53,080 - INFO - 🔥 MPS Iter 3 takes 0.020 seconds. Loss: 0.181
2025-08-23 15:47:53,084 - INFO - 🔥 MPS Iter 4 takes 0.025 seconds. Loss: 0.047
2025-08-23 15:47:53,087 - INFO - 🔥 MPS Iter 5 takes 0.028 seconds. Loss: 0.014
2025-08-23 15:47:53,091 - INFO - 🔥 MPS Iter 6 takes 0.032 seconds. Loss: 0.004
2025-08-23 15:47:53,092 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:53,092 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:53,094 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:53,117 - INFO -    RWR 耗时: 0.061 秒
2025-08-23 15:47:53,134 - INFO -    归一化耗时: 0.017 秒
2025-08-23 15:47:53,278 - INFO -    ✅ 完成，总耗时: 0.091 秒
2025-08-23 15:47:53,279 - INFO -   ✅ chr9: 完成，耗时 0.24 秒
2025-08-23 15:47:53,279 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-23 15:47:53,280 - INFO -    染色体 chr10 大小: 130,694,993 bp, bins: 1307
2025-08-23 15:47:53,282 - INFO -    数据形状: (2558, 3)
2025-08-23 15:47:53,282 - INFO -    bin 范围: 31-1301, 31-1305
2025-08-23 15:47:53,282 - INFO -    矩阵大小: (1307, 1307), 非零元素: 4,672, 稀疏度: 0.002735
2025-08-23 15:47:53,283 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:53,283 - INFO - 🔥 MPS Gaussian filter: 1307x1307 matrix, 内存需求: 26.1MB
2025-08-23 15:47:53,287 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:53,295 - INFO -    卷积耗时: 0.012 秒
2025-08-23 15:47:53,296 - INFO - 🚀 MPS 加速: 1307x1307 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0180)
2025-08-23 15:47:53,296 - INFO - 🚀 Using MPS for 1307x1307 matrix with 24GB GPU memory
2025-08-23 15:47:53,296 - INFO - Converting 1307x1307 sparse matrix to dense for MPS...
2025-08-23 15:47:53,298 - INFO - 💾 Estimated GPU memory usage: 19.5 MB
2025-08-23 15:47:53,306 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 4.096
2025-08-23 15:47:53,312 - INFO - 🔥 MPS Iter 2 takes 0.012 seconds. Loss: 0.783
2025-08-23 15:47:53,317 - INFO - 🔥 MPS Iter 3 takes 0.017 seconds. Loss: 0.191
2025-08-23 15:47:53,321 - INFO - 🔥 MPS Iter 4 takes 0.022 seconds. Loss: 0.050
2025-08-23 15:47:53,325 - INFO - 🔥 MPS Iter 5 takes 0.026 seconds. Loss: 0.015
2025-08-23 15:47:53,330 - INFO - 🔥 MPS Iter 6 takes 0.031 seconds. Loss: 0.005
2025-08-23 15:47:53,330 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:53,330 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:53,332 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:53,356 - INFO -    RWR 耗时: 0.061 秒
2025-08-23 15:47:53,377 - INFO -    归一化耗时: 0.021 秒
2025-08-23 15:47:53,532 - INFO -    ✅ 完成，总耗时: 0.094 秒
2025-08-23 15:47:53,533 - INFO -   ✅ chr10: 完成，耗时 0.25 秒
2025-08-23 15:47:53,533 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-23 15:47:53,534 - INFO -    染色体 chr11 大小: 122,082,543 bp, bins: 1221
2025-08-23 15:47:53,536 - INFO -    数据形状: (2459, 3)
2025-08-23 15:47:53,536 - INFO -    bin 范围: 31-1217, 31-1219
2025-08-23 15:47:53,536 - INFO -    矩阵大小: (1221, 1221), 非零元素: 4,451, 稀疏度: 0.002986
2025-08-23 15:47:53,536 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:53,536 - INFO - 🔥 MPS Gaussian filter: 1221x1221 matrix, 内存需求: 22.8MB
2025-08-23 15:47:53,541 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:53,547 - INFO -    卷积耗时: 0.011 秒
2025-08-23 15:47:53,548 - INFO - 🚀 MPS 加速: 1221x1221 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0192)
2025-08-23 15:47:53,548 - INFO - 🚀 Using MPS for 1221x1221 matrix with 24GB GPU memory
2025-08-23 15:47:53,548 - INFO - Converting 1221x1221 sparse matrix to dense for MPS...
2025-08-23 15:47:53,550 - INFO - 💾 Estimated GPU memory usage: 17.1 MB
2025-08-23 15:47:53,557 - INFO - 🔥 MPS Iter 1 takes 0.002 seconds. Loss: 3.973
2025-08-23 15:47:53,564 - INFO - 🔥 MPS Iter 2 takes 0.010 seconds. Loss: 0.754
2025-08-23 15:47:53,568 - INFO - 🔥 MPS Iter 3 takes 0.016 seconds. Loss: 0.183
2025-08-23 15:47:53,572 - INFO - 🔥 MPS Iter 4 takes 0.020 seconds. Loss: 0.047
2025-08-23 15:47:53,576 - INFO - 🔥 MPS Iter 5 takes 0.025 seconds. Loss: 0.014
2025-08-23 15:47:53,580 - INFO - 🔥 MPS Iter 6 takes 0.029 seconds. Loss: 0.004
2025-08-23 15:47:53,581 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:53,581 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:53,582 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:53,602 - INFO -    RWR 耗时: 0.054 秒
2025-08-23 15:47:53,620 - INFO -    归一化耗时: 0.018 秒
2025-08-23 15:47:53,758 - INFO -    ✅ 完成，总耗时: 0.083 秒
2025-08-23 15:47:53,758 - INFO -   ✅ chr11: 完成，耗时 0.23 秒
2025-08-23 15:47:53,758 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-23 15:47:53,759 - INFO -    染色体 chr12 大小: 120,129,022 bp, bins: 1202
2025-08-23 15:47:53,761 - INFO -    数据形状: (2311, 3)
2025-08-23 15:47:53,761 - INFO -    bin 范围: 30-1198, 33-1200
2025-08-23 15:47:53,761 - INFO -    矩阵大小: (1202, 1202), 非零元素: 4,253, 稀疏度: 0.002944
2025-08-23 15:47:53,761 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:53,761 - INFO - 🔥 MPS Gaussian filter: 1202x1202 matrix, 内存需求: 22.1MB
2025-08-23 15:47:53,765 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:53,772 - INFO -    卷积耗时: 0.011 秒
2025-08-23 15:47:53,773 - INFO - 🚀 MPS 加速: 1202x1202 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0196)
2025-08-23 15:47:53,773 - INFO - 🚀 Using MPS for 1202x1202 matrix with 24GB GPU memory
2025-08-23 15:47:53,773 - INFO - Converting 1202x1202 sparse matrix to dense for MPS...
2025-08-23 15:47:53,775 - INFO - 💾 Estimated GPU memory usage: 16.5 MB
2025-08-23 15:47:53,783 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 4.002
2025-08-23 15:47:53,789 - INFO - 🔥 MPS Iter 2 takes 0.010 seconds. Loss: 0.768
2025-08-23 15:47:53,794 - INFO - 🔥 MPS Iter 3 takes 0.016 seconds. Loss: 0.193
2025-08-23 15:47:53,797 - INFO - 🔥 MPS Iter 4 takes 0.021 seconds. Loss: 0.051
2025-08-23 15:47:53,802 - INFO - 🔥 MPS Iter 5 takes 0.025 seconds. Loss: 0.016
2025-08-23 15:47:53,805 - INFO - 🔥 MPS Iter 6 takes 0.029 seconds. Loss: 0.005
2025-08-23 15:47:53,805 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:53,805 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:53,807 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:53,827 - INFO -    RWR 耗时: 0.055 秒
2025-08-23 15:47:53,845 - INFO -    归一化耗时: 0.018 秒
2025-08-23 15:47:54,049 - INFO -    ✅ 完成，总耗时: 0.083 秒
2025-08-23 15:47:54,050 - INFO -   ✅ chr12: 完成，耗时 0.29 秒
2025-08-23 15:47:54,050 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-23 15:47:54,051 - INFO -    染色体 chr13 大小: 120,421,639 bp, bins: 1205
2025-08-23 15:47:54,053 - INFO -    数据形状: (2281, 3)
2025-08-23 15:47:54,053 - INFO -    bin 范围: 31-1197, 31-1203
2025-08-23 15:47:54,053 - INFO -    矩阵大小: (1205, 1205), 非零元素: 4,137, 稀疏度: 0.002849
2025-08-23 15:47:54,054 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:54,054 - INFO - 🔥 MPS Gaussian filter: 1205x1205 matrix, 内存需求: 22.2MB
2025-08-23 15:47:54,058 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:54,065 - INFO -    卷积耗时: 0.011 秒
2025-08-23 15:47:54,066 - INFO - 🚀 MPS 加速: 1205x1205 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0184)
2025-08-23 15:47:54,066 - INFO - 🚀 Using MPS for 1205x1205 matrix with 24GB GPU memory
2025-08-23 15:47:54,066 - INFO - Converting 1205x1205 sparse matrix to dense for MPS...
2025-08-23 15:47:54,068 - INFO - 💾 Estimated GPU memory usage: 16.6 MB
2025-08-23 15:47:54,080 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 4.108
2025-08-23 15:47:54,087 - INFO - 🔥 MPS Iter 2 takes 0.015 seconds. Loss: 0.806
2025-08-23 15:47:54,090 - INFO - 🔥 MPS Iter 3 takes 0.021 seconds. Loss: 0.206
2025-08-23 15:47:54,094 - INFO - 🔥 MPS Iter 4 takes 0.025 seconds. Loss: 0.056
2025-08-23 15:47:54,098 - INFO - 🔥 MPS Iter 5 takes 0.029 seconds. Loss: 0.017
2025-08-23 15:47:54,102 - INFO - 🔥 MPS Iter 6 takes 0.033 seconds. Loss: 0.006
2025-08-23 15:47:54,102 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:54,103 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:54,104 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:54,124 - INFO -    RWR 耗时: 0.059 秒
2025-08-23 15:47:54,142 - INFO -    归一化耗时: 0.019 秒
2025-08-23 15:47:54,282 - INFO -    ✅ 完成，总耗时: 0.088 秒
2025-08-23 15:47:54,283 - INFO -   ✅ chr13: 完成，耗时 0.23 秒
2025-08-23 15:47:54,283 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-23 15:47:54,284 - INFO -    染色体 chr14 大小: 124,902,244 bp, bins: 1250
2025-08-23 15:47:54,285 - INFO -    数据形状: (2226, 3)
2025-08-23 15:47:54,285 - INFO -    bin 范围: 39-1245, 59-1247
2025-08-23 15:47:54,285 - INFO -    矩阵大小: (1250, 1250), 非零元素: 4,044, 稀疏度: 0.002588
2025-08-23 15:47:54,286 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:54,286 - INFO - 🔥 MPS Gaussian filter: 1250x1250 matrix, 内存需求: 23.9MB
2025-08-23 15:47:54,290 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:54,298 - INFO -    卷积耗时: 0.012 秒
2025-08-23 15:47:54,299 - INFO - 🚀 MPS 加速: 1250x1250 矩阵 (内存需求: 0.02GB, 稀疏度: 0.0167)
2025-08-23 15:47:54,299 - INFO - 🚀 Using MPS for 1250x1250 matrix with 24GB GPU memory
2025-08-23 15:47:54,299 - INFO - Converting 1250x1250 sparse matrix to dense for MPS...
2025-08-23 15:47:54,301 - INFO - 💾 Estimated GPU memory usage: 17.9 MB
2025-08-23 15:47:54,309 - INFO - 🔥 MPS Iter 1 takes 0.002 seconds. Loss: 4.214
2025-08-23 15:47:54,315 - INFO - 🔥 MPS Iter 2 takes 0.012 seconds. Loss: 0.818
2025-08-23 15:47:54,321 - INFO - 🔥 MPS Iter 3 takes 0.018 seconds. Loss: 0.214
2025-08-23 15:47:54,324 - INFO - 🔥 MPS Iter 4 takes 0.023 seconds. Loss: 0.057
2025-08-23 15:47:54,329 - INFO - 🔥 MPS Iter 5 takes 0.026 seconds. Loss: 0.018
2025-08-23 15:47:54,333 - INFO - 🔥 MPS Iter 6 takes 0.031 seconds. Loss: 0.006
2025-08-23 15:47:54,334 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:54,334 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:54,334 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:54,355 - INFO -    RWR 耗时: 0.057 秒
2025-08-23 15:47:54,376 - INFO -    归一化耗时: 0.020 秒
2025-08-23 15:47:54,515 - INFO -    ✅ 完成，总耗时: 0.090 秒
2025-08-23 15:47:54,516 - INFO -   ✅ chr14: 完成，耗时 0.23 秒
2025-08-23 15:47:54,516 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-23 15:47:54,517 - INFO -    染色体 chr15 大小: 104,043,685 bp, bins: 1041
2025-08-23 15:47:54,520 - INFO -    数据形状: (1935, 3)
2025-08-23 15:47:54,520 - INFO -    bin 范围: 31-1038, 32-1039
2025-08-23 15:47:54,521 - INFO -    矩阵大小: (1041, 1041), 非零元素: 3,510, 稀疏度: 0.003239
2025-08-23 15:47:54,521 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:54,521 - INFO - 🔥 MPS Gaussian filter: 1041x1041 matrix, 内存需求: 16.6MB
2025-08-23 15:47:54,525 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:54,531 - INFO -    卷积耗时: 0.010 秒
2025-08-23 15:47:54,532 - INFO - 🚀 MPS 加速: 1041x1041 矩阵 (内存需求: 0.01GB, 稀疏度: 0.0211)
2025-08-23 15:47:54,532 - INFO - 🚀 Using MPS for 1041x1041 matrix with 24GB GPU memory
2025-08-23 15:47:54,532 - INFO - Converting 1041x1041 sparse matrix to dense for MPS...
2025-08-23 15:47:54,534 - INFO - 💾 Estimated GPU memory usage: 12.4 MB
2025-08-23 15:47:54,539 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 3.755
2025-08-23 15:47:54,544 - INFO - 🔥 MPS Iter 2 takes 0.008 seconds. Loss: 0.738
2025-08-23 15:47:54,548 - INFO - 🔥 MPS Iter 3 takes 0.013 seconds. Loss: 0.181
2025-08-23 15:47:54,552 - INFO - 🔥 MPS Iter 4 takes 0.017 seconds. Loss: 0.047
2025-08-23 15:47:54,555 - INFO - 🔥 MPS Iter 5 takes 0.021 seconds. Loss: 0.014
2025-08-23 15:47:54,563 - INFO - 🔥 MPS Iter 6 takes 0.025 seconds. Loss: 0.004
2025-08-23 15:47:54,564 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:54,564 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:54,566 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:54,597 - INFO -    RWR 耗时: 0.066 秒
2025-08-23 15:47:54,614 - INFO -    归一化耗时: 0.018 秒
2025-08-23 15:47:54,717 - INFO -    ✅ 完成，总耗时: 0.093 秒
2025-08-23 15:47:54,717 - INFO -   ✅ chr15: 完成，耗时 0.20 秒
2025-08-23 15:47:54,717 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-23 15:47:54,718 - INFO -    染色体 chr16 大小: 98,207,768 bp, bins: 983
2025-08-23 15:47:54,720 - INFO -    数据形状: (1889, 3)
2025-08-23 15:47:54,720 - INFO -    bin 范围: 33-979, 34-980
2025-08-23 15:47:54,720 - INFO -    矩阵大小: (983, 983), 非零元素: 3,424, 稀疏度: 0.003543
2025-08-23 15:47:54,721 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:54,721 - INFO - 🔥 MPS Gaussian filter: 983x983 matrix, 内存需求: 14.8MB
2025-08-23 15:47:54,725 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:54,729 - INFO -    卷积耗时: 0.008 秒
2025-08-23 15:47:54,730 - INFO - 🚀 MPS 加速: 983x983 矩阵 (内存需求: 0.01GB, 稀疏度: 0.0227)
2025-08-23 15:47:54,730 - INFO - 🚀 Using MPS for 983x983 matrix with 24GB GPU memory
2025-08-23 15:47:54,730 - INFO - Converting 983x983 sparse matrix to dense for MPS...
2025-08-23 15:47:54,732 - INFO - 💾 Estimated GPU memory usage: 11.1 MB
2025-08-23 15:47:54,740 - INFO - 🔥 MPS Iter 1 takes 0.002 seconds. Loss: 3.676
2025-08-23 15:47:54,747 - INFO - 🔥 MPS Iter 2 takes 0.011 seconds. Loss: 0.721
2025-08-23 15:47:54,749 - INFO - 🔥 MPS Iter 3 takes 0.017 seconds. Loss: 0.180
2025-08-23 15:47:54,752 - INFO - 🔥 MPS Iter 4 takes 0.019 seconds. Loss: 0.048
2025-08-23 15:47:54,754 - INFO - 🔥 MPS Iter 5 takes 0.023 seconds. Loss: 0.014
2025-08-23 15:47:54,756 - INFO - 🔥 MPS Iter 6 takes 0.025 seconds. Loss: 0.005
2025-08-23 15:47:54,757 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:54,757 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:54,758 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:54,771 - INFO -    RWR 耗时: 0.041 秒
2025-08-23 15:47:54,783 - INFO -    归一化耗时: 0.012 秒
2025-08-23 15:47:54,875 - INFO -    ✅ 完成，总耗时: 0.062 秒
2025-08-23 15:47:54,875 - INFO -   ✅ chr16: 完成，耗时 0.16 秒
2025-08-23 15:47:54,875 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-23 15:47:54,876 - INFO -    染色体 chr17 大小: 94,987,271 bp, bins: 950
2025-08-23 15:47:54,878 - INFO -    数据形状: (1734, 3)
2025-08-23 15:47:54,878 - INFO -    bin 范围: 30-946, 31-948
2025-08-23 15:47:54,878 - INFO -    矩阵大小: (950, 950), 非零元素: 3,170, 稀疏度: 0.003512
2025-08-23 15:47:54,878 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:54,878 - INFO - 🔥 MPS Gaussian filter: 950x950 matrix, 内存需求: 13.8MB
2025-08-23 15:47:54,882 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:54,885 - INFO -    卷积耗时: 0.007 秒
2025-08-23 15:47:54,886 - INFO - 🚀 MPS 加速: 950x950 矩阵 (内存需求: 0.01GB, 稀疏度: 0.0230)
2025-08-23 15:47:54,886 - INFO - 🚀 Using MPS for 950x950 matrix with 24GB GPU memory
2025-08-23 15:47:54,886 - INFO - Converting 950x950 sparse matrix to dense for MPS...
2025-08-23 15:47:54,888 - INFO - 💾 Estimated GPU memory usage: 10.3 MB
2025-08-23 15:47:54,892 - INFO - 🔥 MPS Iter 1 takes 0.002 seconds. Loss: 3.647
2025-08-23 15:47:54,899 - INFO - 🔥 MPS Iter 2 takes 0.007 seconds. Loss: 0.720
2025-08-23 15:47:54,902 - INFO - 🔥 MPS Iter 3 takes 0.013 seconds. Loss: 0.183
2025-08-23 15:47:54,905 - INFO - 🔥 MPS Iter 4 takes 0.016 seconds. Loss: 0.049
2025-08-23 15:47:54,908 - INFO - 🔥 MPS Iter 5 takes 0.019 seconds. Loss: 0.015
2025-08-23 15:47:54,910 - INFO - 🔥 MPS Iter 6 takes 0.022 seconds. Loss: 0.005
2025-08-23 15:47:54,911 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:54,911 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:54,911 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:54,924 - INFO -    RWR 耗时: 0.038 秒
2025-08-23 15:47:54,935 - INFO -    归一化耗时: 0.011 秒
2025-08-23 15:47:55,020 - INFO -    ✅ 完成，总耗时: 0.057 秒
2025-08-23 15:47:55,021 - INFO -   ✅ chr17: 完成，耗时 0.15 秒
2025-08-23 15:47:55,021 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-23 15:47:55,022 - INFO -    染色体 chr18 大小: 90,702,639 bp, bins: 908
2025-08-23 15:47:55,023 - INFO -    数据形状: (1800, 3)
2025-08-23 15:47:55,023 - INFO -    bin 范围: 30-903, 30-905
2025-08-23 15:47:55,023 - INFO -    矩阵大小: (908, 908), 非零元素: 3,267, 稀疏度: 0.003963
2025-08-23 15:47:55,024 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:55,024 - INFO - 🔥 MPS Gaussian filter: 908x908 matrix, 内存需求: 12.6MB
2025-08-23 15:47:55,028 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:55,032 - INFO -    卷积耗时: 0.008 秒
2025-08-23 15:47:55,033 - INFO - 🚀 MPS 加速: 908x908 矩阵 (内存需求: 0.01GB, 稀疏度: 0.0261)
2025-08-23 15:47:55,033 - INFO - 🚀 Using MPS for 908x908 matrix with 24GB GPU memory
2025-08-23 15:47:55,033 - INFO - Converting 908x908 sparse matrix to dense for MPS...
2025-08-23 15:47:55,035 - INFO - 💾 Estimated GPU memory usage: 9.4 MB
2025-08-23 15:47:55,038 - INFO - 🔥 MPS Iter 1 takes 0.003 seconds. Loss: 3.317
2025-08-23 15:47:55,043 - INFO - 🔥 MPS Iter 2 takes 0.006 seconds. Loss: 0.619
2025-08-23 15:47:55,046 - INFO - 🔥 MPS Iter 3 takes 0.011 seconds. Loss: 0.144
2025-08-23 15:47:55,051 - INFO - 🔥 MPS Iter 4 takes 0.014 seconds. Loss: 0.037
2025-08-23 15:47:55,054 - INFO - 🔥 MPS Iter 5 takes 0.018 seconds. Loss: 0.011
2025-08-23 15:47:55,057 - INFO - 🔥 MPS Iter 6 takes 0.022 seconds. Loss: 0.003
2025-08-23 15:47:55,057 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:55,057 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:55,058 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:55,070 - INFO -    RWR 耗时: 0.037 秒
2025-08-23 15:47:55,078 - INFO -    归一化耗时: 0.008 秒
2025-08-23 15:47:55,161 - INFO -    ✅ 完成，总耗时: 0.054 秒
2025-08-23 15:47:55,161 - INFO -   ✅ chr18: 完成，耗时 0.14 秒
2025-08-23 15:47:55,161 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-23 15:47:55,162 - INFO -    染色体 chr19 大小: 61,431,566 bp, bins: 615
2025-08-23 15:47:55,163 - INFO -    数据形状: (1081, 3)
2025-08-23 15:47:55,163 - INFO -    bin 范围: 30-612, 34-613
2025-08-23 15:47:55,164 - INFO -    矩阵大小: (615, 615), 非零元素: 1,949, 稀疏度: 0.005153
2025-08-23 15:47:55,164 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:55,164 - INFO - 🔥 MPS Gaussian filter: 615x615 matrix, 内存需求: 5.8MB
2025-08-23 15:47:55,168 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:55,170 - INFO -    卷积耗时: 0.006 秒
2025-08-23 15:47:55,171 - INFO - 🚀 MPS 加速: 615x615 矩阵 (内存需求: 0.00GB, 稀疏度: 0.0320)
2025-08-23 15:47:55,171 - INFO - 🚀 Using MPS for 615x615 matrix with 24GB GPU memory
2025-08-23 15:47:55,171 - INFO - Converting 615x615 sparse matrix to dense for MPS...
2025-08-23 15:47:55,172 - INFO - 💾 Estimated GPU memory usage: 4.3 MB
2025-08-23 15:47:55,175 - INFO - 🔥 MPS Iter 1 takes 0.002 seconds. Loss: 3.132
2025-08-23 15:47:55,177 - INFO - 🔥 MPS Iter 2 takes 0.005 seconds. Loss: 0.691
2025-08-23 15:47:55,179 - INFO - 🔥 MPS Iter 3 takes 0.007 seconds. Loss: 0.195
2025-08-23 15:47:55,181 - INFO - 🔥 MPS Iter 4 takes 0.009 seconds. Loss: 0.059
2025-08-23 15:47:55,183 - INFO - 🔥 MPS Iter 5 takes 0.011 seconds. Loss: 0.020
2025-08-23 15:47:55,186 - INFO - 🔥 MPS Iter 6 takes 0.014 seconds. Loss: 0.007
2025-08-23 15:47:55,188 - INFO - ✅ Converged after 6 iterations
2025-08-23 15:47:55,188 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:55,189 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:55,194 - INFO -    RWR 耗时: 0.024 秒
2025-08-23 15:47:55,200 - INFO -    归一化耗时: 0.006 秒
2025-08-23 15:47:55,236 - INFO -    ✅ 完成，总耗时: 0.035 秒
2025-08-23 15:47:55,236 - INFO -   ✅ chr19: 完成，耗时 0.08 秒
2025-08-23 15:47:55,236 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-23 15:47:55,238 - INFO -    染色体 chrX 大小: 171,031,299 bp, bins: 1711
2025-08-23 15:47:55,239 - INFO -    数据形状: (2615, 3)
2025-08-23 15:47:55,239 - INFO -    bin 范围: 40-1699, 54-1699
2025-08-23 15:47:55,240 - INFO -    矩阵大小: (1711, 1711), 非零元素: 4,821, 稀疏度: 0.001647
2025-08-23 15:47:55,240 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-23 15:47:55,240 - INFO - 🔥 MPS Gaussian filter: 1711x1711 matrix, 内存需求: 44.7MB
2025-08-23 15:47:55,290 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-23 15:47:55,301 - INFO -    卷积耗时: 0.061 秒
2025-08-23 15:47:55,302 - INFO - 🚀 MPS 加速: 1711x1711 矩阵 (内存需求: 0.03GB, 稀疏度: 0.0119)
2025-08-23 15:47:55,302 - INFO - 🚀 Using MPS for 1711x1711 matrix with 24GB GPU memory
2025-08-23 15:47:55,302 - INFO - Converting 1711x1711 sparse matrix to dense for MPS...
2025-08-23 15:47:55,350 - INFO - 💾 Estimated GPU memory usage: 33.5 MB
2025-08-23 15:47:55,365 - INFO - 🔥 MPS Iter 1 takes 0.048 seconds. Loss: 5.087
2025-08-23 15:47:55,374 - INFO - 🔥 MPS Iter 2 takes 0.064 seconds. Loss: 1.098
2025-08-23 15:47:55,381 - INFO - 🔥 MPS Iter 3 takes 0.072 seconds. Loss: 0.333
2025-08-23 15:47:55,389 - INFO - 🔥 MPS Iter 4 takes 0.080 seconds. Loss: 0.117
2025-08-23 15:47:55,397 - INFO - 🔥 MPS Iter 5 takes 0.087 seconds. Loss: 0.049
2025-08-23 15:47:55,404 - INFO - 🔥 MPS Iter 6 takes 0.095 seconds. Loss: 0.021
2025-08-23 15:47:55,412 - INFO - 🔥 MPS Iter 7 takes 0.103 seconds. Loss: 0.010
2025-08-23 15:47:55,413 - INFO - ✅ Converged after 7 iterations
2025-08-23 15:47:55,413 - INFO - Converting MPS result back to sparse matrix...
2025-08-23 15:47:55,414 - INFO - 🧹 GPU memory cleared
2025-08-23 15:47:55,449 - INFO -    RWR 耗时: 0.147 秒
2025-08-23 15:47:55,478 - INFO -    归一化耗时: 0.029 秒
2025-08-23 15:47:55,706 - INFO -    ✅ 完成，总耗时: 0.238 秒
2025-08-23 15:47:55,707 - INFO -   ✅ chrX: 完成，耗时 0.47 秒
2025-08-23 15:47:55,707 - INFO - 🎯 细胞 GasfE703154 完成: 20 成功, 0 失败, 总耗时 0.1 分钟
2025-08-23 15:47:55,707 - INFO - 📦 批次完成: 40 成功, 0 失败, 耗时 0.2 分钟
2025-08-23 15:47:55,707 - INFO - 🎊 Stage E70 完成: 40 个矩阵成功, 0 个失败
2025-08-23 15:47:55,707 - INFO -    总耗时: 0.00 小时
2025-08-23 15:47:55,707 - INFO - 
============================================================
2025-08-23 15:47:55,707 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:47:55,707 - INFO - 📊 总计: 40 个矩阵成功, 0 个失败
2025-08-23 15:47:55,707 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 15:47:55,707 - INFO - 💡 M4 MPS 加速比: 18.8x
2025-08-23 15:47:55,707 - INFO - 💡 预计节省时间: 0.0 小时 (相比 M4 CPU)
2025-08-23 15:47:55,707 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:55:39,471 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:55:39,481 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:55:39,481 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:55:39,481 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:55:39,481 - INFO - 🔧 使用 MPS: True
2025-08-23 15:55:39,481 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:55:39,481 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:55:39,624 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:55:40,395 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:55:40,395 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:55:40,395 - INFO - 
==================================================
2025-08-23 15:55:40,395 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:55:40,395 - INFO - ==================================================
2025-08-23 15:55:40,397 - INFO - 🗂️  Stage E70: 发现 2 个细胞
2025-08-23 15:55:40,397 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:55:40,397 - INFO - 📦 M4 批次处理 1: 细胞 1-2/2
2025-08-23 15:55:40,397 - INFO - 📊 处理: GasfE703153 (1/2)
2025-08-23 15:55:40,397 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:55:40,397 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 15:55:40,397 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 15:55:40,398 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 15:55:40,398 - INFO - 📊 处理: GasfE703154 (2/2)
2025-08-23 15:55:40,398 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:55:40,398 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 15:55:40,398 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 15:55:40,398 - INFO - 🎯 细胞 GasfE703154 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 15:55:40,398 - INFO - 📦 批次完成: 40 成功, 0 失败, 耗时 0.0 分钟
2025-08-23 15:55:40,398 - INFO - 🎊 Stage E70 完成: 40 个矩阵成功, 0 个失败
2025-08-23 15:55:40,398 - INFO -    总耗时: 0.00 小时
2025-08-23 15:55:40,398 - INFO - 
============================================================
2025-08-23 15:55:40,398 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:55:40,398 - INFO - 📊 总计: 40 个矩阵成功, 0 个失败
2025-08-23 15:55:40,398 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 15:55:40,398 - INFO - 💡 M4 MPS 加速比: 18.8x
2025-08-23 15:55:40,398 - INFO - 💡 预计节省时间: 0.0 小时 (相比 M4 CPU)
2025-08-23 15:55:40,398 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 15:59:30,910 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 15:59:30,912 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 15:59:30,912 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 15:59:30,912 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 15:59:30,912 - INFO - 🔧 使用 MPS: True
2025-08-23 15:59:30,912 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 15:59:30,912 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 15:59:31,080 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 15:59:31,907 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 15:59:31,907 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 15:59:31,907 - INFO - 
==================================================
2025-08-23 15:59:31,907 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 15:59:31,907 - INFO - ==================================================
2025-08-23 15:59:31,914 - INFO - 🗂️  Stage E70: 发现 2 个细胞
2025-08-23 15:59:31,914 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 15:59:31,914 - INFO - 📦 M4 批次处理 1: 细胞 1-2/2
2025-08-23 15:59:31,914 - INFO - 📊 处理: GasfE703153 (1/2)
2025-08-23 15:59:31,914 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 15:59:31,914 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 15:59:31,914 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 15:59:31,915 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 15:59:31,915 - INFO - 📊 处理: GasfE703154 (2/2)
2025-08-23 15:59:31,915 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 15:59:31,915 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 15:59:31,915 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 15:59:31,915 - INFO - 🎯 细胞 GasfE703154 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 15:59:31,915 - INFO - 📦 批次完成: 40 成功, 0 失败, 耗时 0.0 分钟
2025-08-23 15:59:31,915 - INFO - 🎊 Stage E70 完成: 40 个矩阵成功, 0 个失败
2025-08-23 15:59:31,915 - INFO -    总耗时: 0.00 小时
2025-08-23 15:59:31,915 - INFO - 
============================================================
2025-08-23 15:59:31,915 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 15:59:31,915 - INFO - 📊 总计: 40 个矩阵成功, 0 个失败
2025-08-23 15:59:31,915 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 15:59:31,915 - INFO - 💡 M4 MPS 加速比: 18.8x
2025-08-23 15:59:31,915 - INFO - 💡 预计节省时间: 0.0 小时 (相比 M4 CPU)
2025-08-23 15:59:31,915 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
2025-08-23 16:02:25,481 - INFO - 🚀 开始 M4 MacBook 24GB 优化的 MPS 加速单细胞 Hi-C 插补
2025-08-23 16:02:25,481 - INFO - 💻 硬件平台: M4 MacBook 24GB 统一内存
2025-08-23 16:02:25,481 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/output/pairs2matrix_output
2025-08-23 16:02:25,481 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/output/imputed_matrices_by_stage
2025-08-23 16:02:25,481 - INFO - 🔧 使用 MPS: True
2025-08-23 16:02:25,482 - INFO - 🎯 处理 stages: ['E70']
2025-08-23 16:02:25,482 - INFO - 📦 M4 优化批处理大小: 10
2025-08-23 16:02:25,743 - INFO - NumExpr defaulting to 10 threads.
2025-08-23 16:02:27,154 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-23 16:02:27,154 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-23 16:02:27,154 - INFO - 
==================================================
2025-08-23 16:02:27,154 - INFO - 🗂️  开始处理 Stage: E70
2025-08-23 16:02:27,154 - INFO - ==================================================
2025-08-23 16:02:27,165 - INFO - 🗂️  Stage E70: 发现 2 个细胞
2025-08-23 16:02:27,165 - INFO - 📦 使用 M4 标准批次大小: 8
2025-08-23 16:02:27,165 - INFO - 📦 M4 批次处理 1: 细胞 1-2/2
2025-08-23 16:02:27,165 - INFO - 📊 处理: GasfE703153 (1/2)
2025-08-23 16:02:27,165 - INFO - 🧬 开始处理细胞: GasfE703153
2025-08-23 16:02:27,166 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 16:02:27,166 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 16:02:27,166 - INFO - 🎯 细胞 GasfE703153 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 16:02:27,166 - INFO - 📊 处理: GasfE703154 (2/2)
2025-08-23 16:02:27,166 - INFO - 🧬 开始处理细胞: GasfE703154
2025-08-23 16:02:27,166 - INFO -   ✅ chr1: 已存在，跳过
2025-08-23 16:02:27,167 - INFO -   ✅ chr2: 已存在，跳过
2025-08-23 16:02:27,167 - INFO -   ✅ chr3: 已存在，跳过
2025-08-23 16:02:27,167 - INFO -   ✅ chr4: 已存在，跳过
2025-08-23 16:02:27,167 - INFO -   ✅ chr5: 已存在，跳过
2025-08-23 16:02:27,167 - INFO -   ✅ chr6: 已存在，跳过
2025-08-23 16:02:27,167 - INFO -   ✅ chr7: 已存在，跳过
2025-08-23 16:02:27,167 - INFO -   ✅ chr8: 已存在，跳过
2025-08-23 16:02:27,167 - INFO -   ✅ chr9: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr10: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr11: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr12: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr13: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr14: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr15: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr16: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr17: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr18: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chr19: 已存在，跳过
2025-08-23 16:02:27,168 - INFO -   ✅ chrX: 已存在，跳过
2025-08-23 16:02:27,168 - INFO - 🎯 细胞 GasfE703154 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-23 16:02:27,169 - INFO - 📦 批次完成: 40 成功, 0 失败, 耗时 0.0 分钟
2025-08-23 16:02:27,169 - INFO - 🎊 Stage E70 完成: 40 个矩阵成功, 0 个失败
2025-08-23 16:02:27,169 - INFO -    总耗时: 0.00 小时
2025-08-23 16:02:27,169 - INFO - 
============================================================
2025-08-23 16:02:27,169 - INFO - 🎉 所有 Stage 处理完成!
2025-08-23 16:02:27,169 - INFO - 📊 总计: 40 个矩阵成功, 0 个失败
2025-08-23 16:02:27,169 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-23 16:02:27,169 - INFO - 💡 M4 MPS 加速比: 18.8x
2025-08-23 16:02:27,169 - INFO - 💡 预计节省时间: 0.0 小时 (相比 M4 CPU)
2025-08-23 16:02:27,169 - INFO - 📄 详细日志已保存到: mps_imputation_v2.log
