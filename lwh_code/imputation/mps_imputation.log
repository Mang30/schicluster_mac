2025-08-22 17:49:03,982 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 17:49:03,982 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 17:49:03,982 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 17:49:03,982 - INFO - 🔧 使用 MPS: True
2025-08-22 17:49:03,983 - INFO - 🎯 处理 stages: ['E70']
2025-08-22 17:49:04,305 - INFO - NumExpr defaulting to 10 threads.
2025-08-22 17:49:07,019 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-22 17:49:07,019 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-22 17:49:07,019 - INFO - 
==================================================
2025-08-22 17:49:07,019 - INFO - 🗂️  开始处理 Stage: E70
2025-08-22 17:49:07,019 - INFO - ==================================================
2025-08-22 17:49:07,091 - INFO - 🗂️  Stage E70: 发现 2 个细胞
2025-08-22 17:49:07,091 - INFO - 📊 Stage E70: 处理细胞 1/2
2025-08-22 17:49:07,091 - INFO - 🧬 开始处理细胞: GasdE701001
2025-08-22 17:49:07,091 - INFO - Starting chromosome chr1 imputation with MPS GPU acceleration
2025-08-22 17:49:07,098 - ERROR -   ❌ chr1: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,099 - INFO - Starting chromosome chr2 imputation with MPS GPU acceleration
2025-08-22 17:49:07,104 - ERROR -   ❌ chr2: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,105 - INFO - Starting chromosome chr3 imputation with MPS GPU acceleration
2025-08-22 17:49:07,109 - ERROR -   ❌ chr3: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,109 - INFO - Starting chromosome chr4 imputation with MPS GPU acceleration
2025-08-22 17:49:07,113 - ERROR -   ❌ chr4: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,114 - INFO - Starting chromosome chr5 imputation with MPS GPU acceleration
2025-08-22 17:49:07,119 - ERROR -   ❌ chr5: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,119 - INFO - Starting chromosome chr6 imputation with MPS GPU acceleration
2025-08-22 17:49:07,124 - ERROR -   ❌ chr6: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,125 - INFO - Starting chromosome chr7 imputation with MPS GPU acceleration
2025-08-22 17:49:07,150 - ERROR -   ❌ chr7: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,151 - INFO - Starting chromosome chr8 imputation with MPS GPU acceleration
2025-08-22 17:49:07,155 - ERROR -   ❌ chr8: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,156 - INFO - Starting chromosome chr9 imputation with MPS GPU acceleration
2025-08-22 17:49:07,160 - ERROR -   ❌ chr9: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,161 - INFO - Starting chromosome chr10 imputation with MPS GPU acceleration
2025-08-22 17:49:07,166 - ERROR -   ❌ chr10: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,166 - INFO - Starting chromosome chr11 imputation with MPS GPU acceleration
2025-08-22 17:49:07,170 - ERROR -   ❌ chr11: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,171 - INFO - Starting chromosome chr12 imputation with MPS GPU acceleration
2025-08-22 17:49:07,175 - ERROR -   ❌ chr12: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,175 - INFO - Starting chromosome chr13 imputation with MPS GPU acceleration
2025-08-22 17:49:07,182 - ERROR -   ❌ chr13: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,182 - INFO - Starting chromosome chr14 imputation with MPS GPU acceleration
2025-08-22 17:49:07,187 - ERROR -   ❌ chr14: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,187 - INFO - Starting chromosome chr15 imputation with MPS GPU acceleration
2025-08-22 17:49:07,191 - ERROR -   ❌ chr15: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,192 - INFO - Starting chromosome chr16 imputation with MPS GPU acceleration
2025-08-22 17:49:07,197 - ERROR -   ❌ chr16: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,197 - INFO - Starting chromosome chr17 imputation with MPS GPU acceleration
2025-08-22 17:49:07,201 - ERROR -   ❌ chr17: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,202 - INFO - Starting chromosome chr18 imputation with MPS GPU acceleration
2025-08-22 17:49:07,205 - ERROR -   ❌ chr18: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,226 - INFO - Starting chromosome chr19 imputation with MPS GPU acceleration
2025-08-22 17:49:07,229 - ERROR -   ❌ chr19: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,229 - INFO - Starting chromosome chrX imputation with MPS GPU acceleration
2025-08-22 17:49:07,233 - ERROR -   ❌ chrX: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,233 - INFO - 🎯 细胞 GasdE701001 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-22 17:49:07,233 - INFO - ⏱️  预计剩余时间: 0.0 分钟
2025-08-22 17:49:07,233 - INFO - 📊 Stage E70: 处理细胞 2/2
2025-08-22 17:49:07,233 - INFO - 🧬 开始处理细胞: GasdE701003
2025-08-22 17:49:07,233 - INFO - Starting chromosome chr1 imputation with MPS GPU acceleration
2025-08-22 17:49:07,239 - ERROR -   ❌ chr1: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,239 - INFO - Starting chromosome chr2 imputation with MPS GPU acceleration
2025-08-22 17:49:07,244 - ERROR -   ❌ chr2: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,245 - INFO - Starting chromosome chr3 imputation with MPS GPU acceleration
2025-08-22 17:49:07,250 - ERROR -   ❌ chr3: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,250 - INFO - Starting chromosome chr4 imputation with MPS GPU acceleration
2025-08-22 17:49:07,254 - ERROR -   ❌ chr4: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,254 - INFO - Starting chromosome chr5 imputation with MPS GPU acceleration
2025-08-22 17:49:07,258 - ERROR -   ❌ chr5: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,258 - INFO - Starting chromosome chr6 imputation with MPS GPU acceleration
2025-08-22 17:49:07,262 - ERROR -   ❌ chr6: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,263 - INFO - Starting chromosome chr7 imputation with MPS GPU acceleration
2025-08-22 17:49:07,266 - ERROR -   ❌ chr7: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,267 - INFO - Starting chromosome chr8 imputation with MPS GPU acceleration
2025-08-22 17:49:07,271 - ERROR -   ❌ chr8: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,271 - INFO - Starting chromosome chr9 imputation with MPS GPU acceleration
2025-08-22 17:49:07,277 - ERROR -   ❌ chr9: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,300 - INFO - Starting chromosome chr10 imputation with MPS GPU acceleration
2025-08-22 17:49:07,304 - ERROR -   ❌ chr10: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,305 - INFO - Starting chromosome chr11 imputation with MPS GPU acceleration
2025-08-22 17:49:07,310 - ERROR -   ❌ chr11: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,311 - INFO - Starting chromosome chr12 imputation with MPS GPU acceleration
2025-08-22 17:49:07,316 - ERROR -   ❌ chr12: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,317 - INFO - Starting chromosome chr13 imputation with MPS GPU acceleration
2025-08-22 17:49:07,323 - ERROR -   ❌ chr13: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,323 - INFO - Starting chromosome chr14 imputation with MPS GPU acceleration
2025-08-22 17:49:07,328 - ERROR -   ❌ chr14: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,329 - INFO - Starting chromosome chr15 imputation with MPS GPU acceleration
2025-08-22 17:49:07,333 - ERROR -   ❌ chr15: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,333 - INFO - Starting chromosome chr16 imputation with MPS GPU acceleration
2025-08-22 17:49:07,337 - ERROR -   ❌ chr16: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,337 - INFO - Starting chromosome chr17 imputation with MPS GPU acceleration
2025-08-22 17:49:07,341 - ERROR -   ❌ chr17: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,341 - INFO - Starting chromosome chr18 imputation with MPS GPU acceleration
2025-08-22 17:49:07,346 - ERROR -   ❌ chr18: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,346 - INFO - Starting chromosome chr19 imputation with MPS GPU acceleration
2025-08-22 17:49:07,350 - ERROR -   ❌ chr19: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,350 - INFO - Starting chromosome chrX imputation with MPS GPU acceleration
2025-08-22 17:49:07,354 - ERROR -   ❌ chrX: 失败 - '[5, 6] not in index'
2025-08-22 17:49:07,354 - INFO - 🎯 细胞 GasdE701003 完成: 0 成功, 20 失败, 总耗时 0.0 分钟
2025-08-22 17:49:07,354 - INFO - ⏱️  预计剩余时间: 0.0 分钟
2025-08-22 17:49:07,354 - INFO - 🎊 Stage E70 完成: 0 个矩阵成功, 40 个失败
2025-08-22 17:49:07,354 - INFO -    总耗时: 0.00 小时
2025-08-22 17:49:07,354 - INFO - 
============================================================
2025-08-22 17:49:07,354 - INFO - 🎉 所有 Stage 处理完成!
2025-08-22 17:49:07,354 - INFO - 📊 总计: 0 个矩阵成功, 40 个失败
2025-08-22 17:49:07,354 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-22 17:49:07,354 - INFO - 📄 详细日志已保存到: mps_imputation.log
2025-08-22 17:56:59,658 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 17:56:59,659 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 17:56:59,659 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 17:56:59,659 - INFO - 🔧 使用 MPS: True
2025-08-22 17:56:59,659 - INFO - 🎯 处理 stages: ['E70']
2025-08-22 17:56:59,950 - INFO - NumExpr defaulting to 10 threads.
2025-08-22 17:57:01,853 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-22 17:57:01,853 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-22 17:57:01,854 - INFO - 
==================================================
2025-08-22 17:57:01,854 - INFO - 🗂️  开始处理 Stage: E70
2025-08-22 17:57:01,854 - INFO - ==================================================
2025-08-22 17:57:01,917 - INFO - 🗂️  Stage E70: 发现 1 个细胞
2025-08-22 17:57:01,917 - INFO - 📊 Stage E70: 处理细胞 1/1
2025-08-22 17:57:01,924 - INFO - 🧬 开始处理细胞: GasdE701001
2025-08-22 17:57:01,925 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 17:57:01,935 - INFO -    矩阵大小: (9774, 9774), 非零元素: 34770, 稀疏度: 0.000364
2025-08-22 17:57:01,937 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 17:57:03,289 - INFO -    卷积耗时: 1.351 秒
2025-08-22 17:57:03,298 - INFO - Using MPS for 9774x9774 matrix (sparsity: 0.0028)
2025-08-22 17:57:03,298 - WARNING - Matrix size 9774x9774 too large for MPS dense operations. Falling back to CPU.
2025-08-22 17:57:39,772 - INFO -    RWR 耗时: 36.481 秒
2025-08-22 17:57:42,377 - INFO -    归一化耗时: 2.600 秒
2025-08-22 17:58:39,340 - INFO -    ✅ 完成，总耗时: 40.432 秒
2025-08-22 17:58:39,375 - INFO -   ✅ chr1: 完成，耗时 97.45 秒
2025-08-22 17:58:39,379 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 17:58:39,405 - INFO -    矩阵大小: (9106, 9106), 非零元素: 29840, 稀疏度: 0.000360
2025-08-22 17:58:39,408 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 17:58:40,589 - INFO -    卷积耗时: 1.181 秒
2025-08-22 17:58:40,598 - INFO - Using MPS for 9106x9106 matrix (sparsity: 0.0027)
2025-08-22 17:58:40,599 - WARNING - Matrix size 9106x9106 too large for MPS dense operations. Falling back to CPU.
2025-08-22 17:59:22,149 - INFO -    RWR 耗时: 41.558 秒
2025-08-22 17:59:24,419 - INFO -    归一化耗时: 2.265 秒
2025-08-22 18:10:24,109 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 18:10:24,110 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 18:10:24,110 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 18:10:24,110 - INFO - 🔧 使用 MPS: True
2025-08-22 18:10:24,110 - INFO - 🎯 处理 stages: ['E70']
2025-08-22 18:10:24,316 - INFO - NumExpr defaulting to 10 threads.
2025-08-22 18:10:25,782 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-22 18:10:25,782 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-22 18:10:25,782 - INFO - 
==================================================
2025-08-22 18:10:25,782 - INFO - 🗂️  开始处理 Stage: E70
2025-08-22 18:10:25,782 - INFO - ==================================================
2025-08-22 18:10:25,832 - INFO - 🗂️  Stage E70: 发现 1 个细胞
2025-08-22 18:10:25,832 - INFO - 📊 Stage E70: 处理细胞 1/1
2025-08-22 18:10:25,834 - INFO - 🧬 开始处理细胞: GasdE701001
2025-08-22 18:10:25,834 - INFO -   ✅ chr1: 已存在，跳过
2025-08-22 18:10:25,835 - INFO -   ✅ chr2: 已存在，跳过
2025-08-22 18:10:25,835 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 18:10:25,841 - INFO -    矩阵大小: (8002, 8002), 非零元素: 26598, 稀疏度: 0.000415
2025-08-22 18:10:25,842 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:10:25,842 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 18:10:26,075 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:10:26,399 - INFO -    卷积耗时: 0.557 秒
2025-08-22 18:10:26,405 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0032)
2025-08-22 18:10:26,405 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 18:10:26,405 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 18:10:26,520 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 18:10:27,431 - INFO - 🔥 MPS Iter 1 takes 0.369 seconds. Loss: 10.316
2025-08-22 18:10:29,938 - INFO - 🔥 MPS Iter 2 takes 1.035 seconds. Loss: 2.011
2025-08-22 18:10:31,540 - INFO - 🔥 MPS Iter 3 takes 3.540 seconds. Loss: 0.493
2025-08-22 18:10:33,361 - INFO - 🔥 MPS Iter 4 takes 5.137 seconds. Loss: 0.128
2025-08-22 18:10:35,152 - INFO - 🔥 MPS Iter 5 takes 6.987 seconds. Loss: 0.037
2025-08-22 18:10:36,875 - INFO - 🔥 MPS Iter 6 takes 8.753 seconds. Loss: 0.012
2025-08-22 18:10:38,736 - INFO - 🔥 MPS Iter 7 takes 10.480 seconds. Loss: 0.004
2025-08-22 18:10:38,738 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:10:38,738 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:10:38,833 - INFO - 🧹 GPU memory cleared
2025-08-22 18:10:41,158 - INFO -    RWR 耗时: 14.758 秒
2025-08-22 18:10:43,370 - INFO -    归一化耗时: 2.211 秒
2025-08-22 18:10:55,074 - INFO -    ✅ 完成，总耗时: 17.526 秒
2025-08-22 18:10:55,085 - INFO -   ✅ chr3: 完成，耗时 29.25 秒
2025-08-22 18:10:55,086 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 18:10:55,094 - INFO -    矩阵大小: (7826, 7826), 非零元素: 23909, 稀疏度: 0.000390
2025-08-22 18:10:55,094 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:10:55,094 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 18:10:55,490 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:10:55,779 - INFO -    卷积耗时: 0.684 秒
2025-08-22 18:10:55,783 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0030)
2025-08-22 18:10:55,783 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 18:10:55,784 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 18:10:55,926 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 18:10:56,570 - INFO - 🔥 MPS Iter 1 takes 0.254 seconds. Loss: 10.707
2025-08-22 18:10:58,886 - INFO - 🔥 MPS Iter 2 takes 0.788 seconds. Loss: 2.145
2025-08-22 18:11:00,382 - INFO - 🔥 MPS Iter 3 takes 3.110 seconds. Loss: 0.547
2025-08-22 18:11:01,713 - INFO - 🔥 MPS Iter 4 takes 4.600 seconds. Loss: 0.146
2025-08-22 18:11:03,230 - INFO - 🔥 MPS Iter 5 takes 5.938 seconds. Loss: 0.045
2025-08-22 18:11:04,778 - INFO - 🔥 MPS Iter 6 takes 7.450 seconds. Loss: 0.014
2025-08-22 18:11:06,213 - INFO - 🔥 MPS Iter 7 takes 9.002 seconds. Loss: 0.005
2025-08-22 18:11:06,216 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:11:06,216 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:11:06,242 - INFO - 🧹 GPU memory cleared
2025-08-22 18:11:08,782 - INFO -    RWR 耗时: 13.002 秒
2025-08-22 18:11:10,074 - INFO -    归一化耗时: 1.292 秒
2025-08-22 18:11:19,701 - INFO -    ✅ 完成，总耗时: 14.978 秒
2025-08-22 18:11:19,710 - INFO -   ✅ chr4: 完成，耗时 24.62 秒
2025-08-22 18:11:19,711 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 18:11:19,718 - INFO -    矩阵大小: (7592, 7592), 非零元素: 22699, 稀疏度: 0.000394
2025-08-22 18:11:19,719 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:11:19,719 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 18:11:19,975 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:11:20,385 - INFO -    卷积耗时: 0.666 秒
2025-08-22 18:11:20,390 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0030)
2025-08-22 18:11:20,390 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 18:11:20,390 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 18:11:20,487 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 18:11:21,070 - INFO - 🔥 MPS Iter 1 takes 0.212 seconds. Loss: 10.721
2025-08-22 18:11:23,085 - INFO - 🔥 MPS Iter 2 takes 0.682 seconds. Loss: 2.181
2025-08-22 18:11:24,606 - INFO - 🔥 MPS Iter 3 takes 2.699 seconds. Loss: 0.560
2025-08-22 18:11:25,906 - INFO - 🔥 MPS Iter 4 takes 4.223 seconds. Loss: 0.149
2025-08-22 18:11:27,280 - INFO - 🔥 MPS Iter 5 takes 5.519 seconds. Loss: 0.044
2025-08-22 18:11:29,035 - INFO - 🔥 MPS Iter 6 takes 6.892 seconds. Loss: 0.014
2025-08-22 18:11:30,659 - INFO - 🔥 MPS Iter 7 takes 8.648 seconds. Loss: 0.005
2025-08-22 18:11:30,667 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:11:30,668 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:11:30,773 - INFO - 🧹 GPU memory cleared
2025-08-22 18:11:33,633 - INFO -    RWR 耗时: 13.247 秒
2025-08-22 18:11:35,480 - INFO -    归一化耗时: 1.847 秒
2025-08-22 18:11:45,985 - INFO -    ✅ 完成，总耗时: 15.760 秒
2025-08-22 18:11:45,991 - INFO -   ✅ chr5: 完成，耗时 26.28 秒
2025-08-22 18:11:45,994 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-22 18:11:46,002 - INFO -    矩阵大小: (7487, 7487), 非零元素: 24607, 稀疏度: 0.000439
2025-08-22 18:11:46,003 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:11:46,003 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-22 18:11:46,331 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:11:46,613 - INFO -    卷积耗时: 0.610 秒
2025-08-22 18:11:46,621 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0033)
2025-08-22 18:11:46,621 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-22 18:11:46,621 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-22 18:11:46,749 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-22 18:11:47,314 - INFO - 🔥 MPS Iter 1 takes 0.145 seconds. Loss: 9.983
2025-08-22 18:11:48,605 - INFO - 🔥 MPS Iter 2 takes 0.703 seconds. Loss: 1.946
2025-08-22 18:11:50,001 - INFO - 🔥 MPS Iter 3 takes 1.988 seconds. Loss: 0.475
2025-08-22 18:11:51,015 - INFO - 🔥 MPS Iter 4 takes 3.382 seconds. Loss: 0.121
2025-08-22 18:11:51,963 - INFO - 🔥 MPS Iter 5 takes 4.395 seconds. Loss: 0.035
2025-08-22 18:11:52,740 - INFO - 🔥 MPS Iter 6 takes 5.345 seconds. Loss: 0.011
2025-08-22 18:11:53,630 - INFO - 🔥 MPS Iter 7 takes 6.121 seconds. Loss: 0.004
2025-08-22 18:11:53,631 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:11:53,631 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:11:53,656 - INFO - 🧹 GPU memory cleared
2025-08-22 18:11:55,320 - INFO -    RWR 耗时: 8.706 秒
2025-08-22 18:11:56,441 - INFO -    归一化耗时: 1.116 秒
2025-08-22 18:12:04,760 - INFO -    ✅ 完成，总耗时: 10.432 秒
2025-08-22 18:12:04,771 - INFO -   ✅ chr6: 完成，耗时 18.78 秒
2025-08-22 18:12:04,772 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-22 18:12:04,779 - INFO -    矩阵大小: (7273, 7273), 非零元素: 22469, 稀疏度: 0.000425
2025-08-22 18:12:04,779 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:12:04,779 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-22 18:12:05,033 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:12:05,268 - INFO -    卷积耗时: 0.489 秒
2025-08-22 18:12:05,272 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0032)
2025-08-22 18:12:05,272 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-22 18:12:05,272 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-22 18:12:05,371 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-22 18:12:05,784 - INFO - 🔥 MPS Iter 1 takes 0.110 seconds. Loss: 10.549
2025-08-22 18:12:06,601 - INFO - 🔥 MPS Iter 2 takes 0.513 seconds. Loss: 2.212
2025-08-22 18:12:08,138 - INFO - 🔥 MPS Iter 3 takes 1.330 seconds. Loss: 0.610
2025-08-22 18:12:09,123 - INFO - 🔥 MPS Iter 4 takes 2.868 seconds. Loss: 0.175
2025-08-22 18:12:09,918 - INFO - 🔥 MPS Iter 5 takes 3.852 seconds. Loss: 0.057
2025-08-22 18:12:10,828 - INFO - 🔥 MPS Iter 6 takes 4.648 seconds. Loss: 0.019
2025-08-22 18:12:11,467 - INFO - 🔥 MPS Iter 7 takes 5.557 seconds. Loss: 0.007
2025-08-22 18:12:11,467 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:12:11,467 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:12:11,491 - INFO - 🧹 GPU memory cleared
2025-08-22 18:12:12,832 - INFO -    RWR 耗时: 7.563 秒
2025-08-22 18:12:14,047 - INFO -    归一化耗时: 1.211 秒
2025-08-22 18:12:20,916 - INFO -    ✅ 完成，总耗时: 9.262 秒
2025-08-22 18:12:20,928 - INFO -   ✅ chr7: 完成，耗时 16.16 秒
2025-08-22 18:12:20,930 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-22 18:12:20,936 - INFO -    矩阵大小: (6471, 6471), 非零元素: 22749, 稀疏度: 0.000543
2025-08-22 18:12:20,937 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:12:20,937 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-22 18:12:21,058 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:12:21,216 - INFO -    卷积耗时: 0.279 秒
2025-08-22 18:12:21,220 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0041)
2025-08-22 18:12:21,220 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-22 18:12:21,220 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-22 18:12:21,327 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-22 18:12:21,584 - INFO - 🔥 MPS Iter 1 takes 0.115 seconds. Loss: 9.073
2025-08-22 18:12:21,912 - INFO - 🔥 MPS Iter 2 takes 0.366 seconds. Loss: 1.733
2025-08-22 18:12:22,609 - INFO - 🔥 MPS Iter 3 takes 0.693 seconds. Loss: 0.423
2025-08-22 18:12:23,702 - INFO - 🔥 MPS Iter 4 takes 1.391 seconds. Loss: 0.109
2025-08-22 18:12:24,454 - INFO - 🔥 MPS Iter 5 takes 2.484 seconds. Loss: 0.032
2025-08-22 18:12:25,094 - INFO - 🔥 MPS Iter 6 takes 3.237 seconds. Loss: 0.010
2025-08-22 18:12:25,095 - INFO - ✅ Converged after 6 iterations
2025-08-22 18:12:25,095 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:12:25,114 - INFO - 🧹 GPU memory cleared
2025-08-22 18:12:26,112 - INFO -    RWR 耗时: 4.895 秒
2025-08-22 18:12:27,098 - INFO -    归一化耗时: 0.985 秒
2025-08-22 18:12:33,097 - INFO -    ✅ 完成，总耗时: 6.159 秒
2025-08-22 18:12:33,105 - INFO -   ✅ chr8: 完成，耗时 12.18 秒
2025-08-22 18:12:33,106 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-22 18:12:33,112 - INFO -    矩阵大小: (6230, 6230), 非零元素: 19706, 稀疏度: 0.000508
2025-08-22 18:12:33,113 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:12:33,113 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-22 18:12:33,228 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:12:33,422 - INFO -    卷积耗时: 0.309 秒
2025-08-22 18:12:33,427 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0037)
2025-08-22 18:12:33,427 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-22 18:12:33,427 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-22 18:12:33,497 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-22 18:12:33,717 - INFO - 🔥 MPS Iter 1 takes 0.078 seconds. Loss: 9.567
2025-08-22 18:12:33,985 - INFO - 🔥 MPS Iter 2 takes 0.291 seconds. Loss: 1.939
2025-08-22 18:12:34,308 - INFO - 🔥 MPS Iter 3 takes 0.559 seconds. Loss: 0.498
2025-08-22 18:12:35,279 - INFO - 🔥 MPS Iter 4 takes 0.882 seconds. Loss: 0.134
2025-08-22 18:12:36,090 - INFO - 🔥 MPS Iter 5 takes 1.854 seconds. Loss: 0.040
2025-08-22 18:12:36,703 - INFO - 🔥 MPS Iter 6 takes 2.665 seconds. Loss: 0.013
2025-08-22 18:12:37,226 - INFO - 🔥 MPS Iter 7 takes 3.279 seconds. Loss: 0.004
2025-08-22 18:12:37,226 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:12:37,227 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:12:37,246 - INFO - 🧹 GPU memory cleared
2025-08-22 18:12:38,574 - INFO -    RWR 耗时: 5.151 秒
2025-08-22 18:12:39,847 - INFO -    归一化耗时: 1.272 秒
2025-08-22 18:12:46,583 - INFO -    ✅ 完成，总耗时: 6.733 秒
2025-08-22 18:12:46,589 - INFO -   ✅ chr9: 完成，耗时 13.48 秒
2025-08-22 18:12:46,589 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-22 18:12:46,594 - INFO -    矩阵大小: (6535, 6535), 非零元素: 19588, 稀疏度: 0.000459
2025-08-22 18:12:46,595 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:12:46,595 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-22 18:12:46,704 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:12:46,915 - INFO -    卷积耗时: 0.320 秒
2025-08-22 18:12:46,919 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0034)
2025-08-22 18:12:46,919 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-22 18:12:46,919 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-22 18:12:46,993 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-22 18:12:47,270 - INFO - 🔥 MPS Iter 1 takes 0.086 seconds. Loss: 10.117
2025-08-22 18:12:47,606 - INFO - 🔥 MPS Iter 2 takes 0.353 seconds. Loss: 2.164
2025-08-22 18:12:48,113 - INFO - 🔥 MPS Iter 3 takes 0.688 seconds. Loss: 0.599
2025-08-22 18:12:49,014 - INFO - 🔥 MPS Iter 4 takes 1.197 seconds. Loss: 0.182
2025-08-22 18:12:49,813 - INFO - 🔥 MPS Iter 5 takes 2.097 seconds. Loss: 0.063
2025-08-22 18:12:50,421 - INFO - 🔥 MPS Iter 6 takes 2.896 seconds. Loss: 0.023
2025-08-22 18:12:51,019 - INFO - 🔥 MPS Iter 7 takes 3.504 seconds. Loss: 0.009
2025-08-22 18:12:51,021 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:12:51,021 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:12:51,055 - INFO - 🧹 GPU memory cleared
2025-08-22 18:12:52,275 - INFO -    RWR 耗时: 5.360 秒
2025-08-22 18:12:53,382 - INFO -    归一化耗时: 1.106 秒
2025-08-22 18:13:00,517 - INFO -    ✅ 完成，总耗时: 6.786 秒
2025-08-22 18:13:00,526 - INFO -   ✅ chr10: 完成，耗时 13.94 秒
2025-08-22 18:13:00,526 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-22 18:13:00,532 - INFO -    矩阵大小: (6105, 6105), 非零元素: 18014, 稀疏度: 0.000483
2025-08-22 18:13:00,533 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:13:00,533 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-22 18:13:00,626 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:13:00,810 - INFO -    卷积耗时: 0.277 秒
2025-08-22 18:13:00,815 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0035)
2025-08-22 18:13:00,816 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-22 18:13:00,816 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-22 18:13:00,887 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-22 18:13:01,104 - INFO - 🔥 MPS Iter 1 takes 0.083 seconds. Loss: 9.874
2025-08-22 18:13:01,424 - INFO - 🔥 MPS Iter 2 takes 0.290 seconds. Loss: 2.113
2025-08-22 18:13:01,699 - INFO - 🔥 MPS Iter 3 takes 0.611 seconds. Loss: 0.592
2025-08-22 18:13:02,397 - INFO - 🔥 MPS Iter 4 takes 0.885 seconds. Loss: 0.186
2025-08-22 18:13:03,127 - INFO - 🔥 MPS Iter 5 takes 1.583 seconds. Loss: 0.069
2025-08-22 18:13:03,681 - INFO - 🔥 MPS Iter 6 takes 2.315 seconds. Loss: 0.027
2025-08-22 18:13:04,129 - INFO - 🔥 MPS Iter 7 takes 2.868 seconds. Loss: 0.012
2025-08-22 18:13:04,581 - INFO - 🔥 MPS Iter 8 takes 3.316 seconds. Loss: 0.005
2025-08-22 18:13:04,582 - INFO - ✅ Converged after 8 iterations
2025-08-22 18:13:04,582 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:13:04,627 - INFO - 🧹 GPU memory cleared
2025-08-22 18:13:05,745 - INFO -    RWR 耗时: 4.934 秒
2025-08-22 18:13:06,747 - INFO -    归一化耗时: 1.002 秒
2025-08-22 18:13:13,002 - INFO -    ✅ 完成，总耗时: 6.213 秒
2025-08-22 18:13:13,010 - INFO -   ✅ chr11: 完成，耗时 12.48 秒
2025-08-22 18:13:13,010 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-22 18:13:13,017 - INFO -    矩阵大小: (6007, 6007), 非零元素: 18677, 稀疏度: 0.000518
2025-08-22 18:13:13,017 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:13:13,017 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-22 18:13:13,115 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:13:13,317 - INFO -    卷积耗时: 0.299 秒
2025-08-22 18:13:13,321 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0039)
2025-08-22 18:13:13,321 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-22 18:13:13,321 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-22 18:13:13,404 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-22 18:13:13,607 - INFO - 🔥 MPS Iter 1 takes 0.093 seconds. Loss: 9.490
2025-08-22 18:13:13,849 - INFO - 🔥 MPS Iter 2 takes 0.287 seconds. Loss: 1.993
2025-08-22 18:13:14,110 - INFO - 🔥 MPS Iter 3 takes 0.530 seconds. Loss: 0.563
2025-08-22 18:13:14,714 - INFO - 🔥 MPS Iter 4 takes 0.792 seconds. Loss: 0.177
2025-08-22 18:13:15,490 - INFO - 🔥 MPS Iter 5 takes 1.395 seconds. Loss: 0.066
2025-08-22 18:13:16,051 - INFO - 🔥 MPS Iter 6 takes 2.172 seconds. Loss: 0.025
2025-08-22 18:13:16,545 - INFO - 🔥 MPS Iter 7 takes 2.731 seconds. Loss: 0.011
2025-08-22 18:13:16,927 - INFO - 🔥 MPS Iter 8 takes 3.226 seconds. Loss: 0.004
2025-08-22 18:13:16,928 - INFO - ✅ Converged after 8 iterations
2025-08-22 18:13:16,928 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:13:16,945 - INFO - 🧹 GPU memory cleared
2025-08-22 18:13:18,107 - INFO -    RWR 耗时: 4.790 秒
2025-08-22 18:13:18,996 - INFO -    归一化耗时: 0.888 秒
2025-08-22 18:13:24,642 - INFO -    ✅ 完成，总耗时: 5.977 秒
2025-08-22 18:13:24,648 - INFO -   ✅ chr12: 完成，耗时 11.64 秒
2025-08-22 18:13:24,648 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-22 18:13:24,654 - INFO -    矩阵大小: (6022, 6022), 非零元素: 18903, 稀疏度: 0.000521
2025-08-22 18:13:24,655 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:13:24,655 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-22 18:13:24,762 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:13:24,942 - INFO -    卷积耗时: 0.287 秒
2025-08-22 18:13:24,946 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0039)
2025-08-22 18:13:24,946 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-22 18:13:24,946 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-22 18:13:25,035 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-22 18:13:25,235 - INFO - 🔥 MPS Iter 1 takes 0.099 seconds. Loss: 9.437
2025-08-22 18:13:25,476 - INFO - 🔥 MPS Iter 2 takes 0.292 seconds. Loss: 1.898
2025-08-22 18:13:25,754 - INFO - 🔥 MPS Iter 3 takes 0.531 seconds. Loss: 0.486
2025-08-22 18:13:26,379 - INFO - 🔥 MPS Iter 4 takes 0.810 seconds. Loss: 0.129
2025-08-22 18:13:27,121 - INFO - 🔥 MPS Iter 5 takes 1.435 seconds. Loss: 0.039
2025-08-22 18:13:27,695 - INFO - 🔥 MPS Iter 6 takes 2.178 seconds. Loss: 0.012
2025-08-22 18:13:28,194 - INFO - 🔥 MPS Iter 7 takes 2.751 seconds. Loss: 0.004
2025-08-22 18:13:28,196 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:13:28,196 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:13:28,231 - INFO - 🧹 GPU memory cleared
2025-08-22 18:13:29,276 - INFO -    RWR 耗时: 4.333 秒
2025-08-22 18:13:30,223 - INFO -    归一化耗时: 0.947 秒
2025-08-22 18:13:36,068 - INFO -    ✅ 完成，总耗时: 5.568 秒
2025-08-22 18:13:36,078 - INFO -   ✅ chr13: 完成，耗时 11.43 秒
2025-08-22 18:13:36,078 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 18:13:36,084 - INFO -    矩阵大小: (6246, 6246), 非零元素: 17434, 稀疏度: 0.000447
2025-08-22 18:13:36,084 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:13:36,085 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 18:13:36,171 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:13:36,377 - INFO -    卷积耗时: 0.293 秒
2025-08-22 18:13:36,381 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0033)
2025-08-22 18:13:36,382 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 18:13:36,382 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 18:13:36,471 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 18:13:36,697 - INFO - 🔥 MPS Iter 1 takes 0.100 seconds. Loss: 10.321
2025-08-22 18:13:37,028 - INFO - 🔥 MPS Iter 2 takes 0.317 seconds. Loss: 2.349
2025-08-22 18:13:37,340 - INFO - 🔥 MPS Iter 3 takes 0.650 seconds. Loss: 0.751
2025-08-22 18:13:38,027 - INFO - 🔥 MPS Iter 4 takes 0.960 seconds. Loss: 0.282
2025-08-22 18:13:38,847 - INFO - 🔥 MPS Iter 5 takes 1.647 seconds. Loss: 0.123
2025-08-22 18:13:39,406 - INFO - 🔥 MPS Iter 6 takes 2.468 seconds. Loss: 0.056
2025-08-22 18:13:39,967 - INFO - 🔥 MPS Iter 7 takes 3.027 seconds. Loss: 0.027
2025-08-22 18:13:40,426 - INFO - 🔥 MPS Iter 8 takes 3.588 seconds. Loss: 0.013
2025-08-22 18:13:40,862 - INFO - 🔥 MPS Iter 9 takes 4.046 seconds. Loss: 0.006
2025-08-22 18:13:40,863 - INFO - ✅ Converged after 9 iterations
2025-08-22 18:13:40,863 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:13:40,883 - INFO - 🧹 GPU memory cleared
2025-08-22 18:13:42,114 - INFO -    RWR 耗时: 5.735 秒
2025-08-22 18:13:43,257 - INFO -    归一化耗时: 1.143 秒
2025-08-22 18:13:48,355 - INFO -    ✅ 完成，总耗时: 7.171 秒
2025-08-22 18:13:48,362 - INFO -   ✅ chr14: 完成，耗时 12.28 秒
2025-08-22 18:13:48,363 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-22 18:13:48,367 - INFO -    矩阵大小: (5203, 5203), 非零元素: 16532, 稀疏度: 0.000611
2025-08-22 18:13:48,368 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:13:48,368 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-22 18:13:48,459 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:13:48,569 - INFO -    卷积耗时: 0.201 秒
2025-08-22 18:13:48,574 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0046)
2025-08-22 18:13:48,574 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-22 18:13:48,574 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-22 18:13:48,664 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-22 18:13:48,802 - INFO - 🔥 MPS Iter 1 takes 0.100 seconds. Loss: 8.679
2025-08-22 18:13:48,932 - INFO - 🔥 MPS Iter 2 takes 0.230 seconds. Loss: 1.808
2025-08-22 18:13:49,068 - INFO - 🔥 MPS Iter 3 takes 0.359 seconds. Loss: 0.489
2025-08-22 18:13:49,227 - INFO - 🔥 MPS Iter 4 takes 0.495 seconds. Loss: 0.143
2025-08-22 18:13:49,425 - INFO - 🔥 MPS Iter 5 takes 0.654 seconds. Loss: 0.048
2025-08-22 18:13:49,796 - INFO - 🔥 MPS Iter 6 takes 0.853 seconds. Loss: 0.017
2025-08-22 18:13:50,237 - INFO - 🔥 MPS Iter 7 takes 1.224 seconds. Loss: 0.006
2025-08-22 18:13:50,237 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:13:50,237 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:13:50,251 - INFO - 🧹 GPU memory cleared
2025-08-22 18:13:50,855 - INFO -    RWR 耗时: 2.285 秒
2025-08-22 18:13:51,555 - INFO -    归一化耗时: 0.700 秒
2025-08-22 18:13:54,972 - INFO -    ✅ 完成，总耗时: 3.186 秒
2025-08-22 18:13:54,975 - INFO -   ✅ chr15: 完成，耗时 6.61 秒
2025-08-22 18:13:54,976 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-22 18:13:54,980 - INFO -    矩阵大小: (4911, 4911), 非零元素: 15803, 稀疏度: 0.000655
2025-08-22 18:13:54,980 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:13:54,980 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-22 18:13:55,039 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:13:55,129 - INFO -    卷积耗时: 0.149 秒
2025-08-22 18:13:55,132 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0050)
2025-08-22 18:13:55,132 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-22 18:13:55,132 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-22 18:13:55,195 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-22 18:13:55,307 - INFO - 🔥 MPS Iter 1 takes 0.069 seconds. Loss: 8.087
2025-08-22 18:13:55,412 - INFO - 🔥 MPS Iter 2 takes 0.176 seconds. Loss: 1.586
2025-08-22 18:13:55,519 - INFO - 🔥 MPS Iter 3 takes 0.281 seconds. Loss: 0.389
2025-08-22 18:13:55,637 - INFO - 🔥 MPS Iter 4 takes 0.388 seconds. Loss: 0.100
2025-08-22 18:13:55,773 - INFO - 🔥 MPS Iter 5 takes 0.506 seconds. Loss: 0.029
2025-08-22 18:13:55,930 - INFO - 🔥 MPS Iter 6 takes 0.642 seconds. Loss: 0.009
2025-08-22 18:13:55,930 - INFO - ✅ Converged after 6 iterations
2025-08-22 18:13:55,930 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:13:55,936 - INFO - 🧹 GPU memory cleared
2025-08-22 18:13:56,406 - INFO -    RWR 耗时: 1.276 秒
2025-08-22 18:13:56,978 - INFO -    归一化耗时: 0.570 秒
2025-08-22 18:14:00,325 - INFO -    ✅ 完成，总耗时: 1.995 秒
2025-08-22 18:14:00,328 - INFO -   ✅ chr16: 完成，耗时 5.35 秒
2025-08-22 18:14:00,328 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-22 18:14:00,332 - INFO -    矩阵大小: (4750, 4750), 非零元素: 14458, 稀疏度: 0.000641
2025-08-22 18:14:00,332 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:14:00,332 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-22 18:14:00,406 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:14:00,495 - INFO -    卷积耗时: 0.162 秒
2025-08-22 18:14:00,497 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0047)
2025-08-22 18:14:00,497 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-22 18:14:00,497 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-22 18:14:00,565 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-22 18:14:00,673 - INFO - 🔥 MPS Iter 1 takes 0.073 seconds. Loss: 8.523
2025-08-22 18:14:00,774 - INFO - 🔥 MPS Iter 2 takes 0.177 seconds. Loss: 1.767
2025-08-22 18:14:00,875 - INFO - 🔥 MPS Iter 3 takes 0.278 seconds. Loss: 0.466
2025-08-22 18:14:00,991 - INFO - 🔥 MPS Iter 4 takes 0.380 seconds. Loss: 0.129
2025-08-22 18:14:01,112 - INFO - 🔥 MPS Iter 5 takes 0.495 seconds. Loss: 0.040
2025-08-22 18:14:01,281 - INFO - 🔥 MPS Iter 6 takes 0.616 seconds. Loss: 0.013
2025-08-22 18:14:01,517 - INFO - 🔥 MPS Iter 7 takes 0.785 seconds. Loss: 0.005
2025-08-22 18:14:01,518 - INFO - ✅ Converged after 7 iterations
2025-08-22 18:14:01,518 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:14:01,527 - INFO - 🧹 GPU memory cleared
2025-08-22 18:14:02,167 - INFO -    RWR 耗时: 1.672 秒
2025-08-22 18:14:02,955 - INFO -    归一化耗时: 0.788 秒
2025-08-22 18:14:06,853 - INFO -    ✅ 完成，总耗时: 2.622 秒
2025-08-22 18:14:06,856 - INFO -   ✅ chr17: 完成，耗时 6.53 秒
2025-08-22 18:14:06,856 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-22 18:14:06,861 - INFO -    矩阵大小: (4536, 4536), 非零元素: 14430, 稀疏度: 0.000701
2025-08-22 18:14:06,861 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:14:06,861 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-22 18:14:06,930 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:14:07,041 - INFO -    卷积耗时: 0.180 秒
2025-08-22 18:14:07,046 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0052)
2025-08-22 18:14:07,046 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-22 18:14:07,046 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-22 18:14:07,122 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-22 18:14:07,215 - INFO - 🔥 MPS Iter 1 takes 0.086 seconds. Loss: 7.870
2025-08-22 18:14:07,297 - INFO - 🔥 MPS Iter 2 takes 0.171 seconds. Loss: 1.550
2025-08-22 18:14:07,383 - INFO - 🔥 MPS Iter 3 takes 0.253 seconds. Loss: 0.378
2025-08-22 18:14:07,472 - INFO - 🔥 MPS Iter 4 takes 0.338 seconds. Loss: 0.097
2025-08-22 18:14:07,569 - INFO - 🔥 MPS Iter 5 takes 0.427 seconds. Loss: 0.028
2025-08-22 18:14:07,677 - INFO - 🔥 MPS Iter 6 takes 0.525 seconds. Loss: 0.008
2025-08-22 18:14:07,679 - INFO - ✅ Converged after 6 iterations
2025-08-22 18:14:07,679 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:14:07,691 - INFO - 🧹 GPU memory cleared
2025-08-22 18:14:08,569 - INFO -    RWR 耗时: 1.527 秒
2025-08-22 18:14:09,572 - INFO -    归一化耗时: 1.003 秒
2025-08-22 18:14:13,811 - INFO -    ✅ 完成，总耗时: 2.710 秒
2025-08-22 18:14:13,814 - INFO -   ✅ chr18: 完成，耗时 6.96 秒
2025-08-22 18:14:13,814 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-22 18:14:13,818 - INFO -    矩阵大小: (3072, 3072), 非零元素: 8905, 稀疏度: 0.000944
2025-08-22 18:14:13,818 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:14:13,818 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-22 18:14:13,871 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:14:13,922 - INFO -    卷积耗时: 0.103 秒
2025-08-22 18:14:13,924 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0067)
2025-08-22 18:14:13,925 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-22 18:14:13,925 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-22 18:14:14,018 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-22 18:14:14,055 - INFO - 🔥 MPS Iter 1 takes 0.100 seconds. Loss: 6.821
2025-08-22 18:14:14,082 - INFO - 🔥 MPS Iter 2 takes 0.132 seconds. Loss: 1.375
2025-08-22 18:14:14,109 - INFO - 🔥 MPS Iter 3 takes 0.159 seconds. Loss: 0.352
2025-08-22 18:14:14,137 - INFO - 🔥 MPS Iter 4 takes 0.186 seconds. Loss: 0.094
2025-08-22 18:14:14,163 - INFO - 🔥 MPS Iter 5 takes 0.213 seconds. Loss: 0.028
2025-08-22 18:14:14,190 - INFO - 🔥 MPS Iter 6 takes 0.240 seconds. Loss: 0.009
2025-08-22 18:14:14,191 - INFO - ✅ Converged after 6 iterations
2025-08-22 18:14:14,191 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:14:14,194 - INFO - 🧹 GPU memory cleared
2025-08-22 18:14:14,400 - INFO -    RWR 耗时: 0.477 秒
2025-08-22 18:14:14,606 - INFO -    归一化耗时: 0.206 秒
2025-08-22 18:14:16,204 - INFO -    ✅ 完成，总耗时: 0.787 秒
2025-08-22 18:14:16,206 - INFO -   ✅ chr19: 完成，耗时 2.39 秒
2025-08-22 18:14:16,206 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-22 18:14:16,210 - INFO -    矩阵大小: (8552, 8552), 非零元素: 10034, 稀疏度: 0.000137
2025-08-22 18:14:16,211 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 18:14:16,211 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-22 18:14:16,424 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 18:14:16,843 - INFO -    卷积耗时: 0.632 秒
2025-08-22 18:14:16,848 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0011)
2025-08-22 18:14:16,848 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-22 18:14:16,848 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-22 18:14:16,970 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-22 18:14:17,702 - INFO - 🔥 MPS Iter 1 takes 0.141 seconds. Loss: 17.675
2025-08-22 18:14:19,537 - INFO - 🔥 MPS Iter 2 takes 0.856 seconds. Loss: 5.407
2025-08-22 18:14:21,029 - INFO - 🔥 MPS Iter 3 takes 2.693 seconds. Loss: 1.996
2025-08-22 18:14:22,042 - INFO - 🔥 MPS Iter 4 takes 4.183 seconds. Loss: 0.755
2025-08-22 18:14:23,438 - INFO - 🔥 MPS Iter 5 takes 5.196 seconds. Loss: 0.308
2025-08-22 18:14:24,499 - INFO - 🔥 MPS Iter 6 takes 6.592 seconds. Loss: 0.127
2025-08-22 18:14:25,677 - INFO - 🔥 MPS Iter 7 takes 7.653 seconds. Loss: 0.055
2025-08-22 18:14:26,941 - INFO - 🔥 MPS Iter 8 takes 8.832 seconds. Loss: 0.024
2025-08-22 18:14:28,203 - INFO - 🔥 MPS Iter 9 takes 10.095 seconds. Loss: 0.011
2025-08-22 18:14:29,508 - INFO - 🔥 MPS Iter 10 takes 11.358 seconds. Loss: 0.005
2025-08-22 18:14:29,510 - INFO - ✅ Converged after 10 iterations
2025-08-22 18:14:29,510 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 18:14:29,601 - INFO - 🧹 GPU memory cleared
2025-08-22 18:14:30,930 - INFO -    RWR 耗时: 14.085 秒
2025-08-22 18:14:31,826 - INFO -    归一化耗时: 0.896 秒
2025-08-22 18:14:37,228 - INFO -    ✅ 完成，总耗时: 15.614 秒
2025-08-22 18:14:37,235 - INFO -   ✅ chrX: 完成，耗时 21.03 秒
2025-08-22 18:14:37,235 - INFO - 🎯 细胞 GasdE701001 完成: 20 成功, 0 失败, 总耗时 4.2 分钟
2025-08-22 18:14:37,235 - INFO - ⏱️  预计剩余时间: 0.0 分钟
2025-08-22 18:14:37,235 - INFO - 🎊 Stage E70 完成: 20 个矩阵成功, 0 个失败
2025-08-22 18:14:37,235 - INFO -    总耗时: 0.07 小时
2025-08-22 18:14:37,235 - INFO - 
============================================================
2025-08-22 18:14:37,235 - INFO - 🎉 所有 Stage 处理完成!
2025-08-22 18:14:37,235 - INFO - 📊 总计: 20 个矩阵成功, 0 个失败
2025-08-22 18:14:37,235 - INFO - ⏱️  总耗时: 0.07 小时
2025-08-22 18:14:37,235 - INFO - 💡 预计节省时间: 0.0 小时 (相比纯 CPU)
2025-08-22 18:14:37,235 - INFO - 📄 详细日志已保存到: mps_imputation.log
2025-08-22 19:34:39,623 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 19:34:39,634 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 19:34:39,634 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 19:34:39,634 - INFO - 🔧 使用 MPS: True
2025-08-22 19:34:39,634 - INFO - 🎯 处理 stages: ['E70']
2025-08-22 19:34:39,634 - INFO - 📦 批处理大小: 2
2025-08-22 19:34:40,058 - INFO - NumExpr defaulting to 10 threads.
2025-08-22 19:34:43,213 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-22 19:34:43,213 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-22 19:34:43,213 - INFO - 
==================================================
2025-08-22 19:34:43,213 - INFO - 🗂️  开始处理 Stage: E70
2025-08-22 19:34:43,213 - INFO - ==================================================
2025-08-22 19:34:43,279 - INFO - 🗂️  Stage E70: 发现 3 个细胞
2025-08-22 19:34:43,279 - INFO - 📦 使用批处理模式，批次大小: 2
2025-08-22 19:34:43,279 - INFO - 📦 处理批次 1: 细胞 1-2/3
2025-08-22 19:34:43,280 - INFO - 📊 批次内处理: GasdE701001 (1/3)
2025-08-22 19:34:43,306 - INFO - 🧬 开始处理细胞: GasdE701001
2025-08-22 19:34:43,307 - INFO -   ✅ chr1: 已存在，跳过
2025-08-22 19:34:43,308 - INFO -   ✅ chr2: 已存在，跳过
2025-08-22 19:34:43,309 - INFO -   ✅ chr3: 已存在，跳过
2025-08-22 19:34:43,309 - INFO -   ✅ chr4: 已存在，跳过
2025-08-22 19:34:43,310 - INFO -   ✅ chr5: 已存在，跳过
2025-08-22 19:34:43,311 - INFO -   ✅ chr6: 已存在，跳过
2025-08-22 19:34:43,312 - INFO -   ✅ chr7: 已存在，跳过
2025-08-22 19:34:43,313 - INFO -   ✅ chr8: 已存在，跳过
2025-08-22 19:34:43,314 - INFO -   ✅ chr9: 已存在，跳过
2025-08-22 19:34:43,314 - INFO -   ✅ chr10: 已存在，跳过
2025-08-22 19:34:43,315 - INFO -   ✅ chr11: 已存在，跳过
2025-08-22 19:34:43,315 - INFO -   ✅ chr12: 已存在，跳过
2025-08-22 19:34:43,316 - INFO -   ✅ chr13: 已存在，跳过
2025-08-22 19:34:43,317 - INFO -   ✅ chr14: 已存在，跳过
2025-08-22 19:34:43,318 - INFO -   ✅ chr15: 已存在，跳过
2025-08-22 19:34:43,319 - INFO -   ✅ chr16: 已存在，跳过
2025-08-22 19:34:43,320 - INFO -   ✅ chr17: 已存在，跳过
2025-08-22 19:34:43,321 - INFO -   ✅ chr18: 已存在，跳过
2025-08-22 19:34:43,323 - INFO -   ✅ chr19: 已存在，跳过
2025-08-22 19:34:43,324 - INFO -   ✅ chrX: 已存在，跳过
2025-08-22 19:34:43,324 - INFO - 🎯 细胞 GasdE701001 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-22 19:34:43,324 - INFO - 📊 批次内处理: GasdE701003 (2/3)
2025-08-22 19:34:43,324 - INFO - 🧬 开始处理细胞: GasdE701003
2025-08-22 19:34:43,325 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 19:34:43,339 - INFO -    矩阵大小: (9774, 9774), 非零元素: 38802, 稀疏度: 0.000406
2025-08-22 19:34:43,341 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:34:43,341 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-22 19:34:44,313 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:34:45,044 - INFO -    卷积耗时: 1.703 秒
2025-08-22 19:34:45,056 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0028)
2025-08-22 19:34:45,056 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-22 19:34:45,056 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-22 19:34:45,779 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-22 19:34:49,750 - INFO - 🔥 MPS Iter 1 takes 0.760 seconds. Loss: 10.740
2025-08-22 19:34:53,852 - INFO - 🔥 MPS Iter 2 takes 4.748 seconds. Loss: 2.022
2025-08-22 19:34:57,719 - INFO - 🔥 MPS Iter 3 takes 8.807 seconds. Loss: 0.499
2025-08-22 19:35:01,987 - INFO - 🔥 MPS Iter 4 takes 12.669 seconds. Loss: 0.131
2025-08-22 19:35:06,223 - INFO - 🔥 MPS Iter 5 takes 16.942 seconds. Loss: 0.040
2025-08-22 19:35:10,146 - INFO - 🔥 MPS Iter 6 takes 21.190 seconds. Loss: 0.013
2025-08-22 19:35:13,879 - INFO - 🔥 MPS Iter 7 takes 25.106 seconds. Loss: 0.004
2025-08-22 19:35:13,887 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:35:13,888 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:35:14,287 - INFO - 🧹 GPU memory cleared
2025-08-22 19:35:18,780 - INFO -    RWR 耗时: 33.733 秒
2025-08-22 19:35:21,967 - INFO -    归一化耗时: 3.187 秒
2025-08-22 19:36:17,544 - INFO -    ✅ 完成，总耗时: 38.622 秒
2025-08-22 19:36:17,558 - INFO -   ✅ chr1: 完成，耗时 94.23 秒
2025-08-22 19:36:17,559 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 19:36:17,621 - INFO -    矩阵大小: (9106, 9106), 非零元素: 37196, 稀疏度: 0.000449
2025-08-22 19:36:17,623 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:36:17,623 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-22 19:36:18,085 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:36:18,705 - INFO -    卷积耗时: 1.082 秒
2025-08-22 19:36:18,715 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0032)
2025-08-22 19:36:18,716 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-22 19:36:18,716 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-22 19:36:18,955 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-22 19:36:21,398 - INFO - 🔥 MPS Iter 1 takes 0.332 seconds. Loss: 10.049
2025-08-22 19:36:24,530 - INFO - 🔥 MPS Iter 2 takes 2.693 seconds. Loss: 1.869
2025-08-22 19:36:27,389 - INFO - 🔥 MPS Iter 3 takes 5.821 seconds. Loss: 0.461
2025-08-22 19:36:30,340 - INFO - 🔥 MPS Iter 4 takes 8.682 seconds. Loss: 0.123
2025-08-22 19:36:33,424 - INFO - 🔥 MPS Iter 5 takes 11.631 seconds. Loss: 0.038
2025-08-22 19:36:36,098 - INFO - 🔥 MPS Iter 6 takes 14.713 seconds. Loss: 0.012
2025-08-22 19:36:39,133 - INFO - 🔥 MPS Iter 7 takes 17.391 seconds. Loss: 0.004
2025-08-22 19:36:39,135 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:36:39,135 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:36:39,334 - INFO - 🧹 GPU memory cleared
2025-08-22 19:36:43,002 - INFO -    RWR 耗时: 24.295 秒
2025-08-22 19:36:45,955 - INFO -    归一化耗时: 2.952 秒
2025-08-22 19:37:43,225 - INFO -    ✅ 完成，总耗时: 28.329 秒
2025-08-22 19:37:43,243 - INFO -   ✅ chr2: 完成，耗时 85.68 秒
2025-08-22 19:37:43,245 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 19:37:43,260 - INFO -    矩阵大小: (8002, 8002), 非零元素: 26473, 稀疏度: 0.000413
2025-08-22 19:37:43,262 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:37:43,262 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 19:37:43,632 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:37:43,973 - INFO -    卷积耗时: 0.711 秒
2025-08-22 19:37:43,980 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0029)
2025-08-22 19:37:43,980 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 19:37:43,980 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 19:37:44,401 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 19:37:45,167 - INFO - 🔥 MPS Iter 1 takes 0.441 seconds. Loss: 11.170
2025-08-22 19:37:48,006 - INFO - 🔥 MPS Iter 2 takes 1.190 seconds. Loss: 2.411
2025-08-22 19:37:49,717 - INFO - 🔥 MPS Iter 3 takes 4.030 seconds. Loss: 0.685
2025-08-22 19:37:51,176 - INFO - 🔥 MPS Iter 4 takes 5.748 seconds. Loss: 0.207
2025-08-22 19:37:52,973 - INFO - 🔥 MPS Iter 5 takes 7.199 seconds. Loss: 0.069
2025-08-22 19:37:54,752 - INFO - 🔥 MPS Iter 6 takes 8.998 seconds. Loss: 0.024
2025-08-22 19:37:56,251 - INFO - 🔥 MPS Iter 7 takes 10.776 seconds. Loss: 0.009
2025-08-22 19:37:56,255 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:37:56,257 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:37:56,615 - INFO - 🧹 GPU memory cleared
2025-08-22 19:37:59,117 - INFO -    RWR 耗时: 15.142 秒
2025-08-22 19:38:00,627 - INFO -    归一化耗时: 1.510 秒
2025-08-22 19:38:11,169 - INFO -    ✅ 完成，总耗时: 17.364 秒
2025-08-22 19:38:11,194 - INFO -   ✅ chr3: 完成，耗时 27.95 秒
2025-08-22 19:38:11,195 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 19:38:11,203 - INFO -    矩阵大小: (7826, 7826), 非零元素: 26168, 稀疏度: 0.000427
2025-08-22 19:38:11,205 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:38:11,205 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 19:38:11,720 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:38:12,093 - INFO -    卷积耗时: 0.888 秒
2025-08-22 19:38:12,099 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0029)
2025-08-22 19:38:12,099 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 19:38:12,099 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 19:38:12,217 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 19:38:12,966 - INFO - 🔥 MPS Iter 1 takes 0.134 seconds. Loss: 10.629
2025-08-22 19:38:15,371 - INFO - 🔥 MPS Iter 2 takes 0.870 seconds. Loss: 2.214
2025-08-22 19:38:16,806 - INFO - 🔥 MPS Iter 3 takes 3.274 seconds. Loss: 0.612
2025-08-22 19:38:18,436 - INFO - 🔥 MPS Iter 4 takes 4.710 seconds. Loss: 0.182
2025-08-22 19:38:19,931 - INFO - 🔥 MPS Iter 5 takes 6.339 seconds. Loss: 0.062
2025-08-22 19:38:21,436 - INFO - 🔥 MPS Iter 6 takes 7.836 seconds. Loss: 0.022
2025-08-22 19:38:23,420 - INFO - 🔥 MPS Iter 7 takes 9.341 seconds. Loss: 0.008
2025-08-22 19:38:23,422 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:38:23,422 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:38:23,472 - INFO - 🧹 GPU memory cleared
2025-08-22 19:38:25,484 - INFO -    RWR 耗时: 13.390 秒
2025-08-22 19:38:27,463 - INFO -    归一化耗时: 1.974 秒
2025-08-22 19:38:36,351 - INFO -    ✅ 完成，总耗时: 16.252 秒
2025-08-22 19:38:36,365 - INFO -   ✅ chr4: 完成，耗时 25.17 秒
2025-08-22 19:38:36,369 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 19:38:36,379 - INFO -    矩阵大小: (7592, 7592), 非零元素: 27038, 稀疏度: 0.000469
2025-08-22 19:38:36,380 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:38:36,380 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 19:38:36,608 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:38:37,014 - INFO -    卷积耗时: 0.633 秒
2025-08-22 19:38:37,022 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0032)
2025-08-22 19:38:37,022 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 19:38:37,023 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 19:38:37,202 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 19:38:37,909 - INFO - 🔥 MPS Iter 1 takes 0.193 seconds. Loss: 10.095
2025-08-22 19:38:40,185 - INFO - 🔥 MPS Iter 2 takes 0.889 seconds. Loss: 2.113
2025-08-22 19:38:41,513 - INFO - 🔥 MPS Iter 3 takes 3.166 seconds. Loss: 0.603
2025-08-22 19:38:43,026 - INFO - 🔥 MPS Iter 4 takes 4.493 seconds. Loss: 0.196
2025-08-22 19:38:44,549 - INFO - 🔥 MPS Iter 5 takes 6.020 seconds. Loss: 0.074
2025-08-22 19:38:45,716 - INFO - 🔥 MPS Iter 6 takes 7.529 seconds. Loss: 0.030
2025-08-22 19:38:47,186 - INFO - 🔥 MPS Iter 7 takes 8.705 seconds. Loss: 0.013
2025-08-22 19:38:48,768 - INFO - 🔥 MPS Iter 8 takes 10.166 seconds. Loss: 0.006
2025-08-22 19:38:48,770 - INFO - ✅ Converged after 8 iterations
2025-08-22 19:38:48,770 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:38:48,812 - INFO - 🧹 GPU memory cleared
2025-08-22 19:38:50,960 - INFO -    RWR 耗时: 13.944 秒
2025-08-22 19:38:52,174 - INFO -    归一化耗时: 1.209 秒
2025-08-22 19:39:01,559 - INFO -    ✅ 完成，总耗时: 15.786 秒
2025-08-22 19:39:01,568 - INFO -   ✅ chr5: 完成，耗时 25.20 秒
2025-08-22 19:39:01,569 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-22 19:39:01,587 - INFO -    矩阵大小: (7487, 7487), 非零元素: 28327, 稀疏度: 0.000505
2025-08-22 19:39:01,588 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:39:01,588 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-22 19:39:02,099 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:39:02,578 - INFO -    卷积耗时: 0.990 秒
2025-08-22 19:39:02,586 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0035)
2025-08-22 19:39:02,586 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-22 19:39:02,586 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-22 19:39:02,734 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-22 19:39:03,515 - INFO - 🔥 MPS Iter 1 takes 0.166 seconds. Loss: 9.572
2025-08-22 19:39:05,480 - INFO - 🔥 MPS Iter 2 takes 0.930 seconds. Loss: 1.836
2025-08-22 19:39:06,864 - INFO - 🔥 MPS Iter 3 takes 2.903 seconds. Loss: 0.459
2025-08-22 19:39:08,262 - INFO - 🔥 MPS Iter 4 takes 4.287 seconds. Loss: 0.122
2025-08-22 19:39:09,763 - INFO - 🔥 MPS Iter 5 takes 5.677 seconds. Loss: 0.037
2025-08-22 19:39:11,069 - INFO - 🔥 MPS Iter 6 takes 7.184 seconds. Loss: 0.012
2025-08-22 19:39:12,439 - INFO - 🔥 MPS Iter 7 takes 8.484 seconds. Loss: 0.004
2025-08-22 19:39:12,440 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:39:12,441 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:39:12,495 - INFO - 🧹 GPU memory cleared
2025-08-22 19:39:14,712 - INFO -    RWR 耗时: 12.132 秒
2025-08-22 19:39:16,419 - INFO -    归一化耗时: 1.706 秒
2025-08-22 19:39:26,360 - INFO -    ✅ 完成，总耗时: 14.829 秒
2025-08-22 19:39:26,373 - INFO -   ✅ chr6: 完成，耗时 24.80 秒
2025-08-22 19:39:26,375 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-22 19:39:26,393 - INFO -    矩阵大小: (7273, 7273), 非零元素: 25035, 稀疏度: 0.000473
2025-08-22 19:39:26,395 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:39:26,395 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-22 19:39:26,624 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:39:26,937 - INFO -    卷积耗时: 0.542 秒
2025-08-22 19:39:26,943 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0032)
2025-08-22 19:39:26,943 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-22 19:39:26,943 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-22 19:39:27,133 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-22 19:39:27,711 - INFO - 🔥 MPS Iter 1 takes 0.208 seconds. Loss: 10.138
2025-08-22 19:39:29,373 - INFO - 🔥 MPS Iter 2 takes 0.773 seconds. Loss: 2.240
2025-08-22 19:39:30,616 - INFO - 🔥 MPS Iter 3 takes 2.432 seconds. Loss: 0.708
2025-08-22 19:39:31,731 - INFO - 🔥 MPS Iter 4 takes 3.676 seconds. Loss: 0.253
2025-08-22 19:39:32,840 - INFO - 🔥 MPS Iter 5 takes 4.790 seconds. Loss: 0.104
2025-08-22 19:39:34,115 - INFO - 🔥 MPS Iter 6 takes 5.904 seconds. Loss: 0.044
2025-08-22 19:39:35,347 - INFO - 🔥 MPS Iter 7 takes 7.175 seconds. Loss: 0.019
2025-08-22 19:39:36,516 - INFO - 🔥 MPS Iter 8 takes 8.408 seconds. Loss: 0.009
2025-08-22 19:39:36,518 - INFO - ✅ Converged after 8 iterations
2025-08-22 19:39:36,518 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:39:36,568 - INFO - 🧹 GPU memory cleared
2025-08-22 19:39:38,189 - INFO -    RWR 耗时: 11.250 秒
2025-08-22 19:39:39,340 - INFO -    归一化耗时: 1.151 秒
2025-08-22 19:39:46,800 - INFO -    ✅ 完成，总耗时: 12.943 秒
2025-08-22 19:39:46,806 - INFO -   ✅ chr7: 完成，耗时 20.43 秒
2025-08-22 19:39:46,807 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-22 19:39:46,815 - INFO -    矩阵大小: (6471, 6471), 非零元素: 24277, 稀疏度: 0.000580
2025-08-22 19:39:46,817 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:39:46,817 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-22 19:39:46,913 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:39:47,081 - INFO -    卷积耗时: 0.264 秒
2025-08-22 19:39:47,085 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0040)
2025-08-22 19:39:47,085 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-22 19:39:47,085 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-22 19:39:47,150 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-22 19:39:47,423 - INFO - 🔥 MPS Iter 1 takes 0.072 seconds. Loss: 9.065
2025-08-22 19:39:47,806 - INFO - 🔥 MPS Iter 2 takes 0.339 seconds. Loss: 1.815
2025-08-22 19:39:49,143 - INFO - 🔥 MPS Iter 3 takes 0.723 seconds. Loss: 0.493
2025-08-22 19:39:50,283 - INFO - 🔥 MPS Iter 4 takes 2.060 seconds. Loss: 0.146
2025-08-22 19:39:51,155 - INFO - 🔥 MPS Iter 5 takes 3.201 seconds. Loss: 0.049
2025-08-22 19:39:51,916 - INFO - 🔥 MPS Iter 6 takes 4.072 seconds. Loss: 0.017
2025-08-22 19:39:52,643 - INFO - 🔥 MPS Iter 7 takes 4.832 seconds. Loss: 0.006
2025-08-22 19:39:52,643 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:39:52,644 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:39:52,659 - INFO - 🧹 GPU memory cleared
2025-08-22 19:39:54,147 - INFO -    RWR 耗时: 7.065 秒
2025-08-22 19:39:55,367 - INFO -    归一化耗时: 1.220 秒
2025-08-22 19:40:02,166 - INFO -    ✅ 完成，总耗时: 8.549 秒
2025-08-22 19:40:02,174 - INFO -   ✅ chr8: 完成，耗时 15.37 秒
2025-08-22 19:40:02,176 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-22 19:40:02,183 - INFO -    矩阵大小: (6230, 6230), 非零元素: 23811, 稀疏度: 0.000613
2025-08-22 19:40:02,183 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:40:02,184 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-22 19:40:02,527 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:40:02,707 - INFO -    卷积耗时: 0.523 秒
2025-08-22 19:40:02,712 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0041)
2025-08-22 19:40:02,712 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-22 19:40:02,712 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-22 19:40:02,789 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-22 19:40:03,046 - INFO - 🔥 MPS Iter 1 takes 0.086 seconds. Loss: 8.599
2025-08-22 19:40:03,398 - INFO - 🔥 MPS Iter 2 takes 0.336 seconds. Loss: 1.617
2025-08-22 19:40:04,653 - INFO - 🔥 MPS Iter 3 takes 0.688 seconds. Loss: 0.398
2025-08-22 19:40:05,665 - INFO - 🔥 MPS Iter 4 takes 1.947 seconds. Loss: 0.106
2025-08-22 19:40:06,447 - INFO - 🔥 MPS Iter 5 takes 2.956 seconds. Loss: 0.033
2025-08-22 19:40:07,153 - INFO - 🔥 MPS Iter 6 takes 3.743 seconds. Loss: 0.011
2025-08-22 19:40:07,820 - INFO - 🔥 MPS Iter 7 takes 4.444 seconds. Loss: 0.004
2025-08-22 19:40:07,822 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:40:07,822 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:40:07,839 - INFO - 🧹 GPU memory cleared
2025-08-22 19:40:09,516 - INFO -    RWR 耗时: 6.808 秒
2025-08-22 19:40:10,494 - INFO -    归一化耗时: 0.973 秒
2025-08-22 19:40:16,619 - INFO -    ✅ 完成，总耗时: 8.304 秒
2025-08-22 19:40:16,626 - INFO -   ✅ chr9: 完成，耗时 14.45 秒
2025-08-22 19:40:16,627 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-22 19:40:16,639 - INFO -    矩阵大小: (6535, 6535), 非零元素: 23528, 稀疏度: 0.000551
2025-08-22 19:40:16,639 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:40:16,639 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-22 19:40:16,756 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:40:16,972 - INFO -    卷积耗时: 0.333 秒
2025-08-22 19:40:16,978 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0038)
2025-08-22 19:40:16,978 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-22 19:40:16,978 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-22 19:40:17,069 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-22 19:40:17,367 - INFO - 🔥 MPS Iter 1 takes 0.101 seconds. Loss: 9.043
2025-08-22 19:40:17,967 - INFO - 🔥 MPS Iter 2 takes 0.390 seconds. Loss: 1.712
2025-08-22 19:40:19,587 - INFO - 🔥 MPS Iter 3 takes 1.178 seconds. Loss: 0.419
2025-08-22 19:40:20,517 - INFO - 🔥 MPS Iter 4 takes 2.615 seconds. Loss: 0.108
2025-08-22 19:40:21,237 - INFO - 🔥 MPS Iter 5 takes 3.541 seconds. Loss: 0.032
2025-08-22 19:40:21,988 - INFO - 🔥 MPS Iter 6 takes 4.263 seconds. Loss: 0.010
2025-08-22 19:40:22,842 - INFO - 🔥 MPS Iter 7 takes 5.012 seconds. Loss: 0.004
2025-08-22 19:40:22,844 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:40:22,844 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:40:22,919 - INFO - 🧹 GPU memory cleared
2025-08-22 19:40:24,751 - INFO -    RWR 耗时: 7.778 秒
2025-08-22 19:40:25,860 - INFO -    归一化耗时: 1.103 秒
2025-08-22 19:40:34,572 - INFO -    ✅ 完成，总耗时: 9.213 秒
2025-08-22 19:40:34,581 - INFO -   ✅ chr10: 完成，耗时 17.95 秒
2025-08-22 19:40:34,595 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-22 19:40:34,607 - INFO -    矩阵大小: (6105, 6105), 非零元素: 21016, 稀疏度: 0.000564
2025-08-22 19:40:34,608 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:40:34,608 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-22 19:40:34,760 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:40:35,010 - INFO -    卷积耗时: 0.402 秒
2025-08-22 19:40:35,018 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0036)
2025-08-22 19:40:35,019 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-22 19:40:35,019 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-22 19:40:35,132 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-22 19:40:35,395 - INFO - 🔥 MPS Iter 1 takes 0.193 seconds. Loss: 9.024
2025-08-22 19:40:35,685 - INFO - 🔥 MPS Iter 2 takes 0.380 seconds. Loss: 1.764
2025-08-22 19:40:36,460 - INFO - 🔥 MPS Iter 3 takes 0.668 seconds. Loss: 0.447
2025-08-22 19:40:37,545 - INFO - 🔥 MPS Iter 4 takes 1.553 seconds. Loss: 0.122
2025-08-22 19:40:38,496 - INFO - 🔥 MPS Iter 5 takes 2.528 seconds. Loss: 0.038
2025-08-22 19:40:39,116 - INFO - 🔥 MPS Iter 6 takes 3.489 seconds. Loss: 0.013
2025-08-22 19:40:39,769 - INFO - 🔥 MPS Iter 7 takes 4.100 seconds. Loss: 0.005
2025-08-22 19:40:39,770 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:40:39,771 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:40:39,809 - INFO - 🧹 GPU memory cleared
2025-08-22 19:40:41,297 - INFO -    RWR 耗时: 6.285 秒
2025-08-22 19:40:42,503 - INFO -    归一化耗时: 1.206 秒
2025-08-22 19:40:49,761 - INFO -    ✅ 完成，总耗时: 7.894 秒
2025-08-22 19:40:49,766 - INFO -   ✅ chr11: 完成，耗时 15.17 秒
2025-08-22 19:40:49,767 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-22 19:40:49,776 - INFO -    矩阵大小: (6007, 6007), 非零元素: 21438, 稀疏度: 0.000594
2025-08-22 19:40:49,777 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:40:49,777 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-22 19:40:49,889 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:40:50,152 - INFO -    卷积耗时: 0.375 秒
2025-08-22 19:40:50,159 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0040)
2025-08-22 19:40:50,160 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-22 19:40:50,160 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-22 19:40:50,264 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-22 19:40:50,523 - INFO - 🔥 MPS Iter 1 takes 0.166 seconds. Loss: 9.134
2025-08-22 19:40:50,924 - INFO - 🔥 MPS Iter 2 takes 0.366 seconds. Loss: 1.878
2025-08-22 19:40:51,570 - INFO - 🔥 MPS Iter 3 takes 0.766 seconds. Loss: 0.532
2025-08-22 19:40:52,763 - INFO - 🔥 MPS Iter 4 takes 1.418 seconds. Loss: 0.165
2025-08-22 19:40:53,522 - INFO - 🔥 MPS Iter 5 takes 2.609 seconds. Loss: 0.059
2025-08-22 19:40:54,233 - INFO - 🔥 MPS Iter 6 takes 3.364 seconds. Loss: 0.022
2025-08-22 19:40:54,867 - INFO - 🔥 MPS Iter 7 takes 4.076 seconds. Loss: 0.009
2025-08-22 19:40:54,871 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:40:54,871 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:40:54,965 - INFO - 🧹 GPU memory cleared
2025-08-22 19:40:56,564 - INFO -    RWR 耗时: 6.410 秒
2025-08-22 19:40:57,714 - INFO -    归一化耗时: 1.151 秒
2025-08-22 19:41:06,065 - INFO -    ✅ 完成，总耗时: 7.935 秒
2025-08-22 19:41:06,075 - INFO -   ✅ chr12: 完成，耗时 16.31 秒
2025-08-22 19:41:06,075 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-22 19:41:06,091 - INFO -    矩阵大小: (6022, 6022), 非零元素: 23380, 稀疏度: 0.000645
2025-08-22 19:41:06,093 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:41:06,093 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-22 19:41:06,240 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:41:06,521 - INFO -    卷积耗时: 0.428 秒
2025-08-22 19:41:06,527 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0044)
2025-08-22 19:41:06,527 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-22 19:41:06,527 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-22 19:41:06,774 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-22 19:41:07,013 - INFO - 🔥 MPS Iter 1 takes 0.274 seconds. Loss: 8.402
2025-08-22 19:41:07,707 - INFO - 🔥 MPS Iter 2 takes 0.489 seconds. Loss: 1.624
2025-08-22 19:41:08,370 - INFO - 🔥 MPS Iter 3 takes 1.183 seconds. Loss: 0.422
2025-08-22 19:41:09,585 - INFO - 🔥 MPS Iter 4 takes 1.856 seconds. Loss: 0.122
2025-08-22 19:41:10,251 - INFO - 🔥 MPS Iter 5 takes 3.076 seconds. Loss: 0.041
2025-08-22 19:41:10,916 - INFO - 🔥 MPS Iter 6 takes 3.727 seconds. Loss: 0.014
2025-08-22 19:41:11,528 - INFO - 🔥 MPS Iter 7 takes 4.398 seconds. Loss: 0.005
2025-08-22 19:41:11,530 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:41:11,530 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:41:11,587 - INFO - 🧹 GPU memory cleared
2025-08-22 19:41:13,514 - INFO -    RWR 耗时: 6.991 秒
2025-08-22 19:41:14,810 - INFO -    归一化耗时: 1.296 秒
2025-08-22 19:41:23,194 - INFO -    ✅ 完成，总耗时: 8.715 秒
2025-08-22 19:41:23,201 - INFO -   ✅ chr13: 完成，耗时 17.13 秒
2025-08-22 19:41:23,203 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 19:41:23,224 - INFO -    矩阵大小: (6246, 6246), 非零元素: 20179, 稀疏度: 0.000517
2025-08-22 19:41:23,227 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:41:23,227 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 19:41:23,417 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:41:23,727 - INFO -    卷积耗时: 0.500 秒
2025-08-22 19:41:23,738 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0035)
2025-08-22 19:41:23,738 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 19:41:23,738 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 19:41:23,849 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 19:41:24,149 - INFO - 🔥 MPS Iter 1 takes 0.125 seconds. Loss: 9.554
2025-08-22 19:41:24,577 - INFO - 🔥 MPS Iter 2 takes 0.423 seconds. Loss: 2.077
2025-08-22 19:41:25,755 - INFO - 🔥 MPS Iter 3 takes 0.842 seconds. Loss: 0.641
2025-08-22 19:52:14,016 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 19:52:14,017 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 19:52:14,017 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 19:52:14,018 - INFO - 🔧 使用 MPS: True
2025-08-22 19:52:14,018 - INFO - 🎯 处理 stages: ['E70']
2025-08-22 19:52:14,018 - INFO - 📦 批处理大小: 1
2025-08-22 19:52:14,018 - INFO - 🔄 并行染色体处理: True
2025-08-22 19:52:15,056 - INFO - ✅ MPS 后端可用
2025-08-22 19:52:15,056 - INFO - 
==================================================
2025-08-22 19:52:15,056 - INFO - 🗂️  开始处理 Stage: E70
2025-08-22 19:52:15,056 - INFO - ==================================================
2025-08-22 19:52:15,057 - INFO - 🎯 限制处理细胞数量: 1
2025-08-22 19:52:15,057 - INFO - 📁 开始处理 stage: E70
2025-08-22 19:52:15,331 - INFO - 🔍 发现 557 个细胞，批次大小: 1
2025-08-22 19:52:15,331 - INFO - 🔄 模式: MPS 并行染色体处理
2025-08-22 19:52:15,331 - INFO - 📦 批次 1/557: 处理 1 个细胞
2025-08-22 19:52:15,449 - INFO - NumExpr defaulting to 10 threads.
2025-08-22 19:52:15,702 - INFO - 🧬 开始处理细胞: GasdE701001
2025-08-22 19:52:15,702 - INFO - 🔄 使用 MPS 并行处理 20 个染色体
2025-08-22 19:52:15,704 - INFO -   ✅ chr1: 已存在，跳过
2025-08-22 19:52:15,705 - INFO -   ✅ chr2: 已存在，跳过
2025-08-22 19:52:15,705 - INFO -   ✅ chr3: 已存在，跳过
2025-08-22 19:52:15,706 - INFO -   ✅ chr4: 已存在，跳过
2025-08-22 19:52:15,706 - INFO -   ✅ chr5: 已存在，跳过
2025-08-22 19:52:15,706 - INFO -   ✅ chr6: 已存在，跳过
2025-08-22 19:52:15,707 - INFO -   ✅ chr7: 已存在，跳过
2025-08-22 19:52:15,708 - INFO -   ✅ chr8: 已存在，跳过
2025-08-22 19:52:15,708 - INFO -   ✅ chr9: 已存在，跳过
2025-08-22 19:52:15,709 - INFO -   ✅ chr10: 已存在，跳过
2025-08-22 19:52:15,709 - INFO -   ✅ chr11: 已存在，跳过
2025-08-22 19:52:15,709 - INFO -   ✅ chr12: 已存在，跳过
2025-08-22 19:52:15,710 - INFO -   ✅ chr13: 已存在，跳过
2025-08-22 19:52:15,710 - INFO -   ✅ chr14: 已存在，跳过
2025-08-22 19:52:15,711 - INFO -   ✅ chr15: 已存在，跳过
2025-08-22 19:52:15,711 - INFO -   ✅ chr16: 已存在，跳过
2025-08-22 19:52:15,711 - INFO -   ✅ chr17: 已存在，跳过
2025-08-22 19:52:15,712 - INFO -   ✅ chr18: 已存在，跳过
2025-08-22 19:52:15,712 - INFO -   ✅ chr19: 已存在，跳过
2025-08-22 19:52:15,712 - INFO -   ✅ chrX: 已存在，跳过
2025-08-22 19:52:15,713 - INFO - 🎯 细胞 GasdE701001 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-22 19:52:15,713 - INFO - 📦 批次 1 完成，耗时 0.0 分钟
2025-08-22 19:52:15,713 - INFO - 📦 批次 2/557: 处理 1 个细胞
2025-08-22 19:52:15,713 - INFO - 🧬 开始处理细胞: GasdE701003
2025-08-22 19:52:15,713 - INFO - 🔄 使用 MPS 并行处理 20 个染色体
2025-08-22 19:52:15,713 - INFO -   ✅ chr1: 已存在，跳过
2025-08-22 19:52:15,714 - INFO -   ✅ chr2: 已存在，跳过
2025-08-22 19:52:15,714 - INFO -   ✅ chr3: 已存在，跳过
2025-08-22 19:52:15,735 - INFO -   ✅ chr4: 已存在，跳过
2025-08-22 19:52:15,735 - INFO -   ✅ chr5: 已存在，跳过
2025-08-22 19:52:15,735 - INFO -   ✅ chr6: 已存在，跳过
2025-08-22 19:52:15,736 - INFO -   ✅ chr7: 已存在，跳过
2025-08-22 19:52:15,736 - INFO -   ✅ chr8: 已存在，跳过
2025-08-22 19:52:15,737 - INFO -   ✅ chr9: 已存在，跳过
2025-08-22 19:52:15,737 - INFO -   ✅ chr10: 已存在，跳过
2025-08-22 19:52:15,737 - INFO -   ✅ chr11: 已存在，跳过
2025-08-22 19:52:15,737 - INFO -   ✅ chr12: 已存在，跳过
2025-08-22 19:52:15,738 - INFO -   ✅ chr13: 已存在，跳过
2025-08-22 19:52:15,739 - INFO - 🔄 MPS 并行处理 7 个染色体
2025-08-22 19:52:16,009 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-22 19:52:16,009 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 19:52:16,016 - INFO -    矩阵大小: (6246, 6246), 非零元素: 20179, 稀疏度: 0.000517
2025-08-22 19:52:16,017 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:52:16,017 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 19:52:16,242 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:52:16,566 - INFO -    卷积耗时: 0.548 秒
2025-08-22 19:52:16,571 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0035)
2025-08-22 19:52:16,571 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 19:52:16,571 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 19:52:16,670 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 19:52:16,928 - INFO - 🔥 MPS Iter 1 takes 0.117 seconds. Loss: 9.554
2025-08-22 19:52:17,377 - INFO - 🔥 MPS Iter 2 takes 0.367 seconds. Loss: 2.077
2025-08-22 19:52:19,042 - INFO - 🔥 MPS Iter 3 takes 0.808 seconds. Loss: 0.641
2025-08-22 19:52:19,818 - INFO - 🔥 MPS Iter 4 takes 2.476 seconds. Loss: 0.236
2025-08-22 19:52:20,590 - INFO - 🔥 MPS Iter 5 takes 3.249 seconds. Loss: 0.103
2025-08-22 19:52:21,360 - INFO - 🔥 MPS Iter 6 takes 4.108 seconds. Loss: 0.048
2025-08-22 19:52:22,178 - INFO - 🔥 MPS Iter 7 takes 4.811 seconds. Loss: 0.024
2025-08-22 19:52:23,072 - INFO - 🔥 MPS Iter 8 takes 5.609 seconds. Loss: 0.012
2025-08-22 19:52:23,930 - INFO - 🔥 MPS Iter 9 takes 6.504 seconds. Loss: 0.006
2025-08-22 19:52:23,931 - INFO - ✅ Converged after 9 iterations
2025-08-22 19:52:23,931 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:52:23,950 - INFO - 🧹 GPU memory cleared
2025-08-22 19:52:25,653 - INFO -    RWR 耗时: 9.087 秒
2025-08-22 19:52:26,591 - INFO -    归一化耗时: 0.937 秒
2025-08-22 19:52:32,328 - INFO -    ✅ 完成，总耗时: 10.572 秒
2025-08-22 19:52:32,336 - INFO -   ✅ chr14: MPS 并行完成，耗时 16.60 秒
2025-08-22 19:52:32,336 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-22 19:52:32,349 - INFO -    矩阵大小: (5203, 5203), 非零元素: 17733, 稀疏度: 0.000655
2025-08-22 19:52:32,350 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:52:32,350 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-22 19:52:32,519 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:52:32,760 - INFO -    卷积耗时: 0.411 秒
2025-08-22 19:52:32,780 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0044)
2025-08-22 19:52:32,780 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-22 19:52:32,781 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-22 19:52:32,880 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-22 19:52:33,029 - INFO - 🔥 MPS Iter 1 takes 0.111 seconds. Loss: 8.268
2025-08-22 19:52:33,173 - INFO - 🔥 MPS Iter 2 takes 0.249 seconds. Loss: 1.632
2025-08-22 19:52:33,349 - INFO - 🔥 MPS Iter 3 takes 0.394 seconds. Loss: 0.424
2025-08-22 19:52:33,883 - INFO - 🔥 MPS Iter 4 takes 0.570 seconds. Loss: 0.119
2025-08-22 19:52:34,776 - INFO - 🔥 MPS Iter 5 takes 1.122 seconds. Loss: 0.039
2025-08-22 19:52:35,413 - INFO - 🔥 MPS Iter 6 takes 1.998 seconds. Loss: 0.013
2025-08-22 19:52:35,907 - INFO - 🔥 MPS Iter 7 takes 2.634 seconds. Loss: 0.005
2025-08-22 19:52:35,908 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:52:35,908 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:52:35,918 - INFO - 🧹 GPU memory cleared
2025-08-22 19:52:36,997 - INFO -    RWR 耗时: 4.235 秒
2025-08-22 19:52:37,717 - INFO -    归一化耗时: 0.720 秒
2025-08-22 19:52:41,668 - INFO -    ✅ 完成，总耗时: 5.365 秒
2025-08-22 19:52:41,673 - INFO -   ✅ chr15: MPS 并行完成，耗时 25.93 秒
2025-08-22 19:52:41,673 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-22 19:52:41,679 - INFO -    矩阵大小: (4911, 4911), 非零元素: 17557, 稀疏度: 0.000728
2025-08-22 19:52:41,679 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:52:41,679 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-22 19:52:41,760 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:52:41,915 - INFO -    卷积耗时: 0.236 秒
2025-08-22 19:52:41,920 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0051)
2025-08-22 19:52:41,920 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-22 19:52:41,920 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-22 19:52:41,998 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-22 19:52:42,130 - INFO - 🔥 MPS Iter 1 takes 0.086 seconds. Loss: 8.105
2025-08-22 19:52:42,262 - INFO - 🔥 MPS Iter 2 takes 0.219 seconds. Loss: 1.620
2025-08-22 19:52:42,399 - INFO - 🔥 MPS Iter 3 takes 0.344 seconds. Loss: 0.424
2025-08-22 19:52:42,585 - INFO - 🔥 MPS Iter 4 takes 0.480 seconds. Loss: 0.119
2025-08-22 19:52:43,390 - INFO - 🔥 MPS Iter 5 takes 0.667 seconds. Loss: 0.038
2025-08-22 19:52:44,044 - INFO - 🔥 MPS Iter 6 takes 1.473 seconds. Loss: 0.013
2025-08-22 19:52:44,464 - INFO - 🔥 MPS Iter 7 takes 2.131 seconds. Loss: 0.005
2025-08-22 19:52:44,465 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:52:44,465 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:52:44,475 - INFO - 🧹 GPU memory cleared
2025-08-22 19:52:45,312 - INFO -    RWR 耗时: 3.396 秒
2025-08-22 19:52:46,047 - INFO -    归一化耗时: 0.734 秒
2025-08-22 19:52:49,746 - INFO -    ✅ 完成，总耗时: 4.366 秒
2025-08-22 19:52:49,753 - INFO -   ✅ chr16: MPS 并行完成，耗时 17.42 秒
2025-08-22 19:52:49,753 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-22 19:52:49,781 - INFO -    矩阵大小: (4750, 4750), 非零元素: 18019, 稀疏度: 0.000799
2025-08-22 19:52:49,782 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:52:49,782 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-22 19:52:49,924 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:52:50,069 - INFO -    卷积耗时: 0.287 秒
2025-08-22 19:52:50,073 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0055)
2025-08-22 19:52:50,073 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-22 19:52:50,073 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-22 19:52:50,157 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-22 19:52:50,269 - INFO - 🔥 MPS Iter 1 takes 0.094 seconds. Loss: 7.517
2025-08-22 19:52:50,368 - INFO - 🔥 MPS Iter 2 takes 0.197 seconds. Loss: 1.456
2025-08-22 19:52:50,476 - INFO - 🔥 MPS Iter 3 takes 0.295 seconds. Loss: 0.370
2025-08-22 19:52:50,601 - INFO - 🔥 MPS Iter 4 takes 0.404 seconds. Loss: 0.101
2025-08-22 19:52:50,775 - INFO - 🔥 MPS Iter 5 takes 0.528 seconds. Loss: 0.031
2025-08-22 19:52:51,238 - INFO - 🔥 MPS Iter 6 takes 0.702 seconds. Loss: 0.010
2025-08-22 19:52:51,812 - INFO - 🔥 MPS Iter 7 takes 1.167 seconds. Loss: 0.004
2025-08-22 19:52:51,813 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:52:51,814 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:52:51,821 - INFO - 🧹 GPU memory cleared
2025-08-22 19:52:52,662 - INFO -    RWR 耗时: 2.592 秒
2025-08-22 19:52:53,496 - INFO -    归一化耗时: 0.834 秒
2025-08-22 19:52:57,097 - INFO -    ✅ 完成，总耗时: 3.713 秒
2025-08-22 19:52:57,101 - INFO -   ✅ chr17: MPS 并行完成，耗时 15.43 秒
2025-08-22 19:52:57,101 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-22 19:52:57,106 - INFO -    矩阵大小: (4536, 4536), 非零元素: 17556, 稀疏度: 0.000853
2025-08-22 19:52:57,106 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:52:57,106 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-22 19:52:57,229 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:52:57,338 - INFO -    卷积耗时: 0.232 秒
2025-08-22 19:52:57,342 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0057)
2025-08-22 19:52:57,342 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-22 19:52:57,342 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-22 19:52:57,540 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-22 19:52:57,647 - INFO - 🔥 MPS Iter 1 takes 0.211 seconds. Loss: 7.129
2025-08-22 19:52:57,747 - INFO - 🔥 MPS Iter 2 takes 0.311 seconds. Loss: 1.312
2025-08-22 19:52:57,845 - INFO - 🔥 MPS Iter 3 takes 0.409 seconds. Loss: 0.317
2025-08-22 19:52:57,954 - INFO - 🔥 MPS Iter 4 takes 0.508 seconds. Loss: 0.084
2025-08-22 19:52:58,074 - INFO - 🔥 MPS Iter 5 takes 0.613 seconds. Loss: 0.026
2025-08-22 19:52:58,275 - INFO - 🔥 MPS Iter 6 takes 0.733 seconds. Loss: 0.009
2025-08-22 19:52:58,277 - INFO - ✅ Converged after 6 iterations
2025-08-22 19:52:58,277 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:52:58,287 - INFO - 🧹 GPU memory cleared
2025-08-22 19:52:59,044 - INFO -    RWR 耗时: 1.705 秒
2025-08-22 19:52:59,767 - INFO -    归一化耗时: 0.723 秒
2025-08-22 19:53:03,230 - INFO -    ✅ 完成，总耗时: 2.660 秒
2025-08-22 19:53:03,235 - INFO -   ✅ chr18: MPS 并行完成，耗时 13.48 秒
2025-08-22 19:53:03,235 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-22 19:53:03,239 - INFO -    矩阵大小: (3072, 3072), 非零元素: 10286, 稀疏度: 0.001090
2025-08-22 19:53:03,240 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:53:03,240 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-22 19:53:03,296 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:53:03,348 - INFO -    卷积耗时: 0.108 秒
2025-08-22 19:53:03,350 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0072)
2025-08-22 19:53:03,350 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-22 19:53:03,350 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-22 19:53:03,432 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-22 19:53:03,473 - INFO - 🔥 MPS Iter 1 takes 0.090 seconds. Loss: 6.329
2025-08-22 19:53:03,500 - INFO - 🔥 MPS Iter 2 takes 0.124 seconds. Loss: 1.252
2025-08-22 19:53:03,527 - INFO - 🔥 MPS Iter 3 takes 0.150 seconds. Loss: 0.319
2025-08-22 19:53:03,555 - INFO - 🔥 MPS Iter 4 takes 0.178 seconds. Loss: 0.087
2025-08-22 19:53:03,582 - INFO - 🔥 MPS Iter 5 takes 0.206 seconds. Loss: 0.027
2025-08-22 19:53:03,610 - INFO - 🔥 MPS Iter 6 takes 0.232 seconds. Loss: 0.009
2025-08-22 19:53:03,610 - INFO - ✅ Converged after 6 iterations
2025-08-22 19:53:03,610 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:53:03,613 - INFO - 🧹 GPU memory cleared
2025-08-22 19:53:03,792 - INFO -    RWR 耗时: 0.444 秒
2025-08-22 19:53:03,972 - INFO -    归一化耗时: 0.180 秒
2025-08-22 19:53:05,175 - INFO -    ✅ 完成，总耗时: 0.732 秒
2025-08-22 19:53:05,177 - INFO -   ✅ chr19: MPS 并行完成，耗时 8.08 秒
2025-08-22 19:53:05,178 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-22 19:53:05,182 - INFO -    矩阵大小: (8552, 8552), 非零元素: 21196, 稀疏度: 0.000290
2025-08-22 19:53:05,183 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:53:05,183 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-22 19:53:05,314 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:53:05,695 - INFO -    卷积耗时: 0.512 秒
2025-08-22 19:53:05,699 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0021)
2025-08-22 19:53:05,699 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-22 19:53:05,699 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-22 19:53:05,840 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-22 19:53:07,718 - INFO - 🔥 MPS Iter 1 takes 0.150 seconds. Loss: 12.257
2025-08-22 19:53:10,485 - INFO - 🔥 MPS Iter 2 takes 2.024 seconds. Loss: 2.989
2025-08-22 19:53:12,401 - INFO - 🔥 MPS Iter 3 takes 4.789 seconds. Loss: 0.994
2025-08-22 19:53:14,492 - INFO - 🔥 MPS Iter 4 takes 6.705 seconds. Loss: 0.373
2025-08-22 19:53:16,273 - INFO - 🔥 MPS Iter 5 takes 8.796 seconds. Loss: 0.158
2025-08-22 19:53:18,340 - INFO - 🔥 MPS Iter 6 takes 10.576 seconds. Loss: 0.070
2025-08-22 19:53:20,336 - INFO - 🔥 MPS Iter 7 takes 12.645 seconds. Loss: 0.032
2025-08-22 19:53:22,198 - INFO - 🔥 MPS Iter 8 takes 14.640 seconds. Loss: 0.015
2025-08-22 19:53:24,263 - INFO - 🔥 MPS Iter 9 takes 16.502 seconds. Loss: 0.007
2025-08-22 19:53:24,266 - INFO - ✅ Converged after 9 iterations
2025-08-22 19:53:24,266 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:53:24,325 - INFO - 🧹 GPU memory cleared
2025-08-22 19:53:26,640 - INFO -    RWR 耗时: 20.944 秒
2025-08-22 19:53:28,644 - INFO -    归一化耗时: 2.004 秒
2025-08-22 19:53:40,954 - INFO -    ✅ 完成，总耗时: 23.460 秒
2025-08-22 19:53:40,965 - INFO -   ✅ chrX: MPS 并行完成，耗时 37.73 秒
2025-08-22 19:53:40,967 - INFO - 🎯 细胞 GasdE701003 完成: 20 成功, 0 失败, 总耗时 1.4 分钟
2025-08-22 19:53:40,967 - INFO - 📦 批次 2 完成，耗时 1.4 分钟
2025-08-22 19:53:40,967 - INFO - 📦 批次 3/557: 处理 1 个细胞
2025-08-22 19:53:40,967 - INFO - 🧬 开始处理细胞: GasdE701004
2025-08-22 19:53:40,967 - INFO - 🔄 使用 MPS 并行处理 20 个染色体
2025-08-22 19:53:40,972 - INFO - 🔄 MPS 并行处理 20 个染色体
2025-08-22 19:53:40,973 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 19:53:40,981 - INFO -    矩阵大小: (9774, 9774), 非零元素: 35412, 稀疏度: 0.000371
2025-08-22 19:53:40,982 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:53:40,983 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-22 19:53:41,508 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:53:42,338 - INFO -    卷积耗时: 1.356 秒
2025-08-22 19:53:42,348 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0027)
2025-08-22 19:53:42,349 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-22 19:53:42,349 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-22 19:53:42,544 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-22 19:53:45,873 - INFO - 🔥 MPS Iter 1 takes 0.215 seconds. Loss: 11.064
2025-08-22 19:53:48,685 - INFO - 🔥 MPS Iter 2 takes 3.530 seconds. Loss: 2.093
2025-08-22 19:53:51,654 - INFO - 🔥 MPS Iter 3 takes 6.341 seconds. Loss: 0.509
2025-08-22 19:53:54,785 - INFO - 🔥 MPS Iter 4 takes 9.321 seconds. Loss: 0.130
2025-08-22 19:53:57,877 - INFO - 🔥 MPS Iter 5 takes 12.439 seconds. Loss: 0.038
2025-08-22 19:54:01,477 - INFO - 🔥 MPS Iter 6 takes 15.667 seconds. Loss: 0.011
2025-08-22 19:54:04,944 - INFO - 🔥 MPS Iter 7 takes 19.167 seconds. Loss: 0.004
2025-08-22 19:54:04,949 - INFO - ✅ Converged after 7 iterations
2025-08-22 19:54:04,949 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:54:05,445 - INFO - 🧹 GPU memory cleared
2025-08-22 19:54:08,979 - INFO -    RWR 耗时: 26.638 秒
2025-08-22 19:54:11,858 - INFO -    归一化耗时: 2.879 秒
2025-08-22 19:56:51,302 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 19:56:51,308 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 19:56:51,308 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 19:56:51,308 - INFO - 🔧 使用 MPS: True
2025-08-22 19:56:51,308 - INFO - 🎯 处理 stages: ['E70']
2025-08-22 19:56:51,308 - INFO - 📦 批处理大小: 1
2025-08-22 19:56:51,341 - ERROR - ❌ 导入 schicluster 失败: No module named 'cooler'
2025-08-22 19:56:51,341 - ERROR - ❌ 环境设置失败
2025-08-22 19:57:04,093 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 19:57:04,093 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 19:57:04,093 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 19:57:04,093 - INFO - 🔧 使用 MPS: True
2025-08-22 19:57:04,093 - INFO - 🎯 处理 stages: ['E70']
2025-08-22 19:57:04,093 - INFO - 📦 批处理大小: 1
2025-08-22 19:57:04,324 - INFO - NumExpr defaulting to 10 threads.
2025-08-22 19:57:06,060 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-22 19:57:06,060 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-22 19:57:06,060 - INFO - 
==================================================
2025-08-22 19:57:06,060 - INFO - 🗂️  开始处理 Stage: E70
2025-08-22 19:57:06,060 - INFO - ==================================================
2025-08-22 19:57:06,113 - INFO - 🗂️  Stage E70: 发现 1 个细胞
2025-08-22 19:57:06,113 - INFO - 📊 Stage E70: 处理细胞 1/1
2025-08-22 19:57:06,119 - INFO - 🧬 开始处理细胞: GasdE701001
2025-08-22 19:57:06,119 - INFO -   ✅ chr1: 已存在，跳过
2025-08-22 19:57:06,120 - INFO -   ✅ chr2: 已存在，跳过
2025-08-22 19:57:06,120 - INFO -   ✅ chr3: 已存在，跳过
2025-08-22 19:57:06,120 - INFO -   ✅ chr4: 已存在，跳过
2025-08-22 19:57:06,121 - INFO -   ✅ chr5: 已存在，跳过
2025-08-22 19:57:06,121 - INFO -   ✅ chr6: 已存在，跳过
2025-08-22 19:57:06,121 - INFO -   ✅ chr7: 已存在，跳过
2025-08-22 19:57:06,122 - INFO -   ✅ chr8: 已存在，跳过
2025-08-22 19:57:06,123 - INFO -   ✅ chr9: 已存在，跳过
2025-08-22 19:57:06,124 - INFO -   ✅ chr10: 已存在，跳过
2025-08-22 19:57:06,125 - INFO -   ✅ chr11: 已存在，跳过
2025-08-22 19:57:06,125 - INFO -   ✅ chr12: 已存在，跳过
2025-08-22 19:57:06,125 - INFO -   ✅ chr13: 已存在，跳过
2025-08-22 19:57:06,126 - INFO -   ✅ chr14: 已存在，跳过
2025-08-22 19:57:06,126 - INFO -   ✅ chr15: 已存在，跳过
2025-08-22 19:57:06,126 - INFO -   ✅ chr16: 已存在，跳过
2025-08-22 19:57:06,127 - INFO -   ✅ chr17: 已存在，跳过
2025-08-22 19:57:06,128 - INFO -   ✅ chr18: 已存在，跳过
2025-08-22 19:57:06,128 - INFO -   ✅ chr19: 已存在，跳过
2025-08-22 19:57:06,129 - INFO -   ✅ chrX: 已存在，跳过
2025-08-22 19:57:06,129 - INFO - 🎯 细胞 GasdE701001 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-22 19:57:06,129 - INFO - 🎊 Stage E70 完成: 20 个矩阵成功, 0 个失败
2025-08-22 19:57:06,129 - INFO -    总耗时: 0.00 小时
2025-08-22 19:57:06,129 - INFO - 
============================================================
2025-08-22 19:57:06,129 - INFO - 🎉 所有 Stage 处理完成!
2025-08-22 19:57:06,129 - INFO - 📊 总计: 20 个矩阵成功, 0 个失败
2025-08-22 19:57:06,129 - INFO - ⏱️  总耗时: 0.00 小时
2025-08-22 19:57:06,129 - INFO - 💡 预计节省时间: 0.0 小时 (相比纯 CPU)
2025-08-22 19:57:06,129 - INFO - 📄 详细日志已保存到: mps_imputation.log
2025-08-22 19:57:45,886 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 19:57:45,886 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 19:57:45,886 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 19:57:45,886 - INFO - 🔧 使用 MPS: True
2025-08-22 19:57:45,886 - INFO - 🎯 处理 stages: ['E75']
2025-08-22 19:57:45,886 - INFO - 📦 批处理大小: 1
2025-08-22 19:57:46,106 - INFO - NumExpr defaulting to 10 threads.
2025-08-22 19:57:47,659 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-22 19:57:47,660 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-22 19:57:47,660 - INFO - 
==================================================
2025-08-22 19:57:47,660 - INFO - 🗂️  开始处理 Stage: E75
2025-08-22 19:57:47,660 - INFO - ==================================================
2025-08-22 19:57:47,793 - INFO - 🗂️  Stage E75: 发现 1 个细胞
2025-08-22 19:57:47,799 - INFO - 📊 Stage E75: 处理细胞 1/1
2025-08-22 19:57:47,800 - INFO - 🧬 开始处理细胞: GasaE751001
2025-08-22 19:57:47,803 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 19:57:47,808 - INFO -    矩阵大小: (9774, 9774), 非零元素: 17530, 稀疏度: 0.000184
2025-08-22 19:57:47,809 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:57:47,809 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-22 19:57:48,307 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:57:48,802 - INFO -    卷积耗时: 0.993 秒
2025-08-22 19:57:48,807 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0014)
2025-08-22 19:57:48,807 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-22 19:57:48,807 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-22 19:57:49,111 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-22 19:57:53,042 - INFO - 🔥 MPS Iter 1 takes 0.332 seconds. Loss: 16.917
2025-08-22 19:57:56,644 - INFO - 🔥 MPS Iter 2 takes 4.263 seconds. Loss: 4.509
2025-08-22 19:58:00,315 - INFO - 🔥 MPS Iter 3 takes 7.842 seconds. Loss: 1.497
2025-08-22 19:58:04,036 - INFO - 🔥 MPS Iter 4 takes 11.516 seconds. Loss: 0.519
2025-08-22 19:58:07,464 - INFO - 🔥 MPS Iter 5 takes 15.233 seconds. Loss: 0.199
2025-08-22 19:58:10,953 - INFO - 🔥 MPS Iter 6 takes 18.893 seconds. Loss: 0.079
2025-08-22 19:58:14,519 - INFO - 🔥 MPS Iter 7 takes 22.151 seconds. Loss: 0.033
2025-08-22 19:58:17,860 - INFO - 🔥 MPS Iter 8 takes 25.714 seconds. Loss: 0.015
2025-08-22 19:58:21,221 - INFO - 🔥 MPS Iter 9 takes 29.057 seconds. Loss: 0.007
2025-08-22 19:58:21,224 - INFO - ✅ Converged after 9 iterations
2025-08-22 19:58:21,224 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:58:21,380 - INFO - 🧹 GPU memory cleared
2025-08-22 19:58:24,547 - INFO -    RWR 耗时: 35.744 秒
2025-08-22 19:58:26,659 - INFO -    归一化耗时: 2.112 秒
2025-08-22 19:59:13,778 - INFO -    ✅ 完成，总耗时: 38.849 秒
2025-08-22 19:59:13,791 - INFO -   ✅ chr1: 完成，耗时 85.99 秒
2025-08-22 19:59:13,792 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 19:59:13,802 - INFO -    矩阵大小: (9106, 9106), 非零元素: 16836, 稀疏度: 0.000203
2025-08-22 19:59:13,803 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 19:59:13,803 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-22 19:59:14,226 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 19:59:14,625 - INFO -    卷积耗时: 0.822 秒
2025-08-22 19:59:14,629 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0015)
2025-08-22 19:59:14,630 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-22 19:59:14,630 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-22 19:59:14,872 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-22 19:59:17,120 - INFO - 🔥 MPS Iter 1 takes 0.260 seconds. Loss: 15.839
2025-08-22 19:59:19,673 - INFO - 🔥 MPS Iter 2 takes 2.495 seconds. Loss: 4.084
2025-08-22 19:59:22,318 - INFO - 🔥 MPS Iter 3 takes 5.052 seconds. Loss: 1.312
2025-08-22 19:59:24,927 - INFO - 🔥 MPS Iter 4 takes 7.692 seconds. Loss: 0.431
2025-08-22 19:59:27,343 - INFO - 🔥 MPS Iter 5 takes 10.300 seconds. Loss: 0.155
2025-08-22 19:59:30,039 - INFO - 🔥 MPS Iter 6 takes 12.720 seconds. Loss: 0.056
2025-08-22 19:59:32,566 - INFO - 🔥 MPS Iter 7 takes 15.413 seconds. Loss: 0.022
2025-08-22 19:59:34,917 - INFO - 🔥 MPS Iter 8 takes 17.938 seconds. Loss: 0.008
2025-08-22 19:59:34,919 - INFO - ✅ Converged after 8 iterations
2025-08-22 19:59:34,919 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 19:59:34,991 - INFO - 🧹 GPU memory cleared
2025-08-22 19:59:37,342 - INFO -    RWR 耗时: 22.716 秒
2025-08-22 19:59:40,075 - INFO -    归一化耗时: 2.733 秒
2025-08-22 20:00:27,056 - INFO -    ✅ 完成，总耗时: 26.271 秒
2025-08-22 20:00:27,072 - INFO -   ✅ chr2: 完成，耗时 73.28 秒
2025-08-22 20:00:27,076 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 20:00:27,095 - INFO -    矩阵大小: (8002, 8002), 非零元素: 12638, 稀疏度: 0.000197
2025-08-22 20:00:27,096 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:00:27,097 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 20:00:27,437 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:00:28,321 - INFO -    卷积耗时: 1.225 秒
2025-08-22 20:00:28,336 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0015)
2025-08-22 20:00:28,336 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 20:00:28,336 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 20:00:28,760 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 20:00:30,626 - INFO - 🔥 MPS Iter 1 takes 0.499 seconds. Loss: 16.133
2025-08-22 20:00:32,952 - INFO - 🔥 MPS Iter 2 takes 2.298 seconds. Loss: 4.450
2025-08-22 20:00:34,676 - INFO - 🔥 MPS Iter 3 takes 4.649 seconds. Loss: 1.494
2025-08-22 20:00:36,567 - INFO - 🔥 MPS Iter 4 takes 6.355 seconds. Loss: 0.513
2025-08-22 20:00:38,514 - INFO - 🔥 MPS Iter 5 takes 8.234 seconds. Loss: 0.191
2025-08-22 20:00:40,295 - INFO - 🔥 MPS Iter 6 takes 10.182 seconds. Loss: 0.072
2025-08-22 20:00:42,236 - INFO - 🔥 MPS Iter 7 takes 11.965 seconds. Loss: 0.029
2025-08-22 20:00:44,211 - INFO - 🔥 MPS Iter 8 takes 13.904 seconds. Loss: 0.012
2025-08-22 20:00:46,025 - INFO - 🔥 MPS Iter 9 takes 15.879 seconds. Loss: 0.005
2025-08-22 20:00:46,027 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:00:46,027 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:00:46,092 - INFO - 🧹 GPU memory cleared
2025-08-22 20:00:49,428 - INFO -    RWR 耗时: 21.104 秒
2025-08-22 20:00:51,496 - INFO -    归一化耗时: 2.067 秒
2025-08-22 20:01:05,244 - INFO -    ✅ 完成，总耗时: 24.396 秒
2025-08-22 20:01:05,258 - INFO -   ✅ chr3: 完成，耗时 38.18 秒
2025-08-22 20:01:05,259 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 20:01:05,272 - INFO -    矩阵大小: (7826, 7826), 非零元素: 13726, 稀疏度: 0.000224
2025-08-22 20:01:05,273 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:01:05,274 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 20:01:06,097 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:01:06,558 - INFO -    卷积耗时: 1.284 秒
2025-08-22 20:01:06,565 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0016)
2025-08-22 20:01:06,565 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 20:01:06,565 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 20:01:06,712 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 20:01:07,810 - INFO - 🔥 MPS Iter 1 takes 0.166 seconds. Loss: 15.136
2025-08-22 20:01:10,184 - INFO - 🔥 MPS Iter 2 takes 1.249 seconds. Loss: 4.123
2025-08-22 20:01:11,781 - INFO - 🔥 MPS Iter 3 takes 3.622 seconds. Loss: 1.399
2025-08-22 20:01:13,728 - INFO - 🔥 MPS Iter 4 takes 5.220 seconds. Loss: 0.491
2025-08-22 20:01:15,528 - INFO - 🔥 MPS Iter 5 takes 7.202 seconds. Loss: 0.187
2025-08-22 20:01:17,312 - INFO - 🔥 MPS Iter 6 takes 8.968 seconds. Loss: 0.073
2025-08-22 20:01:19,126 - INFO - 🔥 MPS Iter 7 takes 10.750 seconds. Loss: 0.030
2025-08-22 20:01:20,830 - INFO - 🔥 MPS Iter 8 takes 12.565 seconds. Loss: 0.012
2025-08-22 20:01:22,626 - INFO - 🔥 MPS Iter 9 takes 14.268 seconds. Loss: 0.005
2025-08-22 20:01:22,631 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:01:22,632 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:01:22,760 - INFO - 🧹 GPU memory cleared
2025-08-22 20:01:25,355 - INFO -    RWR 耗时: 18.796 秒
2025-08-22 20:01:27,017 - INFO -    归一化耗时: 1.662 秒
2025-08-22 20:01:37,504 - INFO -    ✅ 完成，总耗时: 21.742 秒
2025-08-22 20:01:37,511 - INFO -   ✅ chr4: 完成，耗时 32.25 秒
2025-08-22 20:01:37,512 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 20:01:37,523 - INFO -    矩阵大小: (7592, 7592), 非零元素: 14062, 稀疏度: 0.000244
2025-08-22 20:01:37,525 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:01:37,525 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 20:01:37,919 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:01:38,253 - INFO -    卷积耗时: 0.729 秒
2025-08-22 20:01:38,260 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0018)
2025-08-22 20:01:38,261 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 20:01:38,261 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 20:01:38,369 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 20:01:39,363 - INFO - 🔥 MPS Iter 1 takes 0.126 seconds. Loss: 14.574
2025-08-22 20:01:41,406 - INFO - 🔥 MPS Iter 2 takes 1.105 seconds. Loss: 3.892
2025-08-22 20:01:43,092 - INFO - 🔥 MPS Iter 3 takes 3.148 seconds. Loss: 1.288
2025-08-22 20:01:44,650 - INFO - 🔥 MPS Iter 4 takes 4.833 seconds. Loss: 0.437
2025-08-22 20:01:46,169 - INFO - 🔥 MPS Iter 5 takes 6.392 seconds. Loss: 0.161
2025-08-22 20:01:47,750 - INFO - 🔥 MPS Iter 6 takes 7.916 seconds. Loss: 0.059
2025-08-22 20:01:49,322 - INFO - 🔥 MPS Iter 7 takes 9.494 seconds. Loss: 0.023
2025-08-22 20:01:50,769 - INFO - 🔥 MPS Iter 8 takes 11.064 seconds. Loss: 0.009
2025-08-22 20:01:50,770 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:01:50,771 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:01:50,814 - INFO - 🧹 GPU memory cleared
2025-08-22 20:01:52,933 - INFO -    RWR 耗时: 14.677 秒
2025-08-22 20:01:54,507 - INFO -    归一化耗时: 1.573 秒
2025-08-22 20:02:03,812 - INFO -    ✅ 完成，总耗时: 16.980 秒
2025-08-22 20:02:03,821 - INFO -   ✅ chr5: 完成，耗时 26.31 秒
2025-08-22 20:02:03,822 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-22 20:02:03,828 - INFO -    矩阵大小: (7487, 7487), 非零元素: 13328, 稀疏度: 0.000238
2025-08-22 20:02:03,829 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:02:03,829 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-22 20:02:03,958 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:02:04,275 - INFO -    卷积耗时: 0.446 秒
2025-08-22 20:02:04,279 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0018)
2025-08-22 20:02:04,279 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-22 20:02:04,279 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-22 20:02:04,375 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-22 20:02:04,870 - INFO - 🔥 MPS Iter 1 takes 0.110 seconds. Loss: 14.844
2025-08-22 20:02:06,862 - INFO - 🔥 MPS Iter 2 takes 0.596 seconds. Loss: 3.941
2025-08-22 20:02:08,502 - INFO - 🔥 MPS Iter 3 takes 2.586 seconds. Loss: 1.292
2025-08-22 20:02:09,971 - INFO - 🔥 MPS Iter 4 takes 4.227 seconds. Loss: 0.434
2025-08-22 20:02:11,357 - INFO - 🔥 MPS Iter 5 takes 5.695 seconds. Loss: 0.158
2025-08-22 20:02:12,850 - INFO - 🔥 MPS Iter 6 takes 7.080 seconds. Loss: 0.058
2025-08-22 20:02:14,341 - INFO - 🔥 MPS Iter 7 takes 8.573 seconds. Loss: 0.023
2025-08-22 20:02:15,710 - INFO - 🔥 MPS Iter 8 takes 10.065 seconds. Loss: 0.009
2025-08-22 20:02:15,712 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:02:15,712 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:02:15,778 - INFO - 🧹 GPU memory cleared
2025-08-22 20:02:17,626 - INFO -    RWR 耗时: 13.349 秒
2025-08-22 20:02:19,182 - INFO -    归一化耗时: 1.556 秒
2025-08-22 20:02:28,698 - INFO -    ✅ 完成，总耗时: 15.351 秒
2025-08-22 20:02:28,711 - INFO -   ✅ chr6: 完成，耗时 24.89 秒
2025-08-22 20:02:28,712 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-22 20:02:28,718 - INFO -    矩阵大小: (7273, 7273), 非零元素: 13329, 稀疏度: 0.000252
2025-08-22 20:02:28,719 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:02:28,719 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-22 20:02:28,863 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:02:29,196 - INFO -    卷积耗时: 0.477 秒
2025-08-22 20:02:29,200 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0019)
2025-08-22 20:02:29,200 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-22 20:02:29,200 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-22 20:02:29,304 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-22 20:02:29,801 - INFO - 🔥 MPS Iter 1 takes 0.120 seconds. Loss: 13.728
2025-08-22 20:02:31,458 - INFO - 🔥 MPS Iter 2 takes 0.603 seconds. Loss: 3.612
2025-08-22 20:02:32,997 - INFO - 🔥 MPS Iter 3 takes 2.261 seconds. Loss: 1.195
2025-08-22 20:02:34,327 - INFO - 🔥 MPS Iter 4 takes 3.801 seconds. Loss: 0.413
2025-08-22 20:02:35,635 - INFO - 🔥 MPS Iter 5 takes 5.129 seconds. Loss: 0.157
2025-08-22 20:02:37,022 - INFO - 🔥 MPS Iter 6 takes 6.438 seconds. Loss: 0.061
2025-08-22 20:02:38,451 - INFO - 🔥 MPS Iter 7 takes 7.825 seconds. Loss: 0.025
2025-08-22 20:02:39,831 - INFO - 🔥 MPS Iter 8 takes 9.254 seconds. Loss: 0.010
2025-08-22 20:02:41,198 - INFO - 🔥 MPS Iter 9 takes 10.636 seconds. Loss: 0.005
2025-08-22 20:02:41,200 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:02:41,200 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:02:41,253 - INFO - 🧹 GPU memory cleared
2025-08-22 20:02:43,439 - INFO -    RWR 耗时: 14.242 秒
2025-08-22 20:02:44,805 - INFO -    归一化耗时: 1.366 秒
2025-08-22 20:02:52,586 - INFO -    ✅ 完成，总耗时: 16.084 秒
2025-08-22 20:02:52,592 - INFO -   ✅ chr7: 完成，耗时 23.88 秒
2025-08-22 20:02:52,593 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-22 20:02:52,618 - INFO -    矩阵大小: (6471, 6471), 非零元素: 11816, 稀疏度: 0.000282
2025-08-22 20:02:52,619 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:02:52,619 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-22 20:02:52,811 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:02:53,063 - INFO -    卷积耗时: 0.444 秒
2025-08-22 20:02:53,067 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0021)
2025-08-22 20:02:53,067 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-22 20:02:53,068 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-22 20:02:53,161 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-22 20:02:53,468 - INFO - 🔥 MPS Iter 1 takes 0.112 seconds. Loss: 13.354
2025-08-22 20:02:54,119 - INFO - 🔥 MPS Iter 2 takes 0.403 seconds. Loss: 3.423
2025-08-22 20:02:55,702 - INFO - 🔥 MPS Iter 3 takes 1.055 seconds. Loss: 1.098
2025-08-22 20:02:56,767 - INFO - 🔥 MPS Iter 4 takes 2.639 seconds. Loss: 0.360
2025-08-22 20:02:57,693 - INFO - 🔥 MPS Iter 5 takes 3.701 seconds. Loss: 0.130
2025-08-22 20:02:58,592 - INFO - 🔥 MPS Iter 6 takes 4.627 seconds. Loss: 0.048
2025-08-22 20:02:59,510 - INFO - 🔥 MPS Iter 7 takes 5.529 seconds. Loss: 0.019
2025-08-22 20:03:00,393 - INFO - 🔥 MPS Iter 8 takes 6.445 seconds. Loss: 0.007
2025-08-22 20:03:00,395 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:03:00,395 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:03:00,431 - INFO - 🧹 GPU memory cleared
2025-08-22 20:03:01,766 - INFO -    RWR 耗时: 8.701 秒
2025-08-22 20:03:02,930 - INFO -    归一化耗时: 1.164 秒
2025-08-22 20:03:08,879 - INFO -    ✅ 完成，总耗时: 10.309 秒
2025-08-22 20:03:08,888 - INFO -   ✅ chr8: 完成，耗时 16.30 秒
2025-08-22 20:03:08,889 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-22 20:03:08,895 - INFO -    矩阵大小: (6230, 6230), 非零元素: 12717, 稀疏度: 0.000328
2025-08-22 20:03:08,895 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:03:08,895 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-22 20:03:08,971 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:03:09,135 - INFO -    卷积耗时: 0.240 秒
2025-08-22 20:03:09,139 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0024)
2025-08-22 20:03:09,139 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-22 20:03:09,139 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-22 20:03:09,226 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-22 20:03:09,459 - INFO - 🔥 MPS Iter 1 takes 0.096 seconds. Loss: 12.593
2025-08-22 20:03:09,765 - INFO - 🔥 MPS Iter 2 takes 0.321 seconds. Loss: 3.157
2025-08-22 20:03:10,688 - INFO - 🔥 MPS Iter 3 takes 0.627 seconds. Loss: 0.985
2025-08-22 20:03:11,919 - INFO - 🔥 MPS Iter 4 takes 1.555 seconds. Loss: 0.314
2025-08-22 20:03:12,909 - INFO - 🔥 MPS Iter 5 takes 2.783 seconds. Loss: 0.110
2025-08-22 20:03:13,786 - INFO - 🔥 MPS Iter 6 takes 3.771 seconds. Loss: 0.039
2025-08-22 20:03:14,509 - INFO - 🔥 MPS Iter 7 takes 4.649 seconds. Loss: 0.014
2025-08-22 20:03:15,151 - INFO - 🔥 MPS Iter 8 takes 5.371 seconds. Loss: 0.005
2025-08-22 20:03:15,151 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:03:15,152 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:03:15,163 - INFO - 🧹 GPU memory cleared
2025-08-22 20:03:16,122 - INFO -    RWR 耗时: 6.986 秒
2025-08-22 20:03:16,993 - INFO -    归一化耗时: 0.871 秒
2025-08-22 20:03:22,015 - INFO -    ✅ 完成，总耗时: 8.096 秒
2025-08-22 20:03:22,019 - INFO -   ✅ chr9: 完成，耗时 13.13 秒
2025-08-22 20:03:22,020 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-22 20:03:22,024 - INFO -    矩阵大小: (6535, 6535), 非零元素: 10803, 稀疏度: 0.000253
2025-08-22 20:03:22,024 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:03:22,024 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-22 20:03:22,124 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:03:22,318 - INFO -    卷积耗时: 0.294 秒
2025-08-22 20:03:22,321 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0019)
2025-08-22 20:03:22,321 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-22 20:03:22,321 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-22 20:03:22,400 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-22 20:03:22,749 - INFO - 🔥 MPS Iter 1 takes 0.091 seconds. Loss: 14.153
2025-08-22 20:03:23,814 - INFO - 🔥 MPS Iter 2 takes 0.429 seconds. Loss: 3.790
2025-08-22 20:03:25,169 - INFO - 🔥 MPS Iter 3 takes 1.500 seconds. Loss: 1.242
2025-08-22 20:03:26,062 - INFO - 🔥 MPS Iter 4 takes 2.850 seconds. Loss: 0.416
2025-08-22 20:03:26,882 - INFO - 🔥 MPS Iter 5 takes 3.742 seconds. Loss: 0.152
2025-08-22 20:03:27,884 - INFO - 🔥 MPS Iter 6 takes 4.563 seconds. Loss: 0.056
2025-08-22 20:03:29,035 - INFO - 🔥 MPS Iter 7 takes 5.568 seconds. Loss: 0.022
2025-08-22 20:03:29,894 - INFO - 🔥 MPS Iter 8 takes 6.717 seconds. Loss: 0.009
2025-08-22 20:03:29,895 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:03:29,895 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:03:29,909 - INFO - 🧹 GPU memory cleared
2025-08-22 20:03:30,861 - INFO -    RWR 耗时: 8.542 秒
2025-08-22 20:03:31,687 - INFO -    归一化耗时: 0.826 秒
2025-08-22 20:03:36,814 - INFO -    ✅ 完成，总耗时: 9.662 秒
2025-08-22 20:03:36,820 - INFO -   ✅ chr10: 完成，耗时 14.80 秒
2025-08-22 20:03:36,821 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-22 20:03:36,824 - INFO -    矩阵大小: (6105, 6105), 非零元素: 12159, 稀疏度: 0.000326
2025-08-22 20:03:36,825 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:03:36,826 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-22 20:03:36,939 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:03:37,120 - INFO -    卷积耗时: 0.295 秒
2025-08-22 20:03:37,123 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0023)
2025-08-22 20:03:37,123 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-22 20:03:37,123 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-22 20:03:37,187 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-22 20:03:37,435 - INFO - 🔥 MPS Iter 1 takes 0.072 seconds. Loss: 12.417
2025-08-22 20:03:37,789 - INFO - 🔥 MPS Iter 2 takes 0.313 seconds. Loss: 3.094
2025-08-22 20:03:38,925 - INFO - 🔥 MPS Iter 3 takes 0.667 seconds. Loss: 0.965
2025-08-22 20:03:40,118 - INFO - 🔥 MPS Iter 4 takes 1.804 seconds. Loss: 0.314
2025-08-22 20:03:40,925 - INFO - 🔥 MPS Iter 5 takes 2.998 seconds. Loss: 0.113
2025-08-22 20:03:41,587 - INFO - 🔥 MPS Iter 6 takes 3.803 seconds. Loss: 0.042
2025-08-22 20:03:42,269 - INFO - 🔥 MPS Iter 7 takes 4.465 seconds. Loss: 0.017
2025-08-22 20:03:42,950 - INFO - 🔥 MPS Iter 8 takes 5.147 seconds. Loss: 0.007
2025-08-22 20:03:42,952 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:03:42,952 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:03:42,993 - INFO - 🧹 GPU memory cleared
2025-08-22 20:03:44,075 - INFO -    RWR 耗时: 6.954 秒
2025-08-22 20:03:45,043 - INFO -    归一化耗时: 0.967 秒
2025-08-22 20:03:51,635 - INFO -    ✅ 完成，总耗时: 8.216 秒
2025-08-22 20:03:51,642 - INFO -   ✅ chr11: 完成，耗时 14.82 秒
2025-08-22 20:03:51,643 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-22 20:03:51,648 - INFO -    矩阵大小: (6007, 6007), 非零元素: 9748, 稀疏度: 0.000270
2025-08-22 20:03:51,649 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:03:51,649 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-22 20:03:51,794 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:03:51,952 - INFO -    卷积耗时: 0.304 秒
2025-08-22 20:03:51,955 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0020)
2025-08-22 20:03:51,955 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-22 20:03:51,955 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-22 20:03:52,036 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-22 20:03:52,266 - INFO - 🔥 MPS Iter 1 takes 0.090 seconds. Loss: 13.709
2025-08-22 20:03:52,721 - INFO - 🔥 MPS Iter 2 takes 0.312 seconds. Loss: 3.768
2025-08-22 20:03:53,134 - INFO - 🔥 MPS Iter 3 takes 0.768 seconds. Loss: 1.295
2025-08-22 20:03:54,268 - INFO - 🔥 MPS Iter 4 takes 1.181 seconds. Loss: 0.464
2025-08-22 20:03:55,215 - INFO - 🔥 MPS Iter 5 takes 2.315 seconds. Loss: 0.184
2025-08-22 20:03:56,136 - INFO - 🔥 MPS Iter 6 takes 3.262 seconds. Loss: 0.076
2025-08-22 20:03:56,988 - INFO - 🔥 MPS Iter 7 takes 4.208 seconds. Loss: 0.033
2025-08-22 20:03:57,852 - INFO - 🔥 MPS Iter 8 takes 5.063 seconds. Loss: 0.015
2025-08-22 20:03:58,666 - INFO - 🔥 MPS Iter 9 takes 5.901 seconds. Loss: 0.007
2025-08-22 20:03:58,668 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:03:58,669 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:03:58,803 - INFO - 🧹 GPU memory cleared
2025-08-22 20:04:00,717 - INFO -    RWR 耗时: 8.764 秒
2025-08-22 20:04:02,346 - INFO -    归一化耗时: 1.629 秒
2025-08-22 20:04:09,021 - INFO -    ✅ 完成，总耗时: 10.696 秒
2025-08-22 20:04:09,027 - INFO -   ✅ chr12: 完成，耗时 17.38 秒
2025-08-22 20:04:09,028 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-22 20:04:09,036 - INFO -    矩阵大小: (6022, 6022), 非零元素: 10218, 稀疏度: 0.000282
2025-08-22 20:04:09,037 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:04:09,037 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-22 20:04:09,204 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:04:09,378 - INFO -    卷积耗时: 0.341 秒
2025-08-22 20:04:09,381 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0021)
2025-08-22 20:04:09,381 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-22 20:04:09,381 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-22 20:04:09,457 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-22 20:04:09,667 - INFO - 🔥 MPS Iter 1 takes 0.087 seconds. Loss: 13.471
2025-08-22 20:04:09,981 - INFO - 🔥 MPS Iter 2 takes 0.288 seconds. Loss: 3.646
2025-08-22 20:04:10,621 - INFO - 🔥 MPS Iter 3 takes 0.601 seconds. Loss: 1.231
2025-08-22 20:04:11,888 - INFO - 🔥 MPS Iter 4 takes 1.242 seconds. Loss: 0.435
2025-08-22 20:04:12,867 - INFO - 🔥 MPS Iter 5 takes 2.513 seconds. Loss: 0.170
2025-08-22 20:04:13,811 - INFO - 🔥 MPS Iter 6 takes 3.490 seconds. Loss: 0.069
2025-08-22 20:04:14,599 - INFO - 🔥 MPS Iter 7 takes 4.437 seconds. Loss: 0.029
2025-08-22 20:04:15,348 - INFO - 🔥 MPS Iter 8 takes 5.225 seconds. Loss: 0.013
2025-08-22 20:04:16,023 - INFO - 🔥 MPS Iter 9 takes 5.969 seconds. Loss: 0.006
2025-08-22 20:04:16,023 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:04:16,024 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:04:16,078 - INFO - 🧹 GPU memory cleared
2025-08-22 20:04:17,221 - INFO -    RWR 耗时: 7.842 秒
2025-08-22 20:04:18,157 - INFO -    归一化耗时: 0.935 秒
2025-08-22 20:04:23,359 - INFO -    ✅ 完成，总耗时: 9.119 秒
2025-08-22 20:04:23,365 - INFO -   ✅ chr13: 完成，耗时 14.34 秒
2025-08-22 20:04:23,367 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 20:04:23,371 - INFO -    矩阵大小: (6246, 6246), 非零元素: 9540, 稀疏度: 0.000245
2025-08-22 20:04:23,371 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:04:23,372 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 20:04:23,612 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:04:23,790 - INFO -    卷积耗时: 0.418 秒
2025-08-22 20:04:23,792 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0018)
2025-08-22 20:04:23,792 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 20:04:23,792 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 20:04:23,929 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 20:04:24,188 - INFO - 🔥 MPS Iter 1 takes 0.157 seconds. Loss: 13.871
2025-08-22 20:04:24,635 - INFO - 🔥 MPS Iter 2 takes 0.398 seconds. Loss: 3.824
2025-08-22 20:04:25,965 - INFO - 🔥 MPS Iter 3 takes 0.843 seconds. Loss: 1.306
2025-08-22 20:04:27,030 - INFO - 🔥 MPS Iter 4 takes 2.175 seconds. Loss: 0.457
2025-08-22 20:04:27,824 - INFO - 🔥 MPS Iter 5 takes 3.240 seconds. Loss: 0.173
2025-08-22 20:04:28,576 - INFO - 🔥 MPS Iter 6 takes 4.038 seconds. Loss: 0.066
2025-08-22 20:04:29,386 - INFO - 🔥 MPS Iter 7 takes 4.796 seconds. Loss: 0.026
2025-08-22 20:04:30,247 - INFO - 🔥 MPS Iter 8 takes 5.598 seconds. Loss: 0.011
2025-08-22 20:04:31,063 - INFO - 🔥 MPS Iter 9 takes 6.456 seconds. Loss: 0.004
2025-08-22 20:04:31,064 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:04:31,064 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:04:31,098 - INFO - 🧹 GPU memory cleared
2025-08-22 20:04:32,334 - INFO -    RWR 耗时: 8.544 秒
2025-08-22 20:04:33,176 - INFO -    归一化耗时: 0.842 秒
2025-08-22 20:04:37,511 - INFO -    ✅ 完成，总耗时: 9.804 秒
2025-08-22 20:04:37,516 - INFO -   ✅ chr14: 完成，耗时 14.15 秒
2025-08-22 20:04:37,517 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-22 20:04:37,523 - INFO -    矩阵大小: (5203, 5203), 非零元素: 9255, 稀疏度: 0.000342
2025-08-22 20:04:37,523 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:04:37,523 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-22 20:04:37,628 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:04:37,744 - INFO -    卷积耗时: 0.221 秒
2025-08-22 20:04:37,747 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0025)
2025-08-22 20:04:37,747 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-22 20:04:37,747 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-22 20:04:37,802 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-22 20:04:37,936 - INFO - 🔥 MPS Iter 1 takes 0.061 seconds. Loss: 12.205
2025-08-22 20:04:38,075 - INFO - 🔥 MPS Iter 2 takes 0.191 seconds. Loss: 3.206
2025-08-22 20:04:38,251 - INFO - 🔥 MPS Iter 3 takes 0.329 seconds. Loss: 1.043
2025-08-22 20:04:38,482 - INFO - 🔥 MPS Iter 4 takes 0.505 seconds. Loss: 0.347
2025-08-22 20:04:39,026 - INFO - 🔥 MPS Iter 5 takes 0.736 seconds. Loss: 0.126
2025-08-22 20:04:39,703 - INFO - 🔥 MPS Iter 6 takes 1.280 seconds. Loss: 0.046
2025-08-22 20:04:40,319 - INFO - 🔥 MPS Iter 7 takes 1.958 seconds. Loss: 0.018
2025-08-22 20:04:40,842 - INFO - 🔥 MPS Iter 8 takes 2.574 seconds. Loss: 0.007
2025-08-22 20:04:40,842 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:04:40,843 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:04:40,849 - INFO - 🧹 GPU memory cleared
2025-08-22 20:04:41,645 - INFO -    RWR 耗时: 3.900 秒
2025-08-22 20:04:42,352 - INFO -    归一化耗时: 0.707 秒
2025-08-22 20:04:45,676 - INFO -    ✅ 完成，总耗时: 4.828 秒
2025-08-22 20:04:45,679 - INFO -   ✅ chr15: 完成，耗时 8.16 秒
2025-08-22 20:04:45,680 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-22 20:04:45,683 - INFO -    矩阵大小: (4911, 4911), 非零元素: 8069, 稀疏度: 0.000335
2025-08-22 20:04:45,683 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:04:45,683 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-22 20:04:45,745 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:04:45,846 - INFO -    卷积耗时: 0.163 秒
2025-08-22 20:04:45,848 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0025)
2025-08-22 20:04:45,848 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-22 20:04:45,848 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-22 20:04:45,930 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-22 20:04:46,055 - INFO - 🔥 MPS Iter 1 takes 0.088 seconds. Loss: 12.272
2025-08-22 20:04:46,173 - INFO - 🔥 MPS Iter 2 takes 0.209 seconds. Loss: 3.305
2025-08-22 20:04:46,302 - INFO - 🔥 MPS Iter 3 takes 0.326 seconds. Loss: 1.086
2025-08-22 20:04:46,447 - INFO - 🔥 MPS Iter 4 takes 0.455 seconds. Loss: 0.364
2025-08-22 20:04:46,659 - INFO - 🔥 MPS Iter 5 takes 0.600 seconds. Loss: 0.132
2025-08-22 20:04:47,110 - INFO - 🔥 MPS Iter 6 takes 0.812 seconds. Loss: 0.048
2025-08-22 20:04:47,667 - INFO - 🔥 MPS Iter 7 takes 1.263 seconds. Loss: 0.018
2025-08-22 20:04:48,177 - INFO - 🔥 MPS Iter 8 takes 1.820 seconds. Loss: 0.007
2025-08-22 20:04:48,178 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:04:48,178 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:04:48,186 - INFO - 🧹 GPU memory cleared
2025-08-22 20:04:48,751 - INFO -    RWR 耗时: 2.905 秒
2025-08-22 20:04:49,345 - INFO -    归一化耗时: 0.594 秒
2025-08-22 20:04:52,393 - INFO -    ✅ 完成，总耗时: 3.661 秒
2025-08-22 20:04:52,397 - INFO -   ✅ chr16: 完成，耗时 6.72 秒
2025-08-22 20:04:52,397 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-22 20:04:52,401 - INFO -    矩阵大小: (4750, 4750), 非零元素: 8319, 稀疏度: 0.000369
2025-08-22 20:04:52,401 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:04:52,401 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-22 20:04:52,463 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:04:52,558 - INFO -    卷积耗时: 0.157 秒
2025-08-22 20:04:52,560 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0027)
2025-08-22 20:04:52,560 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-22 20:04:52,560 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-22 20:04:52,616 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-22 20:04:52,725 - INFO - 🔥 MPS Iter 1 takes 0.062 seconds. Loss: 11.616
2025-08-22 20:04:52,826 - INFO - 🔥 MPS Iter 2 takes 0.166 seconds. Loss: 3.032
2025-08-22 20:04:52,938 - INFO - 🔥 MPS Iter 3 takes 0.267 seconds. Loss: 0.979
2025-08-22 20:04:53,063 - INFO - 🔥 MPS Iter 4 takes 0.379 seconds. Loss: 0.323
2025-08-22 20:04:53,227 - INFO - 🔥 MPS Iter 5 takes 0.504 seconds. Loss: 0.116
2025-08-22 20:04:53,512 - INFO - 🔥 MPS Iter 6 takes 0.668 seconds. Loss: 0.042
2025-08-22 20:04:53,943 - INFO - 🔥 MPS Iter 7 takes 0.953 seconds. Loss: 0.016
2025-08-22 20:04:54,344 - INFO - 🔥 MPS Iter 8 takes 1.385 seconds. Loss: 0.006
2025-08-22 20:04:54,345 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:04:54,345 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:04:54,352 - INFO - 🧹 GPU memory cleared
2025-08-22 20:04:54,852 - INFO -    RWR 耗时: 2.294 秒
2025-08-22 20:04:55,426 - INFO -    归一化耗时: 0.574 秒
2025-08-22 20:04:58,230 - INFO -    ✅ 完成，总耗时: 3.024 秒
2025-08-22 20:04:58,233 - INFO -   ✅ chr17: 完成，耗时 5.84 秒
2025-08-22 20:04:58,234 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-22 20:04:58,237 - INFO -    矩阵大小: (4536, 4536), 非零元素: 7883, 稀疏度: 0.000383
2025-08-22 20:04:58,237 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:04:58,237 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-22 20:04:58,297 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:04:58,381 - INFO -    卷积耗时: 0.144 秒
2025-08-22 20:04:58,383 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0028)
2025-08-22 20:04:58,383 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-22 20:04:58,383 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-22 20:04:58,475 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-22 20:04:58,573 - INFO - 🔥 MPS Iter 1 takes 0.098 seconds. Loss: 11.471
2025-08-22 20:04:58,663 - INFO - 🔥 MPS Iter 2 takes 0.191 seconds. Loss: 2.970
2025-08-22 20:04:58,752 - INFO - 🔥 MPS Iter 3 takes 0.281 seconds. Loss: 0.950
2025-08-22 20:04:58,850 - INFO - 🔥 MPS Iter 4 takes 0.370 seconds. Loss: 0.309
2025-08-22 20:04:58,959 - INFO - 🔥 MPS Iter 5 takes 0.467 seconds. Loss: 0.110
2025-08-22 20:04:59,093 - INFO - 🔥 MPS Iter 6 takes 0.577 seconds. Loss: 0.040
2025-08-22 20:04:59,311 - INFO - 🔥 MPS Iter 7 takes 0.711 seconds. Loss: 0.016
2025-08-22 20:04:59,681 - INFO - 🔥 MPS Iter 8 takes 0.929 seconds. Loss: 0.006
2025-08-22 20:04:59,681 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:04:59,681 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:04:59,688 - INFO - 🧹 GPU memory cleared
2025-08-22 20:05:00,192 - INFO -    RWR 耗时: 1.811 秒
2025-08-22 20:05:00,770 - INFO -    归一化耗时: 0.578 秒
2025-08-22 20:05:03,479 - INFO -    ✅ 完成，总耗时: 2.532 秒
2025-08-22 20:05:03,483 - INFO -   ✅ chr18: 完成，耗时 5.25 秒
2025-08-22 20:05:03,484 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-22 20:05:03,487 - INFO -    矩阵大小: (3072, 3072), 非零元素: 5535, 稀疏度: 0.000587
2025-08-22 20:05:03,487 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:05:03,487 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-22 20:05:03,546 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:05:03,588 - INFO -    卷积耗时: 0.101 秒
2025-08-22 20:05:03,590 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0042)
2025-08-22 20:05:03,590 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-22 20:05:03,590 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-22 20:05:03,705 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-22 20:05:03,742 - INFO - 🔥 MPS Iter 1 takes 0.122 seconds. Loss: 9.124
2025-08-22 20:05:03,769 - INFO - 🔥 MPS Iter 2 takes 0.153 seconds. Loss: 2.389
2025-08-22 20:05:03,797 - INFO - 🔥 MPS Iter 3 takes 0.180 seconds. Loss: 0.793
2025-08-22 20:05:03,824 - INFO - 🔥 MPS Iter 4 takes 0.208 seconds. Loss: 0.281
2025-08-22 20:05:03,851 - INFO - 🔥 MPS Iter 5 takes 0.235 seconds. Loss: 0.112
2025-08-22 20:05:03,878 - INFO - 🔥 MPS Iter 6 takes 0.262 seconds. Loss: 0.047
2025-08-22 20:05:03,906 - INFO - 🔥 MPS Iter 7 takes 0.289 seconds. Loss: 0.021
2025-08-22 20:05:03,933 - INFO - 🔥 MPS Iter 8 takes 0.316 seconds. Loss: 0.009
2025-08-22 20:05:03,934 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:05:03,934 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:05:03,936 - INFO - 🧹 GPU memory cleared
2025-08-22 20:05:04,099 - INFO -    RWR 耗时: 0.511 秒
2025-08-22 20:05:04,269 - INFO -    归一化耗时: 0.170 秒
2025-08-22 20:05:05,526 - INFO -    ✅ 完成，总耗时: 0.781 秒
2025-08-22 20:05:05,533 - INFO -   ✅ chr19: 完成，耗时 2.05 秒
2025-08-22 20:05:05,533 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-22 20:05:05,536 - INFO -    矩阵大小: (8552, 8552), 非零元素: 4558, 稀疏度: 0.000062
2025-08-22 20:05:05,537 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:05:05,537 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-22 20:05:05,678 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:05:06,064 - INFO -    卷积耗时: 0.527 秒
2025-08-22 20:05:06,066 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0005)
2025-08-22 20:05:06,066 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-22 20:05:06,066 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-22 20:05:06,244 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-22 20:05:07,360 - INFO - 🔥 MPS Iter 1 takes 0.192 seconds. Loss: 21.414
2025-08-22 20:05:09,681 - INFO - 🔥 MPS Iter 2 takes 1.296 seconds. Loss: 8.242
2025-08-22 20:05:11,444 - INFO - 🔥 MPS Iter 3 takes 3.617 seconds. Loss: 3.543
2025-08-22 20:05:13,540 - INFO - 🔥 MPS Iter 4 takes 5.380 seconds. Loss: 1.552
2025-08-22 20:05:15,371 - INFO - 🔥 MPS Iter 5 takes 7.481 seconds. Loss: 0.705
2025-08-22 20:05:17,137 - INFO - 🔥 MPS Iter 6 takes 9.306 seconds. Loss: 0.323
2025-08-22 20:05:18,896 - INFO - 🔥 MPS Iter 7 takes 11.073 seconds. Loss: 0.151
2025-08-22 20:05:20,713 - INFO - 🔥 MPS Iter 8 takes 12.832 seconds. Loss: 0.071
2025-08-22 20:05:22,577 - INFO - 🔥 MPS Iter 9 takes 14.652 seconds. Loss: 0.034
2025-08-22 20:05:24,441 - INFO - 🔥 MPS Iter 10 takes 16.513 seconds. Loss: 0.016
2025-08-22 20:05:26,287 - INFO - 🔥 MPS Iter 11 takes 18.377 seconds. Loss: 0.008
2025-08-22 20:05:26,291 - INFO - ✅ Converged after 11 iterations
2025-08-22 20:05:26,291 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:05:26,456 - INFO - 🧹 GPU memory cleared
2025-08-22 20:05:27,141 - INFO -    RWR 耗时: 21.076 秒
2025-08-22 20:05:27,444 - INFO -    归一化耗时: 0.303 秒
2025-08-22 20:05:29,038 - INFO -    ✅ 完成，总耗时: 21.907 秒
2025-08-22 20:05:29,040 - INFO -   ✅ chrX: 完成，耗时 23.51 秒
2025-08-22 20:05:29,040 - INFO - 🎯 细胞 GasaE751001 完成: 20 成功, 0 失败, 总耗时 7.7 分钟
2025-08-22 20:05:29,040 - INFO - 🎊 Stage E75 完成: 20 个矩阵成功, 0 个失败
2025-08-22 20:05:29,040 - INFO -    总耗时: 0.13 小时
2025-08-22 20:05:29,040 - INFO - 
============================================================
2025-08-22 20:05:29,040 - INFO - 🎉 所有 Stage 处理完成!
2025-08-22 20:05:29,041 - INFO - 📊 总计: 20 个矩阵成功, 0 个失败
2025-08-22 20:05:29,041 - INFO - ⏱️  总耗时: 0.13 小时
2025-08-22 20:05:29,041 - INFO - 💡 预计节省时间: 0.0 小时 (相比纯 CPU)
2025-08-22 20:05:29,041 - INFO - 📄 详细日志已保存到: mps_imputation.log
2025-08-22 20:07:46,125 - INFO - 🚀 开始 MPS 加速单细胞 Hi-C 插补
2025-08-22 20:07:46,130 - INFO - 📁 输入路径: /Volumes/SumSung500/CSU/0_HiRES/converted_matrices_by_stage_20k
2025-08-22 20:07:46,130 - INFO - 📁 输出路径: /Volumes/SumSung500/CSU/0_HiRES/imputed_matrices_by_stage_20k
2025-08-22 20:07:46,130 - INFO - 🔧 使用 MPS: True
2025-08-22 20:07:46,130 - INFO - 🎯 处理 stages: ['E70']
2025-08-22 20:07:46,130 - INFO - 📦 批处理大小: 1
2025-08-22 20:07:46,509 - INFO - NumExpr defaulting to 10 threads.
2025-08-22 20:07:49,180 - INFO - MPS acceleration is available and will be used for GPU acceleration.
2025-08-22 20:07:49,180 - INFO - ✅ 成功导入 schicluster, MPS 可用: True
2025-08-22 20:07:49,180 - INFO - 
==================================================
2025-08-22 20:07:49,180 - INFO - 🗂️  开始处理 Stage: E70
2025-08-22 20:07:49,180 - INFO - ==================================================
2025-08-22 20:07:49,255 - INFO - 🗂️  Stage E70: 发现 557 个细胞
2025-08-22 20:07:49,256 - INFO - 📊 Stage E70: 处理细胞 1/557
2025-08-22 20:07:49,257 - INFO - 🧬 开始处理细胞: GasdE701001
2025-08-22 20:07:49,258 - INFO -   ✅ chr1: 已存在，跳过
2025-08-22 20:07:49,258 - INFO -   ✅ chr2: 已存在，跳过
2025-08-22 20:07:49,259 - INFO -   ✅ chr3: 已存在，跳过
2025-08-22 20:07:49,260 - INFO -   ✅ chr4: 已存在，跳过
2025-08-22 20:07:49,260 - INFO -   ✅ chr5: 已存在，跳过
2025-08-22 20:07:49,261 - INFO -   ✅ chr6: 已存在，跳过
2025-08-22 20:07:49,261 - INFO -   ✅ chr7: 已存在，跳过
2025-08-22 20:07:49,262 - INFO -   ✅ chr8: 已存在，跳过
2025-08-22 20:07:49,262 - INFO -   ✅ chr9: 已存在，跳过
2025-08-22 20:07:49,263 - INFO -   ✅ chr10: 已存在，跳过
2025-08-22 20:07:49,264 - INFO -   ✅ chr11: 已存在，跳过
2025-08-22 20:07:49,266 - INFO -   ✅ chr12: 已存在，跳过
2025-08-22 20:07:49,266 - INFO -   ✅ chr13: 已存在，跳过
2025-08-22 20:07:49,267 - INFO -   ✅ chr14: 已存在，跳过
2025-08-22 20:07:49,291 - INFO -   ✅ chr15: 已存在，跳过
2025-08-22 20:07:49,292 - INFO -   ✅ chr16: 已存在，跳过
2025-08-22 20:07:49,293 - INFO -   ✅ chr17: 已存在，跳过
2025-08-22 20:07:49,293 - INFO -   ✅ chr18: 已存在，跳过
2025-08-22 20:07:49,294 - INFO -   ✅ chr19: 已存在，跳过
2025-08-22 20:07:49,294 - INFO -   ✅ chrX: 已存在，跳过
2025-08-22 20:07:49,295 - INFO - 🎯 细胞 GasdE701001 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-22 20:07:49,295 - INFO - 📊 Stage E70: 处理细胞 2/557
2025-08-22 20:07:49,295 - INFO - 🧬 开始处理细胞: GasdE701003
2025-08-22 20:07:49,295 - INFO -   ✅ chr1: 已存在，跳过
2025-08-22 20:07:49,296 - INFO -   ✅ chr2: 已存在，跳过
2025-08-22 20:07:49,296 - INFO -   ✅ chr3: 已存在，跳过
2025-08-22 20:07:49,297 - INFO -   ✅ chr4: 已存在，跳过
2025-08-22 20:07:49,298 - INFO -   ✅ chr5: 已存在，跳过
2025-08-22 20:07:49,298 - INFO -   ✅ chr6: 已存在，跳过
2025-08-22 20:07:49,299 - INFO -   ✅ chr7: 已存在，跳过
2025-08-22 20:07:49,299 - INFO -   ✅ chr8: 已存在，跳过
2025-08-22 20:07:49,300 - INFO -   ✅ chr9: 已存在，跳过
2025-08-22 20:07:49,300 - INFO -   ✅ chr10: 已存在，跳过
2025-08-22 20:07:49,301 - INFO -   ✅ chr11: 已存在，跳过
2025-08-22 20:07:49,301 - INFO -   ✅ chr12: 已存在，跳过
2025-08-22 20:07:49,302 - INFO -   ✅ chr13: 已存在，跳过
2025-08-22 20:07:49,302 - INFO -   ✅ chr14: 已存在，跳过
2025-08-22 20:07:49,303 - INFO -   ✅ chr15: 已存在，跳过
2025-08-22 20:07:49,303 - INFO -   ✅ chr16: 已存在，跳过
2025-08-22 20:07:49,304 - INFO -   ✅ chr17: 已存在，跳过
2025-08-22 20:07:49,304 - INFO -   ✅ chr18: 已存在，跳过
2025-08-22 20:07:49,305 - INFO -   ✅ chr19: 已存在，跳过
2025-08-22 20:07:49,305 - INFO -   ✅ chrX: 已存在，跳过
2025-08-22 20:07:49,305 - INFO - 🎯 细胞 GasdE701003 完成: 20 成功, 0 失败, 总耗时 0.0 分钟
2025-08-22 20:07:49,305 - INFO - 📊 Stage E70: 处理细胞 3/557
2025-08-22 20:07:49,305 - INFO - 🧬 开始处理细胞: GasdE701004
2025-08-22 20:07:49,306 - INFO -   ✅ chr1: 已存在，跳过
2025-08-22 20:07:49,307 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 20:07:49,319 - INFO -    矩阵大小: (9106, 9106), 非零元素: 35291, 稀疏度: 0.000426
2025-08-22 20:07:49,320 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:07:49,320 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-22 20:07:50,076 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:07:50,699 - INFO -    卷积耗时: 1.379 秒
2025-08-22 20:07:50,710 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0031)
2025-08-22 20:07:50,710 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-22 20:07:50,710 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-22 20:07:51,076 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-22 20:07:54,480 - INFO - 🔥 MPS Iter 1 takes 0.402 seconds. Loss: 10.040
2025-08-22 20:07:57,412 - INFO - 🔥 MPS Iter 2 takes 3.800 seconds. Loss: 1.837
2025-08-22 20:08:00,746 - INFO - 🔥 MPS Iter 3 takes 6.719 seconds. Loss: 0.441
2025-08-22 20:08:04,612 - INFO - 🔥 MPS Iter 4 takes 10.193 seconds. Loss: 0.115
2025-08-22 20:08:07,946 - INFO - 🔥 MPS Iter 5 takes 14.153 seconds. Loss: 0.035
2025-08-22 20:08:11,057 - INFO - 🔥 MPS Iter 6 takes 17.242 seconds. Loss: 0.011
2025-08-22 20:08:14,477 - INFO - 🔥 MPS Iter 7 takes 20.351 seconds. Loss: 0.004
2025-08-22 20:08:14,496 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:08:14,496 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:08:14,699 - INFO - 🧹 GPU memory cleared
2025-08-22 20:08:20,186 - INFO -    RWR 耗时: 29.484 秒
2025-08-22 20:08:23,569 - INFO -    归一化耗时: 3.383 秒
2025-08-22 20:09:29,233 - INFO -    ✅ 完成，总耗时: 34.245 秒
2025-08-22 20:09:29,262 - INFO -   ✅ chr2: 完成，耗时 99.96 秒
2025-08-22 20:09:29,263 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 20:09:29,286 - INFO -    矩阵大小: (8002, 8002), 非零元素: 27086, 稀疏度: 0.000423
2025-08-22 20:09:29,288 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:09:29,288 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 20:09:29,718 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:09:30,209 - INFO -    卷积耗时: 0.921 秒
2025-08-22 20:09:30,220 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0031)
2025-08-22 20:09:30,220 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 20:09:30,220 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 20:09:30,398 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 20:09:31,134 - INFO - 🔥 MPS Iter 1 takes 0.200 seconds. Loss: 10.271
2025-08-22 20:09:34,277 - INFO - 🔥 MPS Iter 2 takes 0.918 seconds. Loss: 1.977
2025-08-22 20:09:36,059 - INFO - 🔥 MPS Iter 3 takes 4.060 seconds. Loss: 0.482
2025-08-22 20:09:38,397 - INFO - 🔥 MPS Iter 4 takes 5.844 seconds. Loss: 0.123
2025-08-22 20:09:40,717 - INFO - 🔥 MPS Iter 5 takes 8.180 seconds. Loss: 0.035
2025-08-22 20:09:42,923 - INFO - 🔥 MPS Iter 6 takes 10.503 seconds. Loss: 0.010
2025-08-22 20:09:45,004 - INFO - 🔥 MPS Iter 7 takes 12.709 seconds. Loss: 0.003
2025-08-22 20:09:45,009 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:09:45,009 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:09:45,119 - INFO - 🧹 GPU memory cleared
2025-08-22 20:09:48,101 - INFO -    RWR 耗时: 17.890 秒
2025-08-22 20:09:50,469 - INFO -    归一化耗时: 2.367 秒
2025-08-22 20:10:02,223 - INFO -    ✅ 完成，总耗时: 21.178 秒
2025-08-22 20:10:02,232 - INFO -   ✅ chr3: 完成，耗时 32.97 秒
2025-08-22 20:10:02,234 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 20:10:02,245 - INFO -    矩阵大小: (7826, 7826), 非零元素: 28070, 稀疏度: 0.000458
2025-08-22 20:10:02,247 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:10:02,247 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 20:10:02,580 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:10:02,928 - INFO -    卷积耗时: 0.681 秒
2025-08-22 20:10:02,934 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0033)
2025-08-22 20:10:02,934 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 20:10:02,934 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 20:10:03,287 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 20:10:04,217 - INFO - 🔥 MPS Iter 1 takes 0.484 seconds. Loss: 9.878
2025-08-22 20:10:07,085 - INFO - 🔥 MPS Iter 2 takes 1.285 seconds. Loss: 1.888
2025-08-22 20:10:09,209 - INFO - 🔥 MPS Iter 3 takes 4.154 seconds. Loss: 0.480
2025-08-22 20:10:11,002 - INFO - 🔥 MPS Iter 4 takes 6.278 seconds. Loss: 0.131
2025-08-22 20:10:13,165 - INFO - 🔥 MPS Iter 5 takes 8.072 seconds. Loss: 0.042
2025-08-22 20:10:15,053 - INFO - 🔥 MPS Iter 6 takes 10.240 seconds. Loss: 0.015
2025-08-22 20:10:16,813 - INFO - 🔥 MPS Iter 7 takes 12.123 seconds. Loss: 0.005
2025-08-22 20:10:16,822 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:10:16,823 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:10:16,899 - INFO - 🧹 GPU memory cleared
2025-08-22 20:10:19,835 - INFO -    RWR 耗时: 16.906 秒
2025-08-22 20:10:21,446 - INFO -    归一化耗时: 1.610 秒
2025-08-22 20:10:32,000 - INFO -    ✅ 完成，总耗时: 19.197 秒
2025-08-22 20:10:32,023 - INFO -   ✅ chr4: 完成，耗时 29.79 秒
2025-08-22 20:10:32,026 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 20:10:32,043 - INFO -    矩阵大小: (7592, 7592), 非零元素: 28162, 稀疏度: 0.000489
2025-08-22 20:10:32,045 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:10:32,045 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 20:10:32,527 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:10:33,078 - INFO -    卷积耗时: 1.033 秒
2025-08-22 20:10:33,088 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0035)
2025-08-22 20:10:33,088 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 20:10:33,088 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 20:10:33,241 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 20:10:33,888 - INFO - 🔥 MPS Iter 1 takes 0.171 seconds. Loss: 9.596
2025-08-22 20:10:36,335 - INFO - 🔥 MPS Iter 2 takes 0.803 seconds. Loss: 1.836
2025-08-22 20:10:38,041 - INFO - 🔥 MPS Iter 3 takes 3.251 seconds. Loss: 0.456
2025-08-22 20:10:39,612 - INFO - 🔥 MPS Iter 4 takes 4.958 seconds. Loss: 0.119
2025-08-22 20:10:41,044 - INFO - 🔥 MPS Iter 5 takes 6.526 seconds. Loss: 0.035
2025-08-22 20:10:42,715 - INFO - 🔥 MPS Iter 6 takes 7.958 seconds. Loss: 0.011
2025-08-22 20:10:44,442 - INFO - 🔥 MPS Iter 7 takes 9.632 seconds. Loss: 0.004
2025-08-22 20:10:44,444 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:10:44,444 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:10:44,596 - INFO - 🧹 GPU memory cleared
2025-08-22 20:10:46,661 - INFO -    RWR 耗时: 13.580 秒
2025-08-22 20:10:48,223 - INFO -    归一化耗时: 1.562 秒
2025-08-22 20:10:57,394 - INFO -    ✅ 完成，总耗时: 16.175 秒
2025-08-22 20:10:57,414 - INFO -   ✅ chr5: 完成，耗时 25.39 秒
2025-08-22 20:10:57,416 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-22 20:10:57,425 - INFO -    矩阵大小: (7487, 7487), 非零元素: 27854, 稀疏度: 0.000497
2025-08-22 20:10:57,426 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:10:57,427 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-22 20:10:57,599 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:10:57,919 - INFO -    卷积耗时: 0.492 秒
2025-08-22 20:10:57,924 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0036)
2025-08-22 20:10:57,924 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-22 20:10:57,924 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-22 20:10:58,063 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-22 20:10:59,073 - INFO - 🔥 MPS Iter 1 takes 0.155 seconds. Loss: 9.477
2025-08-22 20:11:01,569 - INFO - 🔥 MPS Iter 2 takes 1.154 seconds. Loss: 1.777
2025-08-22 20:11:03,289 - INFO - 🔥 MPS Iter 3 takes 3.658 seconds. Loss: 0.430
2025-08-22 20:11:04,793 - INFO - 🔥 MPS Iter 4 takes 5.436 seconds. Loss: 0.110
2025-08-22 20:11:06,281 - INFO - 🔥 MPS Iter 5 takes 6.872 seconds. Loss: 0.032
2025-08-22 20:11:07,901 - INFO - 🔥 MPS Iter 6 takes 8.361 seconds. Loss: 0.010
2025-08-22 20:11:07,903 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:11:07,903 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:11:08,009 - INFO - 🧹 GPU memory cleared
2025-08-22 20:11:10,490 - INFO -    RWR 耗时: 12.569 秒
2025-08-22 20:11:11,833 - INFO -    归一化耗时: 1.336 秒
2025-08-22 20:11:21,310 - INFO -    ✅ 完成，总耗时: 14.398 秒
2025-08-22 20:11:21,319 - INFO -   ✅ chr6: 完成，耗时 23.90 秒
2025-08-22 20:11:21,321 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-22 20:11:21,334 - INFO -    矩阵大小: (7273, 7273), 非零元素: 26879, 稀疏度: 0.000508
2025-08-22 20:11:21,335 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:11:21,335 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-22 20:11:22,139 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:11:22,643 - INFO -    卷积耗时: 1.308 秒
2025-08-22 20:11:22,649 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0036)
2025-08-22 20:11:22,649 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-22 20:11:22,649 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-22 20:11:22,894 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-22 20:11:23,577 - INFO - 🔥 MPS Iter 1 takes 0.261 seconds. Loss: 9.565
2025-08-22 20:11:25,837 - INFO - 🔥 MPS Iter 2 takes 0.943 seconds. Loss: 1.970
2025-08-22 20:11:27,211 - INFO - 🔥 MPS Iter 3 takes 3.193 seconds. Loss: 0.590
2025-08-22 20:11:28,596 - INFO - 🔥 MPS Iter 4 takes 4.565 seconds. Loss: 0.208
2025-08-22 20:11:29,827 - INFO - 🔥 MPS Iter 5 takes 5.949 seconds. Loss: 0.086
2025-08-22 20:11:30,990 - INFO - 🔥 MPS Iter 6 takes 7.180 seconds. Loss: 0.039
2025-08-22 20:11:32,382 - INFO - 🔥 MPS Iter 7 takes 8.344 seconds. Loss: 0.018
2025-08-22 20:11:33,942 - INFO - 🔥 MPS Iter 8 takes 9.736 seconds. Loss: 0.009
2025-08-22 20:11:33,945 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:11:33,945 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:11:34,000 - INFO - 🧹 GPU memory cleared
2025-08-22 20:11:35,704 - INFO -    RWR 耗时: 13.059 秒
2025-08-22 20:11:36,915 - INFO -    归一化耗时: 1.211 秒
2025-08-22 20:11:45,319 - INFO -    ✅ 完成，总耗时: 15.578 秒
2025-08-22 20:11:45,324 - INFO -   ✅ chr7: 完成，耗时 24.00 秒
2025-08-22 20:11:45,324 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-22 20:11:45,332 - INFO -    矩阵大小: (6471, 6471), 非零元素: 23835, 稀疏度: 0.000569
2025-08-22 20:11:45,333 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:11:45,333 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-22 20:11:45,424 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:11:45,622 - INFO -    卷积耗时: 0.290 秒
2025-08-22 20:11:45,626 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0041)
2025-08-22 20:11:45,626 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-22 20:11:45,627 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-22 20:11:45,707 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-22 20:11:45,981 - INFO - 🔥 MPS Iter 1 takes 0.093 seconds. Loss: 8.691
2025-08-22 20:11:46,343 - INFO - 🔥 MPS Iter 2 takes 0.356 seconds. Loss: 1.690
2025-08-22 20:11:48,134 - INFO - 🔥 MPS Iter 3 takes 0.717 seconds. Loss: 0.461
2025-08-22 20:11:49,179 - INFO - 🔥 MPS Iter 4 takes 2.511 seconds. Loss: 0.153
2025-08-22 20:11:49,988 - INFO - 🔥 MPS Iter 5 takes 3.559 seconds. Loss: 0.061
2025-08-22 20:11:50,758 - INFO - 🔥 MPS Iter 6 takes 4.363 seconds. Loss: 0.026
2025-08-22 20:11:51,558 - INFO - 🔥 MPS Iter 7 takes 5.134 seconds. Loss: 0.012
2025-08-22 20:11:52,559 - INFO - 🔥 MPS Iter 8 takes 5.933 seconds. Loss: 0.005
2025-08-22 20:11:52,562 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:11:52,563 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:11:52,708 - INFO - 🧹 GPU memory cleared
2025-08-22 20:11:54,424 - INFO -    RWR 耗时: 8.801 秒
2025-08-22 20:11:55,377 - INFO -    归一化耗时: 0.953 秒
2025-08-22 20:12:02,081 - INFO -    ✅ 完成，总耗时: 10.044 秒
2025-08-22 20:12:02,089 - INFO -   ✅ chr8: 完成，耗时 16.76 秒
2025-08-22 20:12:02,090 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-22 20:12:02,098 - INFO -    矩阵大小: (6230, 6230), 非零元素: 25597, 稀疏度: 0.000659
2025-08-22 20:12:02,099 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:12:02,099 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-22 20:12:02,418 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:12:02,649 - INFO -    卷积耗时: 0.550 秒
2025-08-22 20:12:02,656 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0047)
2025-08-22 20:12:02,656 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-22 20:12:02,656 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-22 20:12:03,229 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-22 20:12:03,518 - INFO - 🔥 MPS Iter 1 takes 0.592 seconds. Loss: 8.056
2025-08-22 20:12:03,945 - INFO - 🔥 MPS Iter 2 takes 0.863 seconds. Loss: 1.439
2025-08-22 20:12:05,707 - INFO - 🔥 MPS Iter 3 takes 1.291 seconds. Loss: 0.333
2025-08-22 20:12:06,501 - INFO - 🔥 MPS Iter 4 takes 3.054 seconds. Loss: 0.084
2025-08-22 20:12:07,352 - INFO - 🔥 MPS Iter 5 takes 3.847 seconds. Loss: 0.024
2025-08-22 20:12:08,198 - INFO - 🔥 MPS Iter 6 takes 4.698 seconds. Loss: 0.008
2025-08-22 20:12:08,202 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:12:08,202 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:12:08,251 - INFO - 🧹 GPU memory cleared
2025-08-22 20:12:09,671 - INFO -    RWR 耗时: 7.020 秒
2025-08-22 20:12:10,784 - INFO -    归一化耗时: 1.113 秒
2025-08-22 20:12:17,489 - INFO -    ✅ 完成，总耗时: 8.683 秒
2025-08-22 20:12:17,497 - INFO -   ✅ chr9: 完成，耗时 15.41 秒
2025-08-22 20:12:17,499 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-22 20:12:17,508 - INFO -    矩阵大小: (6535, 6535), 非零元素: 22383, 稀疏度: 0.000524
2025-08-22 20:12:17,508 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:12:17,509 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-22 20:12:17,702 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:12:17,962 - INFO -    卷积耗时: 0.453 秒
2025-08-22 20:12:17,967 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0038)
2025-08-22 20:12:17,967 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-22 20:12:17,967 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-22 20:12:18,078 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-22 20:12:18,399 - INFO - 🔥 MPS Iter 1 takes 0.124 seconds. Loss: 8.968
2025-08-22 20:12:19,231 - INFO - 🔥 MPS Iter 2 takes 0.434 seconds. Loss: 1.679
2025-08-22 20:12:20,758 - INFO - 🔥 MPS Iter 3 takes 1.266 seconds. Loss: 0.400
2025-08-22 20:12:21,879 - INFO - 🔥 MPS Iter 4 takes 2.794 seconds. Loss: 0.101
2025-08-22 20:12:22,945 - INFO - 🔥 MPS Iter 5 takes 3.919 seconds. Loss: 0.029
2025-08-22 20:12:24,038 - INFO - 🔥 MPS Iter 6 takes 4.982 seconds. Loss: 0.009
2025-08-22 20:12:24,041 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:12:24,041 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:12:24,116 - INFO - 🧹 GPU memory cleared
2025-08-22 20:12:25,554 - INFO -    RWR 耗时: 7.592 秒
2025-08-22 20:12:26,626 - INFO -    归一化耗时: 1.071 秒
2025-08-22 20:12:33,558 - INFO -    ✅ 完成，总耗时: 9.116 秒
2025-08-22 20:12:33,564 - INFO -   ✅ chr10: 完成，耗时 16.07 秒
2025-08-22 20:12:33,565 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-22 20:12:33,586 - INFO -    矩阵大小: (6105, 6105), 非零元素: 24754, 稀疏度: 0.000664
2025-08-22 20:12:33,588 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:12:33,588 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-22 20:12:33,692 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:12:33,899 - INFO -    卷积耗时: 0.311 秒
2025-08-22 20:12:33,904 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0046)
2025-08-22 20:12:33,904 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-22 20:12:33,904 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-22 20:12:33,974 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-22 20:12:34,186 - INFO - 🔥 MPS Iter 1 takes 0.079 seconds. Loss: 7.833
2025-08-22 20:12:34,474 - INFO - 🔥 MPS Iter 2 takes 0.283 seconds. Loss: 1.366
2025-08-22 20:12:35,131 - INFO - 🔥 MPS Iter 3 takes 0.572 seconds. Loss: 0.312
2025-08-22 20:12:36,325 - INFO - 🔥 MPS Iter 4 takes 1.243 seconds. Loss: 0.079
2025-08-22 20:12:37,272 - INFO - 🔥 MPS Iter 5 takes 2.424 seconds. Loss: 0.024
2025-08-22 20:12:38,102 - INFO - 🔥 MPS Iter 6 takes 3.371 seconds. Loss: 0.008
2025-08-22 20:12:38,104 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:12:38,104 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:12:38,128 - INFO - 🧹 GPU memory cleared
2025-08-22 20:12:39,851 - INFO -    RWR 耗时: 5.950 秒
2025-08-22 20:12:40,784 - INFO -    归一化耗时: 0.933 秒
2025-08-22 20:12:47,351 - INFO -    ✅ 完成，总耗时: 7.194 秒
2025-08-22 20:12:47,359 - INFO -   ✅ chr11: 完成，耗时 13.79 秒
2025-08-22 20:12:47,360 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-22 20:12:47,369 - INFO -    矩阵大小: (6007, 6007), 非零元素: 19142, 稀疏度: 0.000530
2025-08-22 20:12:47,370 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:12:47,370 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-22 20:12:47,531 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:12:47,717 - INFO -    卷积耗时: 0.347 秒
2025-08-22 20:12:47,721 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0038)
2025-08-22 20:12:47,721 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-22 20:12:47,721 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-22 20:12:47,797 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-22 20:12:48,030 - INFO - 🔥 MPS Iter 1 takes 0.084 seconds. Loss: 9.333
2025-08-22 20:12:48,335 - INFO - 🔥 MPS Iter 2 takes 0.310 seconds. Loss: 1.983
2025-08-22 20:12:49,222 - INFO - 🔥 MPS Iter 3 takes 0.615 seconds. Loss: 0.588
2025-08-22 20:12:50,355 - INFO - 🔥 MPS Iter 4 takes 1.502 seconds. Loss: 0.203
2025-08-22 20:12:51,159 - INFO - 🔥 MPS Iter 5 takes 2.637 seconds. Loss: 0.084
2025-08-22 20:12:51,956 - INFO - 🔥 MPS Iter 6 takes 3.442 seconds. Loss: 0.037
2025-08-22 20:12:52,731 - INFO - 🔥 MPS Iter 7 takes 4.236 seconds. Loss: 0.018
2025-08-22 20:12:53,513 - INFO - 🔥 MPS Iter 8 takes 5.011 seconds. Loss: 0.008
2025-08-22 20:12:53,514 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:12:53,514 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:12:53,546 - INFO - 🧹 GPU memory cleared
2025-08-22 20:12:54,970 - INFO -    RWR 耗时: 7.252 秒
2025-08-22 20:12:55,808 - INFO -    归一化耗时: 0.837 秒
2025-08-22 20:13:01,304 - INFO -    ✅ 完成，总耗时: 8.437 秒
2025-08-22 20:13:01,311 - INFO -   ✅ chr12: 完成，耗时 13.95 秒
2025-08-22 20:13:01,312 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-22 20:13:01,319 - INFO -    矩阵大小: (6022, 6022), 非零元素: 22345, 稀疏度: 0.000616
2025-08-22 20:13:01,321 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:13:01,321 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-22 20:13:01,590 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:13:01,782 - INFO -    卷积耗时: 0.462 秒
2025-08-22 20:13:01,788 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0045)
2025-08-22 20:13:01,788 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-22 20:13:01,788 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-22 20:13:01,871 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-22 20:13:02,102 - INFO - 🔥 MPS Iter 1 takes 0.097 seconds. Loss: 8.416
2025-08-22 20:13:02,762 - INFO - 🔥 MPS Iter 2 takes 0.316 seconds. Loss: 1.562
2025-08-22 20:13:03,937 - INFO - 🔥 MPS Iter 3 takes 0.976 seconds. Loss: 0.378
2025-08-22 20:13:04,905 - INFO - 🔥 MPS Iter 4 takes 2.155 seconds. Loss: 0.097
2025-08-22 20:13:05,573 - INFO - 🔥 MPS Iter 5 takes 3.120 seconds. Loss: 0.028
2025-08-22 20:13:06,196 - INFO - 🔥 MPS Iter 6 takes 3.788 seconds. Loss: 0.009
2025-08-22 20:13:06,197 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:13:06,197 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:13:06,229 - INFO - 🧹 GPU memory cleared
2025-08-22 20:13:07,510 - INFO -    RWR 耗时: 5.726 秒
2025-08-22 20:13:08,403 - INFO -    归一化耗时: 0.893 秒
2025-08-22 20:13:13,407 - INFO -    ✅ 完成，总耗时: 7.081 秒
2025-08-22 20:13:13,413 - INFO -   ✅ chr13: 完成，耗时 12.10 秒
2025-08-22 20:13:13,415 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 20:13:13,424 - INFO -    矩阵大小: (6246, 6246), 非零元素: 20391, 稀疏度: 0.000523
2025-08-22 20:13:13,425 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:13:13,425 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 20:13:13,523 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:13:13,719 - INFO -    卷积耗时: 0.294 秒
2025-08-22 20:13:13,723 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0038)
2025-08-22 20:13:13,723 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 20:13:13,723 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 20:13:13,819 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 20:13:14,083 - INFO - 🔥 MPS Iter 1 takes 0.110 seconds. Loss: 9.372
2025-08-22 20:13:14,424 - INFO - 🔥 MPS Iter 2 takes 0.361 seconds. Loss: 2.041
2025-08-22 20:13:15,589 - INFO - 🔥 MPS Iter 3 takes 0.702 seconds. Loss: 0.643
2025-08-22 20:13:16,800 - INFO - 🔥 MPS Iter 4 takes 1.869 seconds. Loss: 0.239
2025-08-22 20:13:17,774 - INFO - 🔥 MPS Iter 5 takes 3.079 seconds. Loss: 0.102
2025-08-22 20:13:18,697 - INFO - 🔥 MPS Iter 6 takes 4.055 seconds. Loss: 0.046
2025-08-22 20:13:19,432 - INFO - 🔥 MPS Iter 7 takes 4.975 seconds. Loss: 0.022
2025-08-22 20:13:20,096 - INFO - 🔥 MPS Iter 8 takes 5.711 seconds. Loss: 0.010
2025-08-22 20:13:20,722 - INFO - 🔥 MPS Iter 9 takes 6.374 seconds. Loss: 0.005
2025-08-22 20:13:20,723 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:13:20,723 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:13:20,735 - INFO - 🧹 GPU memory cleared
2025-08-22 20:13:21,888 - INFO -    RWR 耗时: 8.168 秒
2025-08-22 20:13:23,236 - INFO -    归一化耗时: 1.348 秒
2025-08-22 20:13:31,112 - INFO -    ✅ 完成，总耗时: 9.810 秒
2025-08-22 20:13:31,117 - INFO -   ✅ chr14: 完成，耗时 17.70 秒
2025-08-22 20:13:31,118 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-22 20:13:31,127 - INFO -    矩阵大小: (5203, 5203), 非零元素: 18335, 稀疏度: 0.000677
2025-08-22 20:13:31,128 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:13:31,128 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-22 20:13:31,270 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:13:31,470 - INFO -    卷积耗时: 0.342 秒
2025-08-22 20:13:31,479 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0048)
2025-08-22 20:13:31,480 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-22 20:13:31,480 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-22 20:13:31,564 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-22 20:13:31,717 - INFO - 🔥 MPS Iter 1 takes 0.098 seconds. Loss: 7.958
2025-08-22 20:13:31,865 - INFO - 🔥 MPS Iter 2 takes 0.239 seconds. Loss: 1.513
2025-08-22 20:13:32,045 - INFO - 🔥 MPS Iter 3 takes 0.386 seconds. Loss: 0.368
2025-08-22 20:13:32,481 - INFO - 🔥 MPS Iter 4 takes 0.567 seconds. Loss: 0.095
2025-08-22 20:13:33,391 - INFO - 🔥 MPS Iter 5 takes 1.005 seconds. Loss: 0.028
2025-08-22 20:13:33,999 - INFO - 🔥 MPS Iter 6 takes 1.913 seconds. Loss: 0.009
2025-08-22 20:13:34,000 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:13:34,001 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:13:34,014 - INFO - 🧹 GPU memory cleared
2025-08-22 20:13:35,457 - INFO -    RWR 耗时: 3.985 秒
2025-08-22 20:13:36,263 - INFO -    归一化耗时: 0.806 秒
2025-08-22 20:13:42,540 - INFO -    ✅ 完成，总耗时: 5.134 秒
2025-08-22 20:13:42,547 - INFO -   ✅ chr15: 完成，耗时 11.43 秒
2025-08-22 20:13:42,563 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-22 20:13:42,573 - INFO -    矩阵大小: (4911, 4911), 非零元素: 17103, 稀疏度: 0.000709
2025-08-22 20:13:42,574 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:13:42,574 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-22 20:13:42,803 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:13:43,012 - INFO -    卷积耗时: 0.437 秒
2025-08-22 20:13:43,017 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0051)
2025-08-22 20:13:43,018 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-22 20:13:43,018 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-22 20:13:43,131 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-22 20:13:43,267 - INFO - 🔥 MPS Iter 1 takes 0.131 seconds. Loss: 7.924
2025-08-22 20:13:43,395 - INFO - 🔥 MPS Iter 2 takes 0.253 seconds. Loss: 1.542
2025-08-22 20:13:43,539 - INFO - 🔥 MPS Iter 3 takes 0.379 seconds. Loss: 0.385
2025-08-22 20:13:43,738 - INFO - 🔥 MPS Iter 4 takes 0.523 seconds. Loss: 0.101
2025-08-22 20:13:44,407 - INFO - 🔥 MPS Iter 5 takes 0.724 seconds. Loss: 0.030
2025-08-22 20:13:44,857 - INFO - 🔥 MPS Iter 6 takes 1.496 seconds. Loss: 0.009
2025-08-22 20:13:44,858 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:13:44,858 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:13:44,876 - INFO - 🧹 GPU memory cleared
2025-08-22 20:13:45,939 - INFO -    RWR 耗时: 2.926 秒
2025-08-22 20:13:46,815 - INFO -    归一化耗时: 0.876 秒
2025-08-22 20:13:52,022 - INFO -    ✅ 完成，总耗时: 4.239 秒
2025-08-22 20:13:52,029 - INFO -   ✅ chr16: 完成，耗时 9.47 秒
2025-08-22 20:13:52,030 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-22 20:13:52,046 - INFO -    矩阵大小: (4750, 4750), 非零元素: 16512, 稀疏度: 0.000732
2025-08-22 20:13:52,047 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:13:52,048 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-22 20:13:52,163 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:13:52,463 - INFO -    卷积耗时: 0.415 秒
2025-08-22 20:13:52,467 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0051)
2025-08-22 20:13:52,467 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-22 20:13:52,467 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-22 20:13:52,548 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-22 20:13:52,662 - INFO - 🔥 MPS Iter 1 takes 0.093 seconds. Loss: 7.979
2025-08-22 20:13:52,769 - INFO - 🔥 MPS Iter 2 takes 0.196 seconds. Loss: 1.557
2025-08-22 20:13:52,890 - INFO - 🔥 MPS Iter 3 takes 0.304 seconds. Loss: 0.396
2025-08-22 20:13:53,034 - INFO - 🔥 MPS Iter 4 takes 0.425 seconds. Loss: 0.104
2025-08-22 20:13:53,360 - INFO - 🔥 MPS Iter 5 takes 0.570 seconds. Loss: 0.032
2025-08-22 20:13:54,082 - INFO - 🔥 MPS Iter 6 takes 0.898 seconds. Loss: 0.010
2025-08-22 20:13:54,084 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:13:54,084 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:13:54,097 - INFO - 🧹 GPU memory cleared
2025-08-22 20:13:55,032 - INFO -    RWR 耗时: 2.568 秒
2025-08-22 20:13:56,204 - INFO -    归一化耗时: 1.172 秒
2025-08-22 20:14:01,554 - INFO -    ✅ 完成，总耗时: 4.155 秒
2025-08-22 20:14:01,560 - INFO -   ✅ chr17: 完成，耗时 9.53 秒
2025-08-22 20:14:01,560 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-22 20:14:01,570 - INFO -    矩阵大小: (4536, 4536), 非零元素: 15510, 稀疏度: 0.000754
2025-08-22 20:14:01,571 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:14:01,571 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-22 20:14:01,675 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:14:01,826 - INFO -    卷积耗时: 0.255 秒
2025-08-22 20:14:01,831 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0055)
2025-08-22 20:14:01,832 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-22 20:14:01,832 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-22 20:14:01,909 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-22 20:14:02,006 - INFO - 🔥 MPS Iter 1 takes 0.091 seconds. Loss: 7.422
2025-08-22 20:14:02,094 - INFO - 🔥 MPS Iter 2 takes 0.176 seconds. Loss: 1.384
2025-08-22 20:14:02,190 - INFO - 🔥 MPS Iter 3 takes 0.264 seconds. Loss: 0.327
2025-08-22 20:14:02,302 - INFO - 🔥 MPS Iter 4 takes 0.360 seconds. Loss: 0.081
2025-08-22 20:14:02,433 - INFO - 🔥 MPS Iter 5 takes 0.471 seconds. Loss: 0.023
2025-08-22 20:14:02,694 - INFO - 🔥 MPS Iter 6 takes 0.604 seconds. Loss: 0.007
2025-08-22 20:14:02,695 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:14:02,695 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:14:02,709 - INFO - 🧹 GPU memory cleared
2025-08-22 20:14:03,569 - INFO -    RWR 耗时: 1.741 秒
2025-08-22 20:14:04,476 - INFO -    归一化耗时: 0.907 秒
2025-08-22 20:14:09,200 - INFO -    ✅ 完成，总耗时: 2.903 秒
2025-08-22 20:14:09,207 - INFO -   ✅ chr18: 完成，耗时 7.65 秒
2025-08-22 20:14:09,207 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-22 20:14:09,213 - INFO -    矩阵大小: (3072, 3072), 非零元素: 10622, 稀疏度: 0.001126
2025-08-22 20:14:09,217 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:14:09,217 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-22 20:14:09,317 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:14:09,387 - INFO -    卷积耗时: 0.170 秒
2025-08-22 20:14:09,391 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0076)
2025-08-22 20:14:09,391 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-22 20:14:09,391 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-22 20:14:09,447 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-22 20:14:09,491 - INFO - 🔥 MPS Iter 1 takes 0.069 seconds. Loss: 6.199
2025-08-22 20:14:09,519 - INFO - 🔥 MPS Iter 2 takes 0.101 seconds. Loss: 1.236
2025-08-22 20:14:09,546 - INFO - 🔥 MPS Iter 3 takes 0.128 seconds. Loss: 0.351
2025-08-22 20:14:09,573 - INFO - 🔥 MPS Iter 4 takes 0.156 seconds. Loss: 0.120
2025-08-22 20:14:09,602 - INFO - 🔥 MPS Iter 5 takes 0.183 seconds. Loss: 0.049
2025-08-22 20:14:09,631 - INFO - 🔥 MPS Iter 6 takes 0.212 seconds. Loss: 0.022
2025-08-22 20:14:09,660 - INFO - 🔥 MPS Iter 7 takes 0.241 seconds. Loss: 0.010
2025-08-22 20:14:09,661 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:14:09,661 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:14:09,664 - INFO - 🧹 GPU memory cleared
2025-08-22 20:14:09,962 - INFO -    RWR 耗时: 0.574 秒
2025-08-22 20:14:10,247 - INFO -    归一化耗时: 0.284 秒
2025-08-22 20:14:12,626 - INFO -    ✅ 完成，总耗时: 1.029 秒
2025-08-22 20:14:12,630 - INFO -   ✅ chr19: 完成，耗时 3.42 秒
2025-08-22 20:14:12,631 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-22 20:14:12,637 - INFO -    矩阵大小: (8552, 8552), 非零元素: 9664, 稀疏度: 0.000132
2025-08-22 20:14:12,639 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:14:12,639 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-22 20:14:13,040 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:14:13,671 - INFO -    卷积耗时: 1.032 秒
2025-08-22 20:14:13,679 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0010)
2025-08-22 20:14:13,680 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-22 20:14:13,680 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-22 20:14:13,899 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-22 20:14:15,179 - INFO - 🔥 MPS Iter 1 takes 0.239 seconds. Loss: 17.405
2025-08-22 20:14:18,015 - INFO - 🔥 MPS Iter 2 takes 1.510 seconds. Loss: 5.151
2025-08-22 20:14:20,047 - INFO - 🔥 MPS Iter 3 takes 4.368 seconds. Loss: 1.841
2025-08-22 20:14:21,775 - INFO - 🔥 MPS Iter 4 takes 6.370 seconds. Loss: 0.670
2025-08-22 20:14:24,051 - INFO - 🔥 MPS Iter 5 takes 8.101 seconds. Loss: 0.263
2025-08-22 20:14:25,725 - INFO - 🔥 MPS Iter 6 takes 10.374 seconds. Loss: 0.105
2025-08-22 20:14:27,676 - INFO - 🔥 MPS Iter 7 takes 12.048 seconds. Loss: 0.044
2025-08-22 20:14:29,902 - INFO - 🔥 MPS Iter 8 takes 14.003 seconds. Loss: 0.019
2025-08-22 20:14:31,712 - INFO - 🔥 MPS Iter 9 takes 16.226 seconds. Loss: 0.008
2025-08-22 20:14:31,715 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:14:31,715 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:14:31,980 - INFO - 🧹 GPU memory cleared
2025-08-22 20:14:34,239 - INFO -    RWR 耗时: 20.566 秒
2025-08-22 20:14:35,827 - INFO -    归一化耗时: 1.588 秒
2025-08-22 20:14:47,421 - INFO -    ✅ 完成，总耗时: 23.187 秒
2025-08-22 20:14:47,428 - INFO -   ✅ chrX: 完成，耗时 34.80 秒
2025-08-22 20:14:47,428 - INFO - 🎯 细胞 GasdE701004 完成: 20 成功, 0 失败, 总耗时 7.0 分钟
2025-08-22 20:14:47,428 - INFO - 📊 Stage E70: 处理细胞 4/557
2025-08-22 20:14:47,428 - INFO - 🧬 开始处理细胞: GasdE701005
2025-08-22 20:14:47,429 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 20:14:47,458 - INFO -    矩阵大小: (9774, 9774), 非零元素: 33029, 稀疏度: 0.000346
2025-08-22 20:14:47,459 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:14:47,459 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-22 20:14:47,799 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:14:48,575 - INFO -    卷积耗时: 1.116 秒
2025-08-22 20:14:48,587 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0023)
2025-08-22 20:14:48,587 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-22 20:14:48,587 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-22 20:14:48,824 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-22 20:14:51,977 - INFO - 🔥 MPS Iter 1 takes 0.255 seconds. Loss: 11.691
2025-08-22 20:14:55,660 - INFO - 🔥 MPS Iter 2 takes 3.423 seconds. Loss: 2.308
2025-08-22 20:14:59,722 - INFO - 🔥 MPS Iter 3 takes 7.079 seconds. Loss: 0.577
2025-08-22 20:15:03,808 - INFO - 🔥 MPS Iter 4 takes 11.153 seconds. Loss: 0.152
2025-08-22 20:15:07,652 - INFO - 🔥 MPS Iter 5 takes 15.241 seconds. Loss: 0.046
2025-08-22 20:15:11,407 - INFO - 🔥 MPS Iter 6 takes 19.091 seconds. Loss: 0.014
2025-08-22 20:15:15,379 - INFO - 🔥 MPS Iter 7 takes 22.974 seconds. Loss: 0.005
2025-08-22 20:15:15,381 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:15:15,382 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:15:15,763 - INFO - 🧹 GPU memory cleared
2025-08-22 20:15:21,333 - INFO -    RWR 耗时: 32.755 秒
2025-08-22 20:15:24,438 - INFO -    归一化耗时: 3.105 秒
2025-08-22 20:16:27,757 - INFO -    ✅ 完成，总耗时: 36.975 秒
2025-08-22 20:16:27,786 - INFO -   ✅ chr1: 完成，耗时 100.36 秒
2025-08-22 20:16:27,788 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 20:16:27,798 - INFO -    矩阵大小: (9106, 9106), 非零元素: 32379, 稀疏度: 0.000390
2025-08-22 20:16:27,799 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:16:27,800 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-22 20:16:28,335 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:16:28,776 - INFO -    卷积耗时: 0.977 秒
2025-08-22 20:16:28,783 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0025)
2025-08-22 20:16:28,783 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-22 20:16:28,783 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-22 20:16:28,859 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-22 20:16:31,102 - INFO - 🔥 MPS Iter 1 takes 0.078 seconds. Loss: 10.719
2025-08-22 20:16:34,429 - INFO - 🔥 MPS Iter 2 takes 2.325 seconds. Loss: 2.053
2025-08-22 20:16:36,610 - INFO - 🔥 MPS Iter 3 takes 5.654 seconds. Loss: 0.505
2025-08-22 20:16:39,797 - INFO - 🔥 MPS Iter 4 takes 7.829 seconds. Loss: 0.133
2025-08-22 20:16:42,200 - INFO - 🔥 MPS Iter 5 takes 11.018 seconds. Loss: 0.040
2025-08-22 20:16:44,957 - INFO - 🔥 MPS Iter 6 takes 13.421 seconds. Loss: 0.013
2025-08-22 20:16:47,252 - INFO - 🔥 MPS Iter 7 takes 16.176 seconds. Loss: 0.005
2025-08-22 20:16:47,260 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:16:47,260 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:16:47,319 - INFO - 🧹 GPU memory cleared
2025-08-22 20:16:49,551 - INFO -    RWR 耗时: 20.773 秒
2025-08-22 20:16:51,210 - INFO -    归一化耗时: 1.659 秒
2025-08-22 20:17:24,410 - INFO -    ✅ 完成，总耗时: 23.408 秒
2025-08-22 20:17:24,430 - INFO -   ✅ chr2: 完成，耗时 56.64 秒
2025-08-22 20:17:24,431 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 20:17:24,439 - INFO -    矩阵大小: (8002, 8002), 非零元素: 24314, 稀疏度: 0.000380
2025-08-22 20:17:24,440 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:17:24,440 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 20:17:24,776 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:17:25,052 - INFO -    卷积耗时: 0.612 秒
2025-08-22 20:17:25,056 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0026)
2025-08-22 20:17:25,056 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 20:17:25,056 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 20:17:25,116 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 20:17:25,650 - INFO - 🔥 MPS Iter 1 takes 0.061 seconds. Loss: 11.155
2025-08-22 20:17:28,063 - INFO - 🔥 MPS Iter 2 takes 0.596 seconds. Loss: 2.271
2025-08-22 20:17:29,726 - INFO - 🔥 MPS Iter 3 takes 3.010 seconds. Loss: 0.585
2025-08-22 20:17:30,955 - INFO - 🔥 MPS Iter 4 takes 4.671 seconds. Loss: 0.156
2025-08-22 20:17:32,517 - INFO - 🔥 MPS Iter 5 takes 5.900 seconds. Loss: 0.047
2025-08-22 20:17:34,375 - INFO - 🔥 MPS Iter 6 takes 7.463 seconds. Loss: 0.015
2025-08-22 20:17:35,760 - INFO - 🔥 MPS Iter 7 takes 9.321 seconds. Loss: 0.005
2025-08-22 20:17:35,762 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:17:35,762 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:17:35,797 - INFO - 🧹 GPU memory cleared
2025-08-22 20:17:37,385 - INFO -    RWR 耗时: 12.332 秒
2025-08-22 20:17:38,828 - INFO -    归一化耗时: 1.439 秒
2025-08-22 20:17:47,363 - INFO -    ✅ 完成，总耗时: 14.383 秒
2025-08-22 20:17:47,373 - INFO -   ✅ chr3: 完成，耗时 22.94 秒
2025-08-22 20:17:47,374 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 20:17:47,379 - INFO -    矩阵大小: (7826, 7826), 非零元素: 24083, 稀疏度: 0.000393
2025-08-22 20:17:47,380 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:17:47,380 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 20:17:47,495 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:17:47,760 - INFO -    卷积耗时: 0.380 秒
2025-08-22 20:17:47,764 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0026)
2025-08-22 20:17:47,764 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 20:17:47,764 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 20:17:47,810 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 20:17:48,428 - INFO - 🔥 MPS Iter 1 takes 0.048 seconds. Loss: 10.932
2025-08-22 20:17:50,582 - INFO - 🔥 MPS Iter 2 takes 0.665 seconds. Loss: 2.249
2025-08-22 20:17:51,956 - INFO - 🔥 MPS Iter 3 takes 2.820 seconds. Loss: 0.596
2025-08-22 20:17:53,611 - INFO - 🔥 MPS Iter 4 takes 4.196 seconds. Loss: 0.166
2025-08-22 20:17:54,932 - INFO - 🔥 MPS Iter 5 takes 5.849 seconds. Loss: 0.052
2025-08-22 20:17:56,080 - INFO - 🔥 MPS Iter 6 takes 7.169 seconds. Loss: 0.017
2025-08-22 20:17:57,647 - INFO - 🔥 MPS Iter 7 takes 8.317 seconds. Loss: 0.006
2025-08-22 20:17:57,648 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:17:57,649 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:17:57,683 - INFO - 🧹 GPU memory cleared
2025-08-22 20:17:59,337 - INFO -    RWR 耗时: 11.576 秒
2025-08-22 20:18:00,554 - INFO -    归一化耗时: 1.212 秒
2025-08-22 20:18:08,363 - INFO -    ✅ 完成，总耗时: 13.168 秒
2025-08-22 20:18:08,375 - INFO -   ✅ chr4: 完成，耗时 21.00 秒
2025-08-22 20:18:08,376 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 20:18:08,380 - INFO -    矩阵大小: (7592, 7592), 非零元素: 24457, 稀疏度: 0.000424
2025-08-22 20:18:08,381 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:18:08,381 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 20:18:08,482 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:18:08,783 - INFO -    卷积耗时: 0.402 秒
2025-08-22 20:18:08,787 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0027)
2025-08-22 20:18:08,788 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 20:18:08,788 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 20:18:08,855 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 20:18:09,304 - INFO - 🔥 MPS Iter 1 takes 0.069 seconds. Loss: 10.434
2025-08-22 20:18:10,791 - INFO - 🔥 MPS Iter 2 takes 0.518 seconds. Loss: 2.127
2025-08-22 20:18:12,390 - INFO - 🔥 MPS Iter 3 takes 2.010 seconds. Loss: 0.564
2025-08-22 20:18:13,972 - INFO - 🔥 MPS Iter 4 takes 3.605 seconds. Loss: 0.159
2025-08-22 20:18:15,106 - INFO - 🔥 MPS Iter 5 takes 5.187 seconds. Loss: 0.052
2025-08-22 20:18:16,168 - INFO - 🔥 MPS Iter 6 takes 6.320 seconds. Loss: 0.017
2025-08-22 20:18:17,707 - INFO - 🔥 MPS Iter 7 takes 7.382 seconds. Loss: 0.006
2025-08-22 20:18:17,714 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:18:17,714 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:18:17,746 - INFO - 🧹 GPU memory cleared
2025-08-22 20:18:19,321 - INFO -    RWR 耗时: 10.537 秒
2025-08-22 20:18:20,510 - INFO -    归一化耗时: 1.188 秒
2025-08-22 20:18:27,948 - INFO -    ✅ 完成，总耗时: 12.128 秒
2025-08-22 20:18:27,955 - INFO -   ✅ chr5: 完成，耗时 19.58 秒
2025-08-22 20:18:27,956 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-22 20:18:27,961 - INFO -    矩阵大小: (7487, 7487), 非零元素: 25836, 稀疏度: 0.000461
2025-08-22 20:18:27,962 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:18:27,962 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-22 20:18:28,085 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:18:28,326 - INFO -    卷积耗时: 0.364 秒
2025-08-22 20:18:28,330 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0031)
2025-08-22 20:18:28,330 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-22 20:18:28,330 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-22 20:18:28,379 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-22 20:18:28,893 - INFO - 🔥 MPS Iter 1 takes 0.050 seconds. Loss: 10.105
2025-08-22 20:18:30,325 - INFO - 🔥 MPS Iter 2 takes 0.564 seconds. Loss: 1.969
2025-08-22 20:18:31,610 - INFO - 🔥 MPS Iter 3 takes 1.997 seconds. Loss: 0.489
2025-08-22 20:18:33,003 - INFO - 🔥 MPS Iter 4 takes 3.285 seconds. Loss: 0.128
2025-08-22 20:18:34,230 - INFO - 🔥 MPS Iter 5 takes 4.675 seconds. Loss: 0.038
2025-08-22 20:18:35,354 - INFO - 🔥 MPS Iter 6 takes 5.902 seconds. Loss: 0.012
2025-08-22 20:18:36,120 - INFO - 🔥 MPS Iter 7 takes 7.025 seconds. Loss: 0.004
2025-08-22 20:18:36,122 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:18:36,122 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:18:36,146 - INFO - 🧹 GPU memory cleared
2025-08-22 20:18:37,668 - INFO -    RWR 耗时: 9.342 秒
2025-08-22 20:18:39,043 - INFO -    归一化耗时: 1.370 秒
2025-08-22 20:18:47,073 - INFO -    ✅ 完成，总耗时: 11.075 秒
2025-08-22 20:18:47,085 - INFO -   ✅ chr6: 完成，耗时 19.13 秒
2025-08-22 20:18:47,086 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-22 20:18:47,091 - INFO -    矩阵大小: (7273, 7273), 非零元素: 24353, 稀疏度: 0.000460
2025-08-22 20:18:47,092 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:18:47,092 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-22 20:18:47,228 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:18:47,483 - INFO -    卷积耗时: 0.391 秒
2025-08-22 20:18:47,487 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0030)
2025-08-22 20:18:47,487 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-22 20:18:47,487 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-22 20:18:47,529 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-22 20:18:47,996 - INFO - 🔥 MPS Iter 1 takes 0.043 seconds. Loss: 10.307
2025-08-22 20:18:49,802 - INFO - 🔥 MPS Iter 2 takes 0.510 seconds. Loss: 2.245
2025-08-22 20:18:51,002 - INFO - 🔥 MPS Iter 3 takes 2.318 seconds. Loss: 0.692
2025-08-22 20:18:52,300 - INFO - 🔥 MPS Iter 4 takes 3.517 seconds. Loss: 0.246
2025-08-22 20:18:53,809 - INFO - 🔥 MPS Iter 5 takes 4.815 seconds. Loss: 0.102
2025-08-22 20:18:54,886 - INFO - 🔥 MPS Iter 6 takes 6.327 seconds. Loss: 0.045
2025-08-22 20:18:55,998 - INFO - 🔥 MPS Iter 7 takes 7.402 seconds. Loss: 0.021
2025-08-22 20:18:57,179 - INFO - 🔥 MPS Iter 8 takes 8.513 seconds. Loss: 0.010
2025-08-22 20:18:57,181 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:18:57,181 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:18:57,215 - INFO - 🧹 GPU memory cleared
2025-08-22 20:18:58,688 - INFO -    RWR 耗时: 11.204 秒
2025-08-22 20:18:59,644 - INFO -    归一化耗时: 0.956 秒
2025-08-22 20:19:06,346 - INFO -    ✅ 完成，总耗时: 12.551 秒
2025-08-22 20:19:06,356 - INFO -   ✅ chr7: 完成，耗时 19.27 秒
2025-08-22 20:19:06,358 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-22 20:19:06,387 - INFO -    矩阵大小: (6471, 6471), 非零元素: 21194, 稀疏度: 0.000506
2025-08-22 20:19:06,388 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:19:06,388 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-22 20:19:06,478 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:19:06,679 - INFO -    卷积耗时: 0.291 秒
2025-08-22 20:19:06,682 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0033)
2025-08-22 20:19:06,682 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-22 20:19:06,682 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-22 20:19:06,735 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-22 20:19:07,053 - INFO - 🔥 MPS Iter 1 takes 0.054 seconds. Loss: 9.705
2025-08-22 20:19:07,714 - INFO - 🔥 MPS Iter 2 takes 0.372 seconds. Loss: 1.970
2025-08-22 20:19:09,398 - INFO - 🔥 MPS Iter 3 takes 1.036 seconds. Loss: 0.517
2025-08-22 20:19:10,248 - INFO - 🔥 MPS Iter 4 takes 2.726 seconds. Loss: 0.144
2025-08-22 20:19:10,922 - INFO - 🔥 MPS Iter 5 takes 3.569 seconds. Loss: 0.045
2025-08-22 20:19:11,673 - INFO - 🔥 MPS Iter 6 takes 4.244 seconds. Loss: 0.015
2025-08-22 20:19:12,511 - INFO - 🔥 MPS Iter 7 takes 4.993 seconds. Loss: 0.005
2025-08-22 20:19:12,512 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:19:12,512 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:19:12,533 - INFO - 🧹 GPU memory cleared
2025-08-22 20:19:14,146 - INFO -    RWR 耗时: 7.466 秒
2025-08-22 20:19:15,014 - INFO -    归一化耗时: 0.868 秒
2025-08-22 20:19:20,316 - INFO -    ✅ 完成，总耗时: 8.626 秒
2025-08-22 20:19:20,325 - INFO -   ✅ chr8: 完成，耗时 13.97 秒
2025-08-22 20:19:20,326 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-22 20:19:20,332 - INFO -    矩阵大小: (6230, 6230), 非零元素: 21678, 稀疏度: 0.000559
2025-08-22 20:19:20,332 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:19:20,332 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-22 20:19:20,450 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:19:20,633 - INFO -    卷积耗时: 0.300 秒
2025-08-22 20:19:20,636 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0035)
2025-08-22 20:19:20,636 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-22 20:19:20,636 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-22 20:19:20,681 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-22 20:19:20,917 - INFO - 🔥 MPS Iter 1 takes 0.046 seconds. Loss: 9.298
2025-08-22 20:19:21,226 - INFO - 🔥 MPS Iter 2 takes 0.284 seconds. Loss: 1.848
2025-08-22 20:19:22,148 - INFO - 🔥 MPS Iter 3 takes 0.591 seconds. Loss: 0.471
2025-08-22 20:19:23,310 - INFO - 🔥 MPS Iter 4 takes 1.513 seconds. Loss: 0.127
2025-08-22 20:19:24,159 - INFO - 🔥 MPS Iter 5 takes 2.675 seconds. Loss: 0.039
2025-08-22 20:19:24,805 - INFO - 🔥 MPS Iter 6 takes 3.525 seconds. Loss: 0.013
2025-08-22 20:19:25,394 - INFO - 🔥 MPS Iter 7 takes 4.170 seconds. Loss: 0.005
2025-08-22 20:19:25,423 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:19:25,424 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:19:25,442 - INFO - 🧹 GPU memory cleared
2025-08-22 20:19:26,454 - INFO -    RWR 耗时: 5.820 秒
2025-08-22 20:19:27,337 - INFO -    归一化耗时: 0.882 秒
2025-08-22 20:19:32,385 - INFO -    ✅ 完成，总耗时: 7.002 秒
2025-08-22 20:19:32,396 - INFO -   ✅ chr9: 完成，耗时 12.07 秒
2025-08-22 20:19:32,399 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-22 20:19:32,420 - INFO -    矩阵大小: (6535, 6535), 非零元素: 20312, 稀疏度: 0.000476
2025-08-22 20:19:32,422 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:19:32,423 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-22 20:19:32,553 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:19:32,775 - INFO -    卷积耗时: 0.353 秒
2025-08-22 20:19:32,779 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0031)
2025-08-22 20:19:32,779 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-22 20:19:32,779 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-22 20:19:32,825 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-22 20:19:33,148 - INFO - 🔥 MPS Iter 1 takes 0.047 seconds. Loss: 9.944
2025-08-22 20:19:33,783 - INFO - 🔥 MPS Iter 2 takes 0.370 seconds. Loss: 2.036
2025-08-22 20:19:35,052 - INFO - 🔥 MPS Iter 3 takes 1.005 seconds. Loss: 0.533
2025-08-22 20:19:36,021 - INFO - 🔥 MPS Iter 4 takes 2.275 seconds. Loss: 0.147
2025-08-22 20:19:36,938 - INFO - 🔥 MPS Iter 5 takes 3.243 seconds. Loss: 0.046
2025-08-22 20:19:37,818 - INFO - 🔥 MPS Iter 6 takes 4.160 seconds. Loss: 0.015
2025-08-22 20:19:38,796 - INFO - 🔥 MPS Iter 7 takes 5.041 seconds. Loss: 0.005
2025-08-22 20:19:38,797 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:19:38,797 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:19:38,812 - INFO - 🧹 GPU memory cleared
2025-08-22 20:19:40,042 - INFO -    RWR 耗时: 7.266 秒
2025-08-22 20:19:41,221 - INFO -    归一化耗时: 1.179 秒
2025-08-22 20:19:46,980 - INFO -    ✅ 完成，总耗时: 8.797 秒
2025-08-22 20:19:46,986 - INFO -   ✅ chr10: 完成，耗时 14.59 秒
2025-08-22 20:19:46,987 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-22 20:19:46,995 - INFO -    矩阵大小: (6105, 6105), 非零元素: 21825, 稀疏度: 0.000586
2025-08-22 20:19:46,995 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:19:46,995 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-22 20:19:47,196 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:19:47,362 - INFO -    卷积耗时: 0.367 秒
2025-08-22 20:19:47,365 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0035)
2025-08-22 20:19:47,366 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-22 20:19:47,366 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-22 20:19:47,424 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-22 20:19:47,664 - INFO - 🔥 MPS Iter 1 takes 0.060 seconds. Loss: 8.978
2025-08-22 20:19:47,973 - INFO - 🔥 MPS Iter 2 takes 0.300 seconds. Loss: 1.736
2025-08-22 20:19:48,852 - INFO - 🔥 MPS Iter 3 takes 0.608 seconds. Loss: 0.441
2025-08-22 20:19:49,892 - INFO - 🔥 MPS Iter 4 takes 1.489 seconds. Loss: 0.121
2025-08-22 20:19:50,781 - INFO - 🔥 MPS Iter 5 takes 2.528 seconds. Loss: 0.038
2025-08-22 20:19:51,513 - INFO - 🔥 MPS Iter 6 takes 3.418 seconds. Loss: 0.013
2025-08-22 20:19:52,296 - INFO - 🔥 MPS Iter 7 takes 4.150 seconds. Loss: 0.005
2025-08-22 20:19:52,297 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:19:52,298 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:19:52,419 - INFO - 🧹 GPU memory cleared
2025-08-22 20:19:53,558 - INFO -    RWR 耗时: 6.195 秒
2025-08-22 20:19:54,406 - INFO -    归一化耗时: 0.848 秒
2025-08-22 20:20:00,465 - INFO -    ✅ 完成，总耗时: 7.409 秒
2025-08-22 20:20:00,477 - INFO -   ✅ chr11: 完成，耗时 13.49 秒
2025-08-22 20:20:00,480 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-22 20:20:00,492 - INFO -    矩阵大小: (6007, 6007), 非零元素: 18482, 稀疏度: 0.000512
2025-08-22 20:20:00,493 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:20:00,493 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-22 20:20:00,622 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:20:00,888 - INFO -    卷积耗时: 0.395 秒
2025-08-22 20:20:00,892 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0034)
2025-08-22 20:20:00,892 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-22 20:20:00,893 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-22 20:20:00,947 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-22 20:20:01,169 - INFO - 🔥 MPS Iter 1 takes 0.056 seconds. Loss: 9.736
2025-08-22 20:20:01,470 - INFO - 🔥 MPS Iter 2 takes 0.279 seconds. Loss: 2.088
2025-08-22 20:20:02,463 - INFO - 🔥 MPS Iter 3 takes 0.580 seconds. Loss: 0.591
2025-08-22 20:20:03,497 - INFO - 🔥 MPS Iter 4 takes 1.575 seconds. Loss: 0.181
2025-08-22 20:20:04,235 - INFO - 🔥 MPS Iter 5 takes 2.608 seconds. Loss: 0.063
2025-08-22 20:20:04,862 - INFO - 🔥 MPS Iter 6 takes 3.344 seconds. Loss: 0.023
2025-08-22 20:20:05,495 - INFO - 🔥 MPS Iter 7 takes 3.974 seconds. Loss: 0.009
2025-08-22 20:20:05,504 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:20:05,505 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:20:05,617 - INFO - 🧹 GPU memory cleared
2025-08-22 20:20:07,037 - INFO -    RWR 耗时: 6.148 秒
2025-08-22 20:20:08,321 - INFO -    归一化耗时: 1.283 秒
2025-08-22 20:20:15,614 - INFO -    ✅ 完成，总耗时: 7.826 秒
2025-08-22 20:20:15,622 - INFO -   ✅ chr12: 完成，耗时 15.14 秒
2025-08-22 20:20:15,642 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-22 20:20:15,655 - INFO -    矩阵大小: (6022, 6022), 非零元素: 18962, 稀疏度: 0.000523
2025-08-22 20:20:15,656 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:20:15,657 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-22 20:20:15,903 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:20:16,150 - INFO -    卷积耗时: 0.494 秒
2025-08-22 20:20:16,160 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0034)
2025-08-22 20:20:16,161 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-22 20:20:16,161 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-22 20:20:16,217 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-22 20:20:16,437 - INFO - 🔥 MPS Iter 1 takes 0.061 seconds. Loss: 9.657
2025-08-22 20:20:17,171 - INFO - 🔥 MPS Iter 2 takes 0.278 seconds. Loss: 2.012
2025-08-22 20:20:17,809 - INFO - 🔥 MPS Iter 3 takes 1.013 seconds. Loss: 0.542
2025-08-22 20:20:19,223 - INFO - 🔥 MPS Iter 4 takes 1.651 seconds. Loss: 0.155
2025-08-22 20:20:19,913 - INFO - 🔥 MPS Iter 5 takes 3.065 seconds. Loss: 0.050
2025-08-22 20:20:20,535 - INFO - 🔥 MPS Iter 6 takes 3.755 seconds. Loss: 0.017
2025-08-22 20:20:21,125 - INFO - 🔥 MPS Iter 7 takes 4.376 seconds. Loss: 0.006
2025-08-22 20:20:21,127 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:20:21,127 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:20:21,225 - INFO - 🧹 GPU memory cleared
2025-08-22 20:20:23,021 - INFO -    RWR 耗时: 6.868 秒
2025-08-22 20:20:24,302 - INFO -    归一化耗时: 1.281 秒
2025-08-22 20:20:30,971 - INFO -    ✅ 完成，总耗时: 8.642 秒
2025-08-22 20:20:30,976 - INFO -   ✅ chr13: 完成，耗时 15.33 秒
2025-08-22 20:20:30,977 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 20:20:31,007 - INFO -    矩阵大小: (6246, 6246), 非零元素: 18890, 稀疏度: 0.000484
2025-08-22 20:20:31,008 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:20:31,008 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 20:20:31,345 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:20:31,646 - INFO -    卷积耗时: 0.637 秒
2025-08-22 20:20:31,652 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0032)
2025-08-22 20:20:31,653 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 20:20:31,653 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 20:20:31,726 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 20:20:32,016 - INFO - 🔥 MPS Iter 1 takes 0.076 seconds. Loss: 9.879
2025-08-22 20:20:32,587 - INFO - 🔥 MPS Iter 2 takes 0.366 seconds. Loss: 2.196
2025-08-22 20:20:34,235 - INFO - 🔥 MPS Iter 3 takes 0.962 seconds. Loss: 0.679
2025-08-22 20:20:35,024 - INFO - 🔥 MPS Iter 4 takes 2.587 seconds. Loss: 0.244
2025-08-22 20:20:35,733 - INFO - 🔥 MPS Iter 5 takes 3.375 seconds. Loss: 0.102
2025-08-22 20:20:36,411 - INFO - 🔥 MPS Iter 6 takes 4.083 seconds. Loss: 0.045
2025-08-22 20:20:37,205 - INFO - 🔥 MPS Iter 7 takes 4.760 seconds. Loss: 0.021
2025-08-22 20:20:38,080 - INFO - 🔥 MPS Iter 8 takes 5.554 seconds. Loss: 0.010
2025-08-22 20:20:38,084 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:20:38,084 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:20:38,175 - INFO - 🧹 GPU memory cleared
2025-08-22 20:20:40,115 - INFO -    RWR 耗时: 8.468 秒
2025-08-22 20:20:41,198 - INFO -    归一化耗时: 1.083 秒
2025-08-22 20:20:48,583 - INFO -    ✅ 完成，总耗时: 10.188 秒
2025-08-22 20:20:48,591 - INFO -   ✅ chr14: 完成，耗时 17.61 秒
2025-08-22 20:20:48,592 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-22 20:20:48,601 - INFO -    矩阵大小: (5203, 5203), 非零元素: 16416, 稀疏度: 0.000606
2025-08-22 20:20:48,602 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:20:48,602 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-22 20:20:48,729 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:20:48,928 - INFO -    卷积耗时: 0.326 秒
2025-08-22 20:20:48,934 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0039)
2025-08-22 20:20:48,934 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-22 20:20:48,934 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-22 20:20:48,990 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-22 20:20:49,132 - INFO - 🔥 MPS Iter 1 takes 0.057 seconds. Loss: 8.840
2025-08-22 20:20:49,275 - INFO - 🔥 MPS Iter 2 takes 0.199 seconds. Loss: 1.807
2025-08-22 20:20:49,442 - INFO - 🔥 MPS Iter 3 takes 0.342 seconds. Loss: 0.474
2025-08-22 20:20:49,715 - INFO - 🔥 MPS Iter 4 takes 0.510 seconds. Loss: 0.131
2025-08-22 20:20:50,284 - INFO - 🔥 MPS Iter 5 takes 0.782 seconds. Loss: 0.041
2025-08-22 20:20:51,005 - INFO - 🔥 MPS Iter 6 takes 1.352 seconds. Loss: 0.013
2025-08-22 20:20:51,558 - INFO - 🔥 MPS Iter 7 takes 2.073 seconds. Loss: 0.005
2025-08-22 20:20:51,560 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:20:51,560 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:20:51,569 - INFO - 🧹 GPU memory cleared
2025-08-22 20:20:52,765 - INFO -    RWR 耗时: 3.836 秒
2025-08-22 20:20:53,522 - INFO -    归一化耗时: 0.756 秒
2025-08-22 20:20:58,888 - INFO -    ✅ 完成，总耗时: 4.919 秒
2025-08-22 20:20:58,892 - INFO -   ✅ chr15: 完成，耗时 10.30 秒
2025-08-22 20:20:58,893 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-22 20:20:58,902 - INFO -    矩阵大小: (4911, 4911), 非零元素: 15808, 稀疏度: 0.000655
2025-08-22 20:20:58,903 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:20:58,903 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-22 20:20:59,009 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:20:59,266 - INFO -    卷积耗时: 0.363 秒
2025-08-22 20:20:59,275 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0042)
2025-08-22 20:20:59,275 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-22 20:20:59,275 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-22 20:20:59,343 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-22 20:20:59,463 - INFO - 🔥 MPS Iter 1 takes 0.070 seconds. Loss: 8.394
2025-08-22 20:20:59,578 - INFO - 🔥 MPS Iter 2 takes 0.190 seconds. Loss: 1.704
2025-08-22 20:20:59,708 - INFO - 🔥 MPS Iter 3 takes 0.305 seconds. Loss: 0.441
2025-08-22 20:20:59,871 - INFO - 🔥 MPS Iter 4 takes 0.434 seconds. Loss: 0.121
2025-08-22 20:21:00,247 - INFO - 🔥 MPS Iter 5 takes 0.599 seconds. Loss: 0.038
2025-08-22 20:21:00,899 - INFO - 🔥 MPS Iter 6 takes 0.975 seconds. Loss: 0.012
2025-08-22 20:21:01,451 - INFO - 🔥 MPS Iter 7 takes 1.627 seconds. Loss: 0.004
2025-08-22 20:21:01,456 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:21:01,456 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:21:01,469 - INFO - 🧹 GPU memory cleared
2025-08-22 20:21:02,665 - INFO -    RWR 耗时: 3.397 秒
2025-08-22 20:21:03,505 - INFO -    归一化耗时: 0.840 秒
2025-08-22 20:21:08,149 - INFO -    ✅ 完成，总耗时: 4.600 秒
2025-08-22 20:21:08,153 - INFO -   ✅ chr16: 完成，耗时 9.26 秒
2025-08-22 20:21:08,154 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-22 20:21:08,162 - INFO -    矩阵大小: (4750, 4750), 非零元素: 15523, 稀疏度: 0.000688
2025-08-22 20:21:08,163 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:21:08,163 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-22 20:21:08,230 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:21:08,402 - INFO -    卷积耗时: 0.239 秒
2025-08-22 20:21:08,408 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0044)
2025-08-22 20:21:08,408 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-22 20:21:08,408 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-22 20:21:08,476 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-22 20:21:08,603 - INFO - 🔥 MPS Iter 1 takes 0.071 seconds. Loss: 8.276
2025-08-22 20:21:08,727 - INFO - 🔥 MPS Iter 2 takes 0.199 seconds. Loss: 1.687
2025-08-22 20:21:08,858 - INFO - 🔥 MPS Iter 3 takes 0.330 seconds. Loss: 0.445
2025-08-22 20:21:09,000 - INFO - 🔥 MPS Iter 4 takes 0.452 seconds. Loss: 0.127
2025-08-22 20:21:09,237 - INFO - 🔥 MPS Iter 5 takes 0.594 seconds. Loss: 0.041
2025-08-22 20:21:09,841 - INFO - 🔥 MPS Iter 6 takes 0.832 seconds. Loss: 0.014
2025-08-22 20:21:10,354 - INFO - 🔥 MPS Iter 7 takes 1.436 seconds. Loss: 0.005
2025-08-22 20:21:10,356 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:21:10,356 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:21:10,366 - INFO - 🧹 GPU memory cleared
2025-08-22 20:21:11,328 - INFO -    RWR 耗时: 2.924 秒
2025-08-22 20:21:12,249 - INFO -    归一化耗时: 0.921 秒
2025-08-22 20:21:16,992 - INFO -    ✅ 完成，总耗时: 4.084 秒
2025-08-22 20:21:16,996 - INFO -   ✅ chr17: 完成，耗时 8.84 秒
2025-08-22 20:21:16,996 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-22 20:21:17,002 - INFO -    矩阵大小: (4536, 4536), 非零元素: 14542, 稀疏度: 0.000707
2025-08-22 20:21:17,004 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:21:17,004 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-22 20:21:17,072 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:21:17,234 - INFO -    卷积耗时: 0.230 秒
2025-08-22 20:21:17,239 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0045)
2025-08-22 20:21:17,239 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-22 20:21:17,239 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-22 20:21:17,291 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-22 20:21:17,390 - INFO - 🔥 MPS Iter 1 takes 0.053 seconds. Loss: 8.107
2025-08-22 20:21:17,480 - INFO - 🔥 MPS Iter 2 takes 0.153 seconds. Loss: 1.617
2025-08-22 20:21:17,578 - INFO - 🔥 MPS Iter 3 takes 0.243 seconds. Loss: 0.412
2025-08-22 20:21:17,689 - INFO - 🔥 MPS Iter 4 takes 0.341 seconds. Loss: 0.111
2025-08-22 20:21:17,831 - INFO - 🔥 MPS Iter 5 takes 0.454 seconds. Loss: 0.034
2025-08-22 20:21:18,113 - INFO - 🔥 MPS Iter 6 takes 0.593 seconds. Loss: 0.011
2025-08-22 20:21:18,815 - INFO - 🔥 MPS Iter 7 takes 0.879 seconds. Loss: 0.004
2025-08-22 20:21:18,816 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:21:18,816 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:21:18,826 - INFO - 🧹 GPU memory cleared
2025-08-22 20:21:19,586 - INFO -    RWR 耗时: 2.350 秒
2025-08-22 20:21:20,398 - INFO -    归一化耗时: 0.812 秒
2025-08-22 20:21:23,862 - INFO -    ✅ 完成，总耗时: 3.392 秒
2025-08-22 20:21:23,866 - INFO -   ✅ chr18: 完成，耗时 6.87 秒
2025-08-22 20:21:23,867 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-22 20:21:23,871 - INFO -    矩阵大小: (3072, 3072), 非零元素: 10860, 稀疏度: 0.001151
2025-08-22 20:21:23,872 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:21:23,872 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-22 20:21:23,928 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:21:23,976 - INFO -    卷积耗时: 0.104 秒
2025-08-22 20:21:23,978 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0070)
2025-08-22 20:21:23,978 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-22 20:21:23,978 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-22 20:21:24,047 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-22 20:21:24,083 - INFO - 🔥 MPS Iter 1 takes 0.070 seconds. Loss: 6.348
2025-08-22 20:21:24,110 - INFO - 🔥 MPS Iter 2 takes 0.107 seconds. Loss: 1.360
2025-08-22 20:21:24,137 - INFO - 🔥 MPS Iter 3 takes 0.133 seconds. Loss: 0.421
2025-08-22 20:21:24,164 - INFO - 🔥 MPS Iter 4 takes 0.160 seconds. Loss: 0.161
2025-08-22 20:21:24,191 - INFO - 🔥 MPS Iter 5 takes 0.187 seconds. Loss: 0.072
2025-08-22 20:21:24,218 - INFO - 🔥 MPS Iter 6 takes 0.214 seconds. Loss: 0.034
2025-08-22 20:21:24,245 - INFO - 🔥 MPS Iter 7 takes 0.240 seconds. Loss: 0.017
2025-08-22 20:21:24,273 - INFO - 🔥 MPS Iter 8 takes 0.268 seconds. Loss: 0.008
2025-08-22 20:21:24,274 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:21:24,274 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:21:24,276 - INFO - 🧹 GPU memory cleared
2025-08-22 20:21:24,440 - INFO -    RWR 耗时: 0.464 秒
2025-08-22 20:21:24,610 - INFO -    归一化耗时: 0.170 秒
2025-08-22 20:21:25,997 - INFO -    ✅ 完成，总耗时: 0.738 秒
2025-08-22 20:21:26,001 - INFO -   ✅ chr19: 完成，耗时 2.13 秒
2025-08-22 20:21:26,003 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-22 20:21:26,008 - INFO -    矩阵大小: (8552, 8552), 非零元素: 20332, 稀疏度: 0.000278
2025-08-22 20:21:26,009 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:21:26,009 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-22 20:21:26,260 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:21:26,697 - INFO -    卷积耗时: 0.688 秒
2025-08-22 20:21:26,704 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0021)
2025-08-22 20:21:26,704 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-22 20:21:26,704 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-22 20:21:26,921 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-22 20:21:29,275 - INFO - 🔥 MPS Iter 1 takes 0.220 seconds. Loss: 12.179
2025-08-22 20:21:31,167 - INFO - 🔥 MPS Iter 2 takes 2.577 seconds. Loss: 2.712
2025-08-22 20:21:33,763 - INFO - 🔥 MPS Iter 3 takes 4.477 seconds. Loss: 0.787
2025-08-22 20:21:35,769 - INFO - 🔥 MPS Iter 4 takes 7.064 seconds. Loss: 0.244
2025-08-22 20:21:38,056 - INFO - 🔥 MPS Iter 5 takes 9.069 seconds. Loss: 0.087
2025-08-22 20:21:40,389 - INFO - 🔥 MPS Iter 6 takes 11.357 seconds. Loss: 0.033
2025-08-22 20:21:42,552 - INFO - 🔥 MPS Iter 7 takes 13.689 seconds. Loss: 0.014
2025-08-22 20:21:44,836 - INFO - 🔥 MPS Iter 8 takes 15.895 seconds. Loss: 0.006
2025-08-22 20:21:44,839 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:21:44,839 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:21:45,075 - INFO - 🧹 GPU memory cleared
2025-08-22 20:21:47,684 - INFO -    RWR 耗时: 20.985 秒
2025-08-22 20:21:49,616 - INFO -    归一化耗时: 1.932 秒
2025-08-22 20:22:03,226 - INFO -    ✅ 完成，总耗时: 23.605 秒
2025-08-22 20:22:03,238 - INFO -   ✅ chrX: 完成，耗时 37.24 秒
2025-08-22 20:22:03,239 - INFO - 🎯 细胞 GasdE701005 完成: 20 成功, 0 失败, 总耗时 7.3 分钟
2025-08-22 20:22:03,239 - INFO - 📊 Stage E70: 处理细胞 5/557
2025-08-22 20:22:03,239 - INFO - 🧬 开始处理细胞: GasdE701006
2025-08-22 20:22:03,241 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 20:22:03,256 - INFO -    矩阵大小: (9774, 9774), 非零元素: 40584, 稀疏度: 0.000425
2025-08-22 20:22:03,257 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:22:03,257 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-22 20:22:04,111 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:22:04,838 - INFO -    卷积耗时: 1.581 秒
2025-08-22 20:22:04,848 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0029)
2025-08-22 20:22:04,848 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-22 20:22:04,848 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-22 20:22:04,925 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-22 20:22:08,464 - INFO - 🔥 MPS Iter 1 takes 0.079 seconds. Loss: 10.374
2025-08-22 20:22:11,628 - INFO - 🔥 MPS Iter 2 takes 3.621 seconds. Loss: 1.906
2025-08-22 20:22:15,169 - INFO - 🔥 MPS Iter 3 takes 6.783 seconds. Loss: 0.451
2025-08-22 20:22:18,596 - INFO - 🔥 MPS Iter 4 takes 10.325 seconds. Loss: 0.116
2025-08-22 20:22:21,767 - INFO - 🔥 MPS Iter 5 takes 13.754 seconds. Loss: 0.034
2025-08-22 20:22:25,313 - INFO - 🔥 MPS Iter 6 takes 16.940 seconds. Loss: 0.011
2025-08-22 20:22:28,927 - INFO - 🔥 MPS Iter 7 takes 20.468 seconds. Loss: 0.004
2025-08-22 20:22:28,929 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:22:28,930 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:22:29,076 - INFO - 🧹 GPU memory cleared
2025-08-22 20:22:32,138 - INFO -    RWR 耗时: 27.299 秒
2025-08-22 20:22:34,928 - INFO -    归一化耗时: 2.790 秒
2025-08-22 20:23:26,467 - INFO -    ✅ 完成，总耗时: 31.669 秒
2025-08-22 20:23:26,485 - INFO -   ✅ chr1: 完成，耗时 83.24 秒
2025-08-22 20:23:26,487 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 20:23:26,497 - INFO -    矩阵大小: (9106, 9106), 非零元素: 40778, 稀疏度: 0.000492
2025-08-22 20:23:26,498 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:23:26,498 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-22 20:23:26,956 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:23:27,378 - INFO -    卷积耗时: 0.880 秒
2025-08-22 20:23:27,385 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0033)
2025-08-22 20:23:27,385 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-22 20:23:27,385 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-22 20:23:27,447 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-22 20:23:30,056 - INFO - 🔥 MPS Iter 1 takes 0.064 seconds. Loss: 9.483
2025-08-22 20:23:33,033 - INFO - 🔥 MPS Iter 2 takes 2.674 seconds. Loss: 1.658
2025-08-22 20:23:35,734 - INFO - 🔥 MPS Iter 3 takes 5.658 seconds. Loss: 0.381
2025-08-22 20:23:38,630 - INFO - 🔥 MPS Iter 4 takes 8.352 seconds. Loss: 0.097
2025-08-22 20:23:41,302 - INFO - 🔥 MPS Iter 5 takes 11.251 seconds. Loss: 0.029
2025-08-22 20:23:44,443 - INFO - 🔥 MPS Iter 6 takes 13.922 seconds. Loss: 0.010
2025-08-22 20:23:44,445 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:23:44,446 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:23:44,494 - INFO - 🧹 GPU memory cleared
2025-08-22 20:23:46,735 - INFO -    RWR 耗时: 19.355 秒
2025-08-22 20:23:48,689 - INFO -    归一化耗时: 1.950 秒
2025-08-22 20:24:22,848 - INFO -    ✅ 完成，总耗时: 22.185 秒
2025-08-22 20:24:22,866 - INFO -   ✅ chr2: 完成，耗时 56.38 秒
2025-08-22 20:24:22,867 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 20:24:22,874 - INFO -    矩阵大小: (8002, 8002), 非零元素: 33682, 稀疏度: 0.000526
2025-08-22 20:24:22,875 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:24:22,875 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 20:24:23,121 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:24:23,472 - INFO -    卷积耗时: 0.597 秒
2025-08-22 20:24:23,478 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0037)
2025-08-22 20:24:23,478 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 20:24:23,478 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 20:24:23,543 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 20:24:24,250 - INFO - 🔥 MPS Iter 1 takes 0.066 seconds. Loss: 9.206
2025-08-22 20:24:26,437 - INFO - 🔥 MPS Iter 2 takes 0.773 seconds. Loss: 1.673
2025-08-22 20:24:28,628 - INFO - 🔥 MPS Iter 3 takes 2.961 seconds. Loss: 0.393
2025-08-22 20:24:30,188 - INFO - 🔥 MPS Iter 4 takes 5.153 seconds. Loss: 0.101
2025-08-22 20:24:31,586 - INFO - 🔥 MPS Iter 5 takes 6.716 seconds. Loss: 0.030
2025-08-22 20:24:33,541 - INFO - 🔥 MPS Iter 6 takes 8.109 seconds. Loss: 0.010
2025-08-22 20:24:33,543 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:24:33,543 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:24:33,586 - INFO - 🧹 GPU memory cleared
2025-08-22 20:24:35,420 - INFO -    RWR 耗时: 11.947 秒
2025-08-22 20:24:36,842 - INFO -    归一化耗时: 1.422 秒
2025-08-22 20:24:46,700 - INFO -    ✅ 完成，总耗时: 13.966 秒
2025-08-22 20:24:46,714 - INFO -   ✅ chr3: 完成，耗时 23.85 秒
2025-08-22 20:24:46,714 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 20:24:46,721 - INFO -    矩阵大小: (7826, 7826), 非零元素: 31943, 稀疏度: 0.000522
2025-08-22 20:24:46,722 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:24:46,722 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 20:24:46,834 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:24:47,156 - INFO -    卷积耗时: 0.434 秒
2025-08-22 20:24:47,162 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0035)
2025-08-22 20:24:47,162 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 20:24:47,162 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 20:24:47,216 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 20:24:47,842 - INFO - 🔥 MPS Iter 1 takes 0.056 seconds. Loss: 9.264
2025-08-22 20:24:50,173 - INFO - 🔥 MPS Iter 2 takes 0.682 seconds. Loss: 1.676
2025-08-22 20:24:51,642 - INFO - 🔥 MPS Iter 3 takes 3.014 seconds. Loss: 0.399
2025-08-22 20:24:53,331 - INFO - 🔥 MPS Iter 4 takes 4.482 seconds. Loss: 0.104
2025-08-22 20:24:54,874 - INFO - 🔥 MPS Iter 5 takes 6.172 seconds. Loss: 0.031
2025-08-22 20:24:56,176 - INFO - 🔥 MPS Iter 6 takes 7.714 seconds. Loss: 0.010
2025-08-22 20:24:57,845 - INFO - 🔥 MPS Iter 7 takes 9.016 seconds. Loss: 0.004
2025-08-22 20:24:57,851 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:24:57,851 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:24:57,890 - INFO - 🧹 GPU memory cleared
2025-08-22 20:24:59,569 - INFO -    RWR 耗时: 12.412 秒
2025-08-22 20:25:00,775 - INFO -    归一化耗时: 1.206 秒
2025-08-22 20:25:09,473 - INFO -    ✅ 完成，总耗时: 14.052 秒
2025-08-22 20:25:09,479 - INFO -   ✅ chr4: 完成，耗时 22.76 秒
2025-08-22 20:25:09,480 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 20:25:09,487 - INFO -    矩阵大小: (7592, 7592), 非零元素: 32259, 稀疏度: 0.000560
2025-08-22 20:25:09,487 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:25:09,487 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 20:25:09,584 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:25:09,837 - INFO -    卷积耗时: 0.349 秒
2025-08-22 20:25:09,842 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0038)
2025-08-22 20:25:09,842 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 20:25:09,842 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 20:25:09,888 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 20:25:10,387 - INFO - 🔥 MPS Iter 1 takes 0.048 seconds. Loss: 8.887
2025-08-22 20:25:12,018 - INFO - 🔥 MPS Iter 2 takes 0.548 seconds. Loss: 1.588
2025-08-22 20:25:13,852 - INFO - 🔥 MPS Iter 3 takes 2.177 seconds. Loss: 0.372
2025-08-22 20:25:15,063 - INFO - 🔥 MPS Iter 4 takes 4.013 seconds. Loss: 0.094
2025-08-22 20:25:16,155 - INFO - 🔥 MPS Iter 5 takes 5.222 seconds. Loss: 0.028
2025-08-22 20:25:17,682 - INFO - 🔥 MPS Iter 6 takes 6.315 seconds. Loss: 0.009
2025-08-22 20:25:17,683 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:25:17,683 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:25:17,720 - INFO - 🧹 GPU memory cleared
2025-08-22 20:25:19,206 - INFO -    RWR 耗时: 9.368 秒
2025-08-22 20:25:20,383 - INFO -    归一化耗时: 1.177 秒
2025-08-22 20:25:28,412 - INFO -    ✅ 完成，总耗时: 10.895 秒
2025-08-22 20:25:28,422 - INFO -   ✅ chr5: 完成，耗时 18.94 秒
2025-08-22 20:25:28,423 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-22 20:25:28,430 - INFO -    矩阵大小: (7487, 7487), 非零元素: 31868, 稀疏度: 0.000569
2025-08-22 20:25:28,430 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:25:28,430 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-22 20:25:28,524 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:25:28,767 - INFO -    卷积耗时: 0.337 秒
2025-08-22 20:25:28,772 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0040)
2025-08-22 20:25:28,772 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-22 20:25:28,772 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-22 20:25:28,822 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-22 20:25:29,328 - INFO - 🔥 MPS Iter 1 takes 0.051 seconds. Loss: 8.840
2025-08-22 20:25:31,070 - INFO - 🔥 MPS Iter 2 takes 0.564 seconds. Loss: 1.604
2025-08-22 20:25:32,635 - INFO - 🔥 MPS Iter 3 takes 2.299 seconds. Loss: 0.380
2025-08-22 20:25:34,013 - INFO - 🔥 MPS Iter 4 takes 3.864 seconds. Loss: 0.100
2025-08-22 20:25:35,073 - INFO - 🔥 MPS Iter 5 takes 5.242 seconds. Loss: 0.031
2025-08-22 20:25:36,256 - INFO - 🔥 MPS Iter 6 takes 6.302 seconds. Loss: 0.010
2025-08-22 20:25:37,706 - INFO - 🔥 MPS Iter 7 takes 7.485 seconds. Loss: 0.004
2025-08-22 20:25:37,708 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:25:37,709 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:25:37,730 - INFO - 🧹 GPU memory cleared
2025-08-22 20:25:39,324 - INFO -    RWR 耗时: 10.556 秒
2025-08-22 20:25:40,521 - INFO -    归一化耗时: 1.196 秒
2025-08-22 20:25:48,587 - INFO -    ✅ 完成，总耗时: 12.090 秒
2025-08-22 20:25:48,597 - INFO -   ✅ chr6: 完成，耗时 20.17 秒
2025-08-22 20:25:48,599 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-22 20:25:48,606 - INFO -    矩阵大小: (7273, 7273), 非零元素: 30765, 稀疏度: 0.000582
2025-08-22 20:25:48,607 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:25:48,607 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-22 20:25:48,876 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:25:49,139 - INFO -    卷积耗时: 0.532 秒
2025-08-22 20:25:49,144 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0039)
2025-08-22 20:25:49,144 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-22 20:25:49,144 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-22 20:25:49,199 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-22 20:25:49,619 - INFO - 🔥 MPS Iter 1 takes 0.057 seconds. Loss: 9.108
2025-08-22 20:25:50,744 - INFO - 🔥 MPS Iter 2 takes 0.476 seconds. Loss: 1.722
2025-08-22 20:25:52,496 - INFO - 🔥 MPS Iter 3 takes 1.605 seconds. Loss: 0.456
2025-08-22 20:25:53,877 - INFO - 🔥 MPS Iter 4 takes 3.355 seconds. Loss: 0.136
2025-08-22 20:25:54,950 - INFO - 🔥 MPS Iter 5 takes 4.735 seconds. Loss: 0.048
2025-08-22 20:25:55,944 - INFO - 🔥 MPS Iter 6 takes 5.807 seconds. Loss: 0.018
2025-08-22 20:25:57,249 - INFO - 🔥 MPS Iter 7 takes 6.802 seconds. Loss: 0.007
2025-08-22 20:25:57,250 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:25:57,250 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:25:57,285 - INFO - 🧹 GPU memory cleared
2025-08-22 20:25:58,720 - INFO -    RWR 耗时: 9.580 秒
2025-08-22 20:25:59,747 - INFO -    归一化耗时: 1.027 秒
2025-08-22 20:26:06,835 - INFO -    ✅ 完成，总耗时: 11.139 秒
2025-08-22 20:26:06,842 - INFO -   ✅ chr7: 完成，耗时 18.24 秒
2025-08-22 20:26:06,844 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-22 20:26:06,850 - INFO -    矩阵大小: (6471, 6471), 非零元素: 25042, 稀疏度: 0.000598
2025-08-22 20:26:06,851 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:26:06,851 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-22 20:26:06,936 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:26:07,128 - INFO -    卷积耗时: 0.277 秒
2025-08-22 20:26:07,131 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0040)
2025-08-22 20:26:07,131 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-22 20:26:07,131 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-22 20:26:07,187 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-22 20:26:07,478 - INFO - 🔥 MPS Iter 1 takes 0.056 seconds. Loss: 8.813
2025-08-22 20:26:07,962 - INFO - 🔥 MPS Iter 2 takes 0.348 seconds. Loss: 1.657
2025-08-22 20:26:09,468 - INFO - 🔥 MPS Iter 3 takes 0.831 seconds. Loss: 0.409
2025-08-22 20:26:10,443 - INFO - 🔥 MPS Iter 4 takes 2.339 seconds. Loss: 0.109
2025-08-22 20:26:11,152 - INFO - 🔥 MPS Iter 5 takes 3.313 seconds. Loss: 0.034
2025-08-22 20:26:11,986 - INFO - 🔥 MPS Iter 6 takes 4.022 seconds. Loss: 0.011
2025-08-22 20:26:12,933 - INFO - 🔥 MPS Iter 7 takes 4.859 seconds. Loss: 0.004
2025-08-22 20:26:12,935 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:26:12,935 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:26:12,956 - INFO - 🧹 GPU memory cleared
2025-08-22 20:26:14,472 - INFO -    RWR 耗时: 7.344 秒
2025-08-22 20:26:15,450 - INFO -    归一化耗时: 0.973 秒
2025-08-22 20:26:21,130 - INFO -    ✅ 完成，总耗时: 8.594 秒
2025-08-22 20:26:21,136 - INFO -   ✅ chr8: 完成，耗时 14.29 秒
2025-08-22 20:26:21,142 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-22 20:26:21,160 - INFO -    矩阵大小: (6230, 6230), 非零元素: 25520, 稀疏度: 0.000658
2025-08-22 20:26:21,161 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:26:21,161 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-22 20:26:21,276 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:26:21,459 - INFO -    卷积耗时: 0.298 秒
2025-08-22 20:26:21,463 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0042)
2025-08-22 20:26:21,463 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-22 20:26:21,463 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-22 20:26:21,524 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-22 20:26:21,811 - INFO - 🔥 MPS Iter 1 takes 0.062 seconds. Loss: 8.397
2025-08-22 20:26:22,183 - INFO - 🔥 MPS Iter 2 takes 0.349 seconds. Loss: 1.554
2025-08-22 20:26:23,648 - INFO - 🔥 MPS Iter 3 takes 0.721 seconds. Loss: 0.375
2025-08-22 20:26:24,667 - INFO - 🔥 MPS Iter 4 takes 2.198 seconds. Loss: 0.100
2025-08-22 20:26:25,358 - INFO - 🔥 MPS Iter 5 takes 3.206 seconds. Loss: 0.031
2025-08-22 20:26:25,968 - INFO - 🔥 MPS Iter 6 takes 3.897 seconds. Loss: 0.010
2025-08-22 20:26:26,607 - INFO - 🔥 MPS Iter 7 takes 4.507 seconds. Loss: 0.004
2025-08-22 20:26:26,609 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:26:26,609 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:26:26,629 - INFO - 🧹 GPU memory cleared
2025-08-22 20:26:28,089 - INFO -    RWR 耗时: 6.629 秒
2025-08-22 20:26:29,323 - INFO -    归一化耗时: 1.234 秒
2025-08-22 20:26:37,251 - INFO -    ✅ 完成，总耗时: 8.161 秒
2025-08-22 20:26:37,259 - INFO -   ✅ chr9: 完成，耗时 16.12 秒
2025-08-22 20:26:37,260 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-22 20:26:37,269 - INFO -    矩阵大小: (6535, 6535), 非零元素: 24695, 稀疏度: 0.000578
2025-08-22 20:26:37,270 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:26:37,270 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-22 20:26:37,386 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:26:37,668 - INFO -    卷积耗时: 0.398 秒
2025-08-22 20:26:37,678 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0039)
2025-08-22 20:26:37,678 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-22 20:26:37,678 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-22 20:26:37,740 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-22 20:26:38,078 - INFO - 🔥 MPS Iter 1 takes 0.065 seconds. Loss: 8.844
2025-08-22 20:26:38,760 - INFO - 🔥 MPS Iter 2 takes 0.402 seconds. Loss: 1.662
2025-08-22 20:26:40,132 - INFO - 🔥 MPS Iter 3 takes 1.084 seconds. Loss: 0.409
2025-08-22 20:26:40,913 - INFO - 🔥 MPS Iter 4 takes 2.457 seconds. Loss: 0.110
2025-08-22 20:26:41,842 - INFO - 🔥 MPS Iter 5 takes 3.238 seconds. Loss: 0.035
2025-08-22 20:26:42,745 - INFO - 🔥 MPS Iter 6 takes 4.166 seconds. Loss: 0.012
2025-08-22 20:26:43,685 - INFO - 🔥 MPS Iter 7 takes 5.069 seconds. Loss: 0.004
2025-08-22 20:26:43,686 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:26:43,686 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:26:43,725 - INFO - 🧹 GPU memory cleared
2025-08-22 20:26:45,394 - INFO -    RWR 耗时: 7.722 秒
2025-08-22 20:26:46,605 - INFO -    归一化耗时: 1.211 秒
2025-08-22 20:26:55,217 - INFO -    ✅ 完成，总耗时: 9.331 秒
2025-08-22 20:26:55,230 - INFO -   ✅ chr10: 完成，耗时 17.97 秒
2025-08-22 20:26:55,235 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-22 20:26:55,261 - INFO -    矩阵大小: (6105, 6105), 非零元素: 23939, 稀疏度: 0.000642
2025-08-22 20:26:55,263 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:26:55,263 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-22 20:26:55,391 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:26:55,645 - INFO -    卷积耗时: 0.383 秒
2025-08-22 20:26:55,652 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0041)
2025-08-22 20:26:55,652 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-22 20:26:55,652 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-22 20:26:55,704 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-22 20:26:55,916 - INFO - 🔥 MPS Iter 1 takes 0.053 seconds. Loss: 8.446
2025-08-22 20:26:56,202 - INFO - 🔥 MPS Iter 2 takes 0.266 seconds. Loss: 1.564
2025-08-22 20:26:57,139 - INFO - 🔥 MPS Iter 3 takes 0.552 seconds. Loss: 0.379
2025-08-22 20:26:58,264 - INFO - 🔥 MPS Iter 4 takes 1.491 seconds. Loss: 0.101
2025-08-22 20:26:59,076 - INFO - 🔥 MPS Iter 5 takes 2.634 seconds. Loss: 0.032
2025-08-22 20:26:59,733 - INFO - 🔥 MPS Iter 6 takes 3.426 seconds. Loss: 0.011
2025-08-22 20:27:00,362 - INFO - 🔥 MPS Iter 7 takes 4.083 seconds. Loss: 0.004
2025-08-22 20:27:00,364 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:27:00,364 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:27:00,417 - INFO - 🧹 GPU memory cleared
2025-08-22 20:27:01,746 - INFO -    RWR 耗时: 6.099 秒
2025-08-22 20:27:02,843 - INFO -    归一化耗时: 1.097 秒
2025-08-22 20:27:10,442 - INFO -    ✅ 完成，总耗时: 7.579 秒
2025-08-22 20:27:10,450 - INFO -   ✅ chr11: 完成，耗时 15.22 秒
2025-08-22 20:27:10,451 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-22 20:27:10,458 - INFO -    矩阵大小: (6007, 6007), 非零元素: 25619, 稀疏度: 0.000710
2025-08-22 20:27:10,460 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:27:10,460 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-22 20:27:10,555 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:27:10,816 - INFO -    卷积耗时: 0.356 秒
2025-08-22 20:27:10,822 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0048)
2025-08-22 20:27:10,822 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-22 20:27:10,822 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-22 20:27:10,873 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-22 20:27:11,090 - INFO - 🔥 MPS Iter 1 takes 0.052 seconds. Loss: 8.143
2025-08-22 20:27:11,497 - INFO - 🔥 MPS Iter 2 takes 0.269 seconds. Loss: 1.511
2025-08-22 20:27:12,312 - INFO - 🔥 MPS Iter 3 takes 0.676 seconds. Loss: 0.407
2025-08-22 20:27:13,549 - INFO - 🔥 MPS Iter 4 takes 1.493 seconds. Loss: 0.133
2025-08-22 20:27:14,307 - INFO - 🔥 MPS Iter 5 takes 2.730 seconds. Loss: 0.052
2025-08-22 20:27:14,931 - INFO - 🔥 MPS Iter 6 takes 3.486 seconds. Loss: 0.022
2025-08-22 20:27:15,510 - INFO - 🔥 MPS Iter 7 takes 4.111 seconds. Loss: 0.010
2025-08-22 20:27:15,543 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:27:15,545 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:27:15,592 - INFO - 🧹 GPU memory cleared
2025-08-22 20:27:16,870 - INFO -    RWR 耗时: 6.053 秒
2025-08-22 20:27:17,914 - INFO -    归一化耗时: 1.044 秒
2025-08-22 20:27:25,770 - INFO -    ✅ 完成，总耗时: 7.452 秒
2025-08-22 20:27:25,777 - INFO -   ✅ chr12: 完成，耗时 15.33 秒
2025-08-22 20:27:25,785 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-22 20:27:25,793 - INFO -    矩阵大小: (6022, 6022), 非零元素: 27461, 稀疏度: 0.000757
2025-08-22 20:27:25,794 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:27:25,794 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-22 20:27:25,892 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:27:26,159 - INFO -    卷积耗时: 0.365 秒
2025-08-22 20:27:26,165 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0051)
2025-08-22 20:27:26,165 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-22 20:27:26,165 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-22 20:27:26,222 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-22 20:27:26,455 - INFO - 🔥 MPS Iter 1 takes 0.059 seconds. Loss: 7.675
2025-08-22 20:27:26,777 - INFO - 🔥 MPS Iter 2 takes 0.292 seconds. Loss: 1.377
2025-08-22 20:27:27,933 - INFO - 🔥 MPS Iter 3 takes 0.615 seconds. Loss: 0.335
2025-08-22 20:27:28,927 - INFO - 🔥 MPS Iter 4 takes 1.772 seconds. Loss: 0.093
2025-08-22 20:27:29,611 - INFO - 🔥 MPS Iter 5 takes 2.764 seconds. Loss: 0.030
2025-08-22 20:27:30,140 - INFO - 🔥 MPS Iter 6 takes 3.452 seconds. Loss: 0.010
2025-08-22 20:27:30,782 - INFO - 🔥 MPS Iter 7 takes 3.977 seconds. Loss: 0.004
2025-08-22 20:27:30,784 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:27:30,784 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:27:30,818 - INFO - 🧹 GPU memory cleared
2025-08-22 20:27:32,227 - INFO -    RWR 耗时: 6.067 秒
2025-08-22 20:27:33,394 - INFO -    归一化耗时: 1.166 秒
2025-08-22 20:27:41,165 - INFO -    ✅ 完成，总耗时: 7.598 秒
2025-08-22 20:27:41,177 - INFO -   ✅ chr13: 完成，耗时 15.39 秒
2025-08-22 20:27:41,177 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 20:27:41,186 - INFO -    矩阵大小: (6246, 6246), 非零元素: 24909, 稀疏度: 0.000638
2025-08-22 20:27:41,187 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:27:41,187 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 20:27:41,290 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:27:41,585 - INFO -    卷积耗时: 0.398 秒
2025-08-22 20:27:41,592 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0043)
2025-08-22 20:27:41,592 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 20:27:41,592 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 20:27:41,649 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 20:27:41,927 - INFO - 🔥 MPS Iter 1 takes 0.060 seconds. Loss: 8.487
2025-08-22 20:27:42,363 - INFO - 🔥 MPS Iter 2 takes 0.336 seconds. Loss: 1.594
2025-08-22 20:27:43,962 - INFO - 🔥 MPS Iter 3 takes 0.773 seconds. Loss: 0.419
2025-08-22 20:27:44,760 - INFO - 🔥 MPS Iter 4 takes 2.373 seconds. Loss: 0.129
2025-08-22 20:27:45,488 - INFO - 🔥 MPS Iter 5 takes 3.169 seconds. Loss: 0.049
2025-08-22 20:27:46,190 - INFO - 🔥 MPS Iter 6 takes 3.900 seconds. Loss: 0.020
2025-08-22 20:27:47,042 - INFO - 🔥 MPS Iter 7 takes 4.600 seconds. Loss: 0.009
2025-08-22 20:27:47,043 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:27:47,043 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:27:47,081 - INFO - 🧹 GPU memory cleared
2025-08-22 20:27:48,630 - INFO -    RWR 耗时: 7.044 秒
2025-08-22 20:27:49,688 - INFO -    归一化耗时: 1.058 秒
2025-08-22 20:27:55,324 - INFO -    ✅ 完成，总耗时: 8.499 秒
2025-08-22 20:27:55,335 - INFO -   ✅ chr14: 完成，耗时 14.16 秒
2025-08-22 20:27:55,337 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-22 20:27:55,346 - INFO -    矩阵大小: (5203, 5203), 非零元素: 19401, 稀疏度: 0.000717
2025-08-22 20:27:55,347 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:27:55,347 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-22 20:27:55,431 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:27:55,564 - INFO -    卷积耗时: 0.217 秒
2025-08-22 20:27:55,568 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0047)
2025-08-22 20:27:55,568 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-22 20:27:55,568 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-22 20:27:55,614 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-22 20:27:55,747 - INFO - 🔥 MPS Iter 1 takes 0.047 seconds. Loss: 8.044
2025-08-22 20:27:55,887 - INFO - 🔥 MPS Iter 2 takes 0.181 seconds. Loss: 1.545
2025-08-22 20:27:56,049 - INFO - 🔥 MPS Iter 3 takes 0.320 seconds. Loss: 0.385
2025-08-22 20:27:56,316 - INFO - 🔥 MPS Iter 4 takes 0.482 seconds. Loss: 0.106
2025-08-22 20:27:57,209 - INFO - 🔥 MPS Iter 5 takes 0.750 seconds. Loss: 0.034
2025-08-22 20:27:58,014 - INFO - 🔥 MPS Iter 6 takes 1.649 seconds. Loss: 0.011
2025-08-22 20:27:58,595 - INFO - 🔥 MPS Iter 7 takes 2.449 seconds. Loss: 0.004
2025-08-22 20:27:58,596 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:27:58,596 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:27:58,606 - INFO - 🧹 GPU memory cleared
2025-08-22 20:27:59,434 - INFO -    RWR 耗时: 3.868 秒
2025-08-22 20:28:00,237 - INFO -    归一化耗时: 0.803 秒
2025-08-22 20:28:04,047 - INFO -    ✅ 完成，总耗时: 4.888 秒
2025-08-22 20:28:04,051 - INFO -   ✅ chr15: 完成，耗时 8.71 秒
2025-08-22 20:28:04,051 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-22 20:28:04,058 - INFO -    矩阵大小: (4911, 4911), 非零元素: 17119, 稀疏度: 0.000710
2025-08-22 20:28:04,060 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:28:04,060 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-22 20:28:04,131 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:28:04,360 - INFO -    卷积耗时: 0.300 秒
2025-08-22 20:28:04,364 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0047)
2025-08-22 20:28:04,364 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-22 20:28:04,364 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-22 20:28:04,414 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-22 20:28:04,529 - INFO - 🔥 MPS Iter 1 takes 0.051 seconds. Loss: 8.104
2025-08-22 20:28:04,641 - INFO - 🔥 MPS Iter 2 takes 0.167 seconds. Loss: 1.636
2025-08-22 20:28:04,771 - INFO - 🔥 MPS Iter 3 takes 0.278 seconds. Loss: 0.464
2025-08-22 20:28:04,935 - INFO - 🔥 MPS Iter 4 takes 0.409 seconds. Loss: 0.165
2025-08-22 20:28:05,177 - INFO - 🔥 MPS Iter 5 takes 0.572 seconds. Loss: 0.072
2025-08-22 20:28:05,933 - INFO - 🔥 MPS Iter 6 takes 0.817 seconds. Loss: 0.034
2025-08-22 20:28:06,547 - INFO - 🔥 MPS Iter 7 takes 1.572 seconds. Loss: 0.017
2025-08-22 20:28:07,117 - INFO - 🔥 MPS Iter 8 takes 2.185 seconds. Loss: 0.008
2025-08-22 20:28:07,120 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:28:07,120 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:28:07,129 - INFO - 🧹 GPU memory cleared
2025-08-22 20:28:08,281 - INFO -    RWR 耗时: 3.920 秒
2025-08-22 20:28:09,081 - INFO -    归一化耗时: 0.800 秒
2025-08-22 20:28:14,320 - INFO -    ✅ 完成，总耗时: 5.020 秒
2025-08-22 20:28:14,324 - INFO -   ✅ chr16: 完成，耗时 10.27 秒
2025-08-22 20:28:14,324 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-22 20:28:14,341 - INFO -    矩阵大小: (4750, 4750), 非零元素: 17471, 稀疏度: 0.000774
2025-08-22 20:28:14,342 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:28:14,342 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-22 20:28:14,421 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:28:14,584 - INFO -    卷积耗时: 0.242 秒
2025-08-22 20:28:14,589 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0050)
2025-08-22 20:28:14,589 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-22 20:28:14,589 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-22 20:28:14,658 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-22 20:28:14,766 - INFO - 🔥 MPS Iter 1 takes 0.070 seconds. Loss: 7.931
2025-08-22 20:28:14,865 - INFO - 🔥 MPS Iter 2 takes 0.178 seconds. Loss: 1.545
2025-08-22 20:28:14,994 - INFO - 🔥 MPS Iter 3 takes 0.277 seconds. Loss: 0.394
2025-08-22 20:28:15,128 - INFO - 🔥 MPS Iter 4 takes 0.412 seconds. Loss: 0.110
2025-08-22 20:28:15,302 - INFO - 🔥 MPS Iter 5 takes 0.545 seconds. Loss: 0.035
2025-08-22 20:28:15,642 - INFO - 🔥 MPS Iter 6 takes 0.714 seconds. Loss: 0.012
2025-08-22 20:28:16,292 - INFO - 🔥 MPS Iter 7 takes 1.054 seconds. Loss: 0.005
2025-08-22 20:28:16,293 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:28:16,294 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:28:16,312 - INFO - 🧹 GPU memory cleared
2025-08-22 20:28:17,272 - INFO -    RWR 耗时: 2.688 秒
2025-08-22 20:28:18,295 - INFO -    归一化耗时: 1.022 秒
2025-08-22 20:28:22,946 - INFO -    ✅ 完成，总耗时: 3.952 秒
2025-08-22 20:28:22,950 - INFO -   ✅ chr17: 完成，耗时 8.63 秒
2025-08-22 20:28:22,950 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-22 20:28:22,956 - INFO -    矩阵大小: (4536, 4536), 非零元素: 17680, 稀疏度: 0.000859
2025-08-22 20:28:22,957 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:28:22,957 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-22 20:28:23,042 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:28:23,204 - INFO -    卷积耗时: 0.247 秒
2025-08-22 20:28:23,211 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0059)
2025-08-22 20:28:23,212 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-22 20:28:23,212 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-22 20:28:23,269 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-22 20:28:23,368 - INFO - 🔥 MPS Iter 1 takes 0.059 seconds. Loss: 7.194
2025-08-22 20:28:23,455 - INFO - 🔥 MPS Iter 2 takes 0.158 seconds. Loss: 1.325
2025-08-22 20:28:23,553 - INFO - 🔥 MPS Iter 3 takes 0.245 seconds. Loss: 0.314
2025-08-22 20:28:23,670 - INFO - 🔥 MPS Iter 4 takes 0.345 seconds. Loss: 0.081
2025-08-22 20:28:23,808 - INFO - 🔥 MPS Iter 5 takes 0.460 seconds. Loss: 0.024
2025-08-22 20:28:24,078 - INFO - 🔥 MPS Iter 6 takes 0.601 seconds. Loss: 0.008
2025-08-22 20:28:24,081 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:28:24,081 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:28:24,091 - INFO - 🧹 GPU memory cleared
2025-08-22 20:28:24,877 - INFO -    RWR 耗时: 1.671 秒
2025-08-22 20:28:25,880 - INFO -    归一化耗时: 1.002 秒
2025-08-22 20:28:30,366 - INFO -    ✅ 完成，总耗时: 2.920 秒
2025-08-22 20:28:30,370 - INFO -   ✅ chr18: 完成，耗时 7.42 秒
2025-08-22 20:28:30,371 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-22 20:28:30,377 - INFO -    矩阵大小: (3072, 3072), 非零元素: 11258, 稀疏度: 0.001193
2025-08-22 20:28:30,378 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:28:30,378 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-22 20:28:30,429 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:28:30,494 - INFO -    卷积耗时: 0.116 秒
2025-08-22 20:28:30,497 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0075)
2025-08-22 20:28:30,497 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-22 20:28:30,498 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-22 20:28:30,551 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-22 20:28:30,586 - INFO - 🔥 MPS Iter 1 takes 0.055 seconds. Loss: 6.132
2025-08-22 20:28:30,614 - INFO - 🔥 MPS Iter 2 takes 0.090 seconds. Loss: 1.197
2025-08-22 20:28:30,642 - INFO - 🔥 MPS Iter 3 takes 0.117 seconds. Loss: 0.311
2025-08-22 20:28:30,670 - INFO - 🔥 MPS Iter 4 takes 0.146 seconds. Loss: 0.089
2025-08-22 20:28:30,701 - INFO - 🔥 MPS Iter 5 takes 0.175 seconds. Loss: 0.029
2025-08-22 20:28:30,729 - INFO - 🔥 MPS Iter 6 takes 0.204 seconds. Loss: 0.010
2025-08-22 20:28:30,757 - INFO - 🔥 MPS Iter 7 takes 0.232 seconds. Loss: 0.004
2025-08-22 20:28:30,758 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:28:30,758 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:28:30,761 - INFO - 🧹 GPU memory cleared
2025-08-22 20:28:31,029 - INFO -    RWR 耗时: 0.535 秒
2025-08-22 20:28:31,295 - INFO -    归一化耗时: 0.265 秒
2025-08-22 20:28:33,390 - INFO -    ✅ 完成，总耗时: 0.916 秒
2025-08-22 20:28:33,399 - INFO -   ✅ chr19: 完成，耗时 3.03 秒
2025-08-22 20:28:33,400 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-22 20:28:33,405 - INFO -    矩阵大小: (8552, 8552), 非零元素: 13180, 稀疏度: 0.000180
2025-08-22 20:28:33,406 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:28:33,406 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-22 20:28:33,556 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:28:34,110 - INFO -    卷积耗时: 0.705 秒
2025-08-22 20:28:34,115 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0013)
2025-08-22 20:28:34,115 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-22 20:28:34,115 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-22 20:28:34,191 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-22 20:28:35,506 - INFO - 🔥 MPS Iter 1 takes 0.078 seconds. Loss: 15.341
2025-08-22 20:28:38,214 - INFO - 🔥 MPS Iter 2 takes 1.397 seconds. Loss: 4.142
2025-08-22 20:28:40,222 - INFO - 🔥 MPS Iter 3 takes 4.104 seconds. Loss: 1.389
2025-08-22 20:28:42,121 - INFO - 🔥 MPS Iter 4 takes 6.130 seconds. Loss: 0.488
2025-08-22 20:28:44,497 - INFO - 🔥 MPS Iter 5 takes 8.010 seconds. Loss: 0.190
2025-08-22 20:28:46,291 - INFO - 🔥 MPS Iter 6 takes 10.477 seconds. Loss: 0.077
2025-08-22 20:28:48,937 - INFO - 🔥 MPS Iter 7 takes 12.178 seconds. Loss: 0.033
2025-08-22 20:28:50,723 - INFO - 🔥 MPS Iter 8 takes 14.852 seconds. Loss: 0.015
2025-08-22 20:28:52,740 - INFO - 🔥 MPS Iter 9 takes 16.611 seconds. Loss: 0.007
2025-08-22 20:28:52,744 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:28:52,745 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:28:52,806 - INFO - 🧹 GPU memory cleared
2025-08-22 20:28:55,004 - INFO -    RWR 耗时: 20.893 秒
2025-08-22 20:28:56,436 - INFO -    归一化耗时: 1.432 秒
2025-08-22 20:29:06,942 - INFO -    ✅ 完成，总耗时: 23.029 秒
2025-08-22 20:29:06,952 - INFO -   ✅ chrX: 完成，耗时 33.55 秒
2025-08-22 20:29:06,952 - INFO - 🎯 细胞 GasdE701006 完成: 20 成功, 0 失败, 总耗时 7.1 分钟
2025-08-22 20:29:06,953 - INFO - ⏱️  预计剩余时间: 2351.0 分钟
2025-08-22 20:29:06,953 - INFO - 📊 Stage E70: 处理细胞 6/557
2025-08-22 20:29:06,953 - INFO - 🧬 开始处理细胞: GasdE701007
2025-08-22 20:29:06,959 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 20:29:06,973 - INFO -    矩阵大小: (9774, 9774), 非零元素: 54706, 稀疏度: 0.000573
2025-08-22 20:29:06,975 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:29:06,975 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-22 20:29:07,192 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:29:07,833 - INFO -    卷积耗时: 0.858 秒
2025-08-22 20:29:07,847 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0038)
2025-08-22 20:29:07,847 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-22 20:29:07,847 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-22 20:29:07,926 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-22 20:29:11,293 - INFO - 🔥 MPS Iter 1 takes 0.080 seconds. Loss: 8.583
2025-08-22 20:29:14,780 - INFO - 🔥 MPS Iter 2 takes 3.479 seconds. Loss: 1.384
2025-08-22 20:29:18,017 - INFO - 🔥 MPS Iter 3 takes 6.936 seconds. Loss: 0.301
2025-08-22 20:29:21,019 - INFO - 🔥 MPS Iter 4 takes 10.173 seconds. Loss: 0.078
2025-08-22 20:29:24,530 - INFO - 🔥 MPS Iter 5 takes 13.176 seconds. Loss: 0.025
2025-08-22 20:29:27,622 - INFO - 🔥 MPS Iter 6 takes 16.688 seconds. Loss: 0.009
2025-08-22 20:29:27,624 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:29:27,625 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:29:27,787 - INFO - 🧹 GPU memory cleared
2025-08-22 20:29:30,987 - INFO -    RWR 耗时: 23.152 秒
2025-08-22 20:29:33,832 - INFO -    归一化耗时: 2.844 秒
2025-08-22 20:30:17,179 - INFO -    ✅ 完成，总耗时: 26.855 秒
2025-08-22 20:30:17,192 - INFO -   ✅ chr1: 完成，耗时 70.23 秒
2025-08-22 20:30:17,195 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 20:30:17,211 - INFO -    矩阵大小: (9106, 9106), 非零元素: 50379, 稀疏度: 0.000608
2025-08-22 20:30:17,212 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:30:17,213 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-22 20:30:17,561 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:30:17,958 - INFO -    卷积耗时: 0.746 秒
2025-08-22 20:30:17,966 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0040)
2025-08-22 20:30:17,966 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-22 20:30:17,966 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-22 20:30:18,018 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-22 20:30:20,466 - INFO - 🔥 MPS Iter 1 takes 0.054 seconds. Loss: 8.225
2025-08-22 20:30:23,793 - INFO - 🔥 MPS Iter 2 takes 2.504 seconds. Loss: 1.331
2025-08-22 20:30:26,107 - INFO - 🔥 MPS Iter 3 takes 5.830 seconds. Loss: 0.296
2025-08-22 20:30:29,167 - INFO - 🔥 MPS Iter 4 takes 8.143 seconds. Loss: 0.079
2025-08-22 20:30:31,766 - INFO - 🔥 MPS Iter 5 takes 11.205 seconds. Loss: 0.025
2025-08-22 20:30:34,620 - INFO - 🔥 MPS Iter 6 takes 13.802 seconds. Loss: 0.009
2025-08-22 20:30:34,622 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:30:34,622 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:30:34,658 - INFO - 🧹 GPU memory cleared
2025-08-22 20:30:36,910 - INFO -    RWR 耗时: 18.950 秒
2025-08-22 20:30:38,787 - INFO -    归一化耗时: 1.873 秒
2025-08-22 20:31:10,952 - INFO -    ✅ 完成，总耗时: 21.568 秒
2025-08-22 20:31:10,967 - INFO -   ✅ chr2: 完成，耗时 53.77 秒
2025-08-22 20:31:10,968 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 20:31:10,976 - INFO -    矩阵大小: (8002, 8002), 非零元素: 39228, 稀疏度: 0.000613
2025-08-22 20:31:10,977 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:31:10,977 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 20:31:11,170 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:31:11,464 - INFO -    卷积耗时: 0.487 秒
2025-08-22 20:31:11,470 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0040)
2025-08-22 20:31:11,470 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 20:31:11,470 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 20:31:11,521 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 20:31:12,917 - INFO - 🔥 MPS Iter 1 takes 0.053 seconds. Loss: 8.345
2025-08-22 20:31:15,206 - INFO - 🔥 MPS Iter 2 takes 1.480 seconds. Loss: 1.402
2025-08-22 20:31:16,673 - INFO - 🔥 MPS Iter 3 takes 3.739 seconds. Loss: 0.319
2025-08-22 20:31:18,624 - INFO - 🔥 MPS Iter 4 takes 5.207 seconds. Loss: 0.084
2025-08-22 20:31:20,292 - INFO - 🔥 MPS Iter 5 takes 7.156 seconds. Loss: 0.027
2025-08-22 20:31:22,021 - INFO - 🔥 MPS Iter 6 takes 8.825 seconds. Loss: 0.009
2025-08-22 20:31:22,024 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:31:22,024 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:31:22,062 - INFO - 🧹 GPU memory cleared
2025-08-22 20:31:24,455 - INFO -    RWR 耗时: 12.990 秒
2025-08-22 20:31:25,615 - INFO -    归一化耗时: 1.160 秒
2025-08-22 20:31:34,362 - INFO -    ✅ 完成，总耗时: 14.636 秒
2025-08-22 20:31:34,368 - INFO -   ✅ chr3: 完成，耗时 23.40 秒
2025-08-22 20:31:34,369 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 20:31:34,377 - INFO -    矩阵大小: (7826, 7826), 非零元素: 38135, 稀疏度: 0.000623
2025-08-22 20:31:34,377 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:31:34,377 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 20:31:34,500 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:31:34,764 - INFO -    卷积耗时: 0.387 秒
2025-08-22 20:31:34,770 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0041)
2025-08-22 20:31:34,770 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 20:31:34,770 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 20:31:34,821 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 20:31:35,350 - INFO - 🔥 MPS Iter 1 takes 0.054 seconds. Loss: 8.403
2025-08-22 20:31:37,710 - INFO - 🔥 MPS Iter 2 takes 0.582 seconds. Loss: 1.494
2025-08-22 20:31:39,328 - INFO - 🔥 MPS Iter 3 takes 2.943 seconds. Loss: 0.384
2025-08-22 20:31:40,684 - INFO - 🔥 MPS Iter 4 takes 4.560 seconds. Loss: 0.118
2025-08-22 20:31:41,767 - INFO - 🔥 MPS Iter 5 takes 5.916 seconds. Loss: 0.043
2025-08-22 20:31:43,776 - INFO - 🔥 MPS Iter 6 takes 7.000 seconds. Loss: 0.017
2025-08-22 20:31:45,172 - INFO - 🔥 MPS Iter 7 takes 9.009 seconds. Loss: 0.007
2025-08-22 20:31:45,173 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:31:45,174 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:31:45,196 - INFO - 🧹 GPU memory cleared
2025-08-22 20:31:47,060 - INFO -    RWR 耗时: 12.295 秒
2025-08-22 20:31:48,187 - INFO -    归一化耗时: 1.122 秒
2025-08-22 20:31:56,196 - INFO -    ✅ 完成，总耗时: 13.804 秒
2025-08-22 20:31:56,209 - INFO -   ✅ chr4: 完成，耗时 21.84 秒
2025-08-22 20:31:56,211 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 20:31:56,220 - INFO -    矩阵大小: (7592, 7592), 非零元素: 38895, 稀疏度: 0.000675
2025-08-22 20:31:56,220 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:31:56,220 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 20:31:56,494 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:31:56,785 - INFO -    卷积耗时: 0.565 秒
2025-08-22 20:31:56,791 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0044)
2025-08-22 20:31:56,791 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 20:31:56,791 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 20:31:56,842 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 20:31:57,396 - INFO - 🔥 MPS Iter 1 takes 0.052 seconds. Loss: 8.046
2025-08-22 20:31:59,423 - INFO - 🔥 MPS Iter 2 takes 0.607 seconds. Loss: 1.348
2025-08-22 20:32:00,800 - INFO - 🔥 MPS Iter 3 takes 2.634 seconds. Loss: 0.310
2025-08-22 20:32:02,163 - INFO - 🔥 MPS Iter 4 takes 4.010 seconds. Loss: 0.081
2025-08-22 20:32:03,789 - INFO - 🔥 MPS Iter 5 takes 5.373 seconds. Loss: 0.026
2025-08-22 20:32:05,010 - INFO - 🔥 MPS Iter 6 takes 7.000 seconds. Loss: 0.009
2025-08-22 20:32:05,010 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:32:05,010 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:32:05,042 - INFO - 🧹 GPU memory cleared
2025-08-22 20:32:06,518 - INFO -    RWR 耗时: 9.732 秒
2025-08-22 20:32:07,815 - INFO -    归一化耗时: 1.297 秒
2025-08-22 20:32:15,815 - INFO -    ✅ 完成，总耗时: 11.594 秒
2025-08-22 20:32:15,823 - INFO -   ✅ chr5: 完成，耗时 19.61 秒
2025-08-22 20:32:15,824 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-22 20:32:15,832 - INFO -    矩阵大小: (7487, 7487), 非零元素: 40686, 稀疏度: 0.000726
2025-08-22 20:32:15,832 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:32:15,832 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-22 20:32:15,917 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:32:16,160 - INFO -    卷积耗时: 0.328 秒
2025-08-22 20:32:16,165 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0049)
2025-08-22 20:32:16,165 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-22 20:32:16,165 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-22 20:32:16,216 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-22 20:32:16,736 - INFO - 🔥 MPS Iter 1 takes 0.052 seconds. Loss: 7.817
2025-08-22 20:32:18,900 - INFO - 🔥 MPS Iter 2 takes 0.586 seconds. Loss: 1.315
2025-08-22 20:32:20,201 - INFO - 🔥 MPS Iter 3 takes 2.739 seconds. Loss: 0.302
2025-08-22 20:32:21,264 - INFO - 🔥 MPS Iter 4 takes 4.039 seconds. Loss: 0.079
2025-08-22 20:32:22,558 - INFO - 🔥 MPS Iter 5 takes 5.100 seconds. Loss: 0.025
2025-08-22 20:32:24,175 - INFO - 🔥 MPS Iter 6 takes 6.395 seconds. Loss: 0.008
2025-08-22 20:32:24,181 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:32:24,181 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:32:24,204 - INFO - 🧹 GPU memory cleared
2025-08-22 20:32:25,843 - INFO -    RWR 耗时: 9.682 秒
2025-08-22 20:32:27,110 - INFO -    归一化耗时: 1.267 秒
2025-08-22 20:32:34,898 - INFO -    ✅ 完成，总耗时: 11.277 秒
2025-08-22 20:32:34,908 - INFO -   ✅ chr6: 完成，耗时 19.08 秒
2025-08-22 20:32:34,909 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-22 20:32:34,916 - INFO -    矩阵大小: (7273, 7273), 非零元素: 38051, 稀疏度: 0.000719
2025-08-22 20:32:34,917 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:32:34,917 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-22 20:32:35,037 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:32:35,293 - INFO -    卷积耗时: 0.376 秒
2025-08-22 20:32:35,298 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0046)
2025-08-22 20:32:35,298 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-22 20:32:35,298 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-22 20:32:35,341 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-22 20:32:35,761 - INFO - 🔥 MPS Iter 1 takes 0.044 seconds. Loss: 7.968
2025-08-22 20:32:37,188 - INFO - 🔥 MPS Iter 2 takes 0.463 seconds. Loss: 1.487
2025-08-22 20:32:38,934 - INFO - 🔥 MPS Iter 3 takes 1.893 seconds. Loss: 0.404
2025-08-22 20:32:40,047 - INFO - 🔥 MPS Iter 4 takes 3.638 seconds. Loss: 0.120
2025-08-22 20:32:41,180 - INFO - 🔥 MPS Iter 5 takes 4.765 seconds. Loss: 0.041
2025-08-22 20:32:42,591 - INFO - 🔥 MPS Iter 6 takes 5.883 seconds. Loss: 0.014
2025-08-22 20:32:44,041 - INFO - 🔥 MPS Iter 7 takes 7.295 seconds. Loss: 0.005
2025-08-22 20:32:44,043 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:32:44,043 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:32:44,064 - INFO - 🧹 GPU memory cleared
2025-08-22 20:32:45,498 - INFO -    RWR 耗时: 10.204 秒
2025-08-22 20:32:46,710 - INFO -    归一化耗时: 1.211 秒
2025-08-22 20:32:54,751 - INFO -    ✅ 完成，总耗时: 11.792 秒
2025-08-22 20:32:54,757 - INFO -   ✅ chr7: 完成，耗时 19.85 秒
2025-08-22 20:32:54,757 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-22 20:32:54,766 - INFO -    矩阵大小: (6471, 6471), 非零元素: 39373, 稀疏度: 0.000940
2025-08-22 20:32:54,766 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:32:54,766 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-22 20:32:54,869 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:32:55,231 - INFO -    卷积耗时: 0.465 秒
2025-08-22 20:32:55,238 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0063)
2025-08-22 20:32:55,238 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-22 20:32:55,238 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-22 20:32:55,291 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-22 20:32:55,557 - INFO - 🔥 MPS Iter 1 takes 0.054 seconds. Loss: 6.766
2025-08-22 20:32:55,935 - INFO - 🔥 MPS Iter 2 takes 0.320 seconds. Loss: 1.084
2025-08-22 20:32:57,221 - INFO - 🔥 MPS Iter 3 takes 0.698 seconds. Loss: 0.249
2025-08-22 20:32:58,383 - INFO - 🔥 MPS Iter 4 takes 1.986 seconds. Loss: 0.067
2025-08-22 20:32:59,265 - INFO - 🔥 MPS Iter 5 takes 3.182 seconds. Loss: 0.022
2025-08-22 20:33:00,009 - INFO - 🔥 MPS Iter 6 takes 4.031 seconds. Loss: 0.007
2025-08-22 20:33:00,010 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:33:00,010 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:33:00,041 - INFO - 🧹 GPU memory cleared
2025-08-22 20:33:01,559 - INFO -    RWR 耗时: 6.326 秒
2025-08-22 20:33:02,842 - INFO -    归一化耗时: 1.283 秒
2025-08-22 20:33:11,385 - INFO -    ✅ 完成，总耗时: 8.074 秒
2025-08-22 20:33:11,395 - INFO -   ✅ chr8: 完成，耗时 16.64 秒
2025-08-22 20:33:11,396 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-22 20:33:11,406 - INFO -    矩阵大小: (6230, 6230), 非零元素: 33987, 稀疏度: 0.000876
2025-08-22 20:33:11,408 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:33:11,408 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-22 20:33:11,510 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:33:11,813 - INFO -    卷积耗时: 0.405 秒
2025-08-22 20:33:11,823 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0057)
2025-08-22 20:33:11,823 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-22 20:33:11,823 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-22 20:33:11,877 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-22 20:33:12,130 - INFO - 🔥 MPS Iter 1 takes 0.056 seconds. Loss: 6.857
2025-08-22 20:33:12,495 - INFO - 🔥 MPS Iter 2 takes 0.310 seconds. Loss: 1.099
2025-08-22 20:33:13,881 - INFO - 🔥 MPS Iter 3 takes 0.675 seconds. Loss: 0.240
2025-08-22 20:33:14,766 - INFO - 🔥 MPS Iter 4 takes 2.062 seconds. Loss: 0.063
2025-08-22 20:33:15,501 - INFO - 🔥 MPS Iter 5 takes 2.946 seconds. Loss: 0.020
2025-08-22 20:33:16,181 - INFO - 🔥 MPS Iter 6 takes 3.680 seconds. Loss: 0.007
2025-08-22 20:33:16,188 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:33:16,188 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:33:16,336 - INFO - 🧹 GPU memory cleared
2025-08-22 20:33:17,738 - INFO -    RWR 耗时: 5.922 秒
2025-08-22 20:33:19,058 - INFO -    归一化耗时: 1.320 秒
2025-08-22 20:33:26,439 - INFO -    ✅ 完成，总耗时: 7.648 秒
2025-08-22 20:33:26,454 - INFO -   ✅ chr9: 完成，耗时 15.06 秒
2025-08-22 20:33:26,456 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-22 20:33:26,470 - INFO -    矩阵大小: (6535, 6535), 非零元素: 35881, 稀疏度: 0.000840
2025-08-22 20:33:26,473 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:33:26,473 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-22 20:33:26,595 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:33:26,901 - INFO -    卷积耗时: 0.428 秒
2025-08-22 20:33:26,908 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0057)
2025-08-22 20:33:26,908 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-22 20:33:26,908 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-22 20:33:26,963 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-22 20:33:27,269 - INFO - 🔥 MPS Iter 1 takes 0.056 seconds. Loss: 6.930
2025-08-22 20:33:27,943 - INFO - 🔥 MPS Iter 2 takes 0.364 seconds. Loss: 1.103
2025-08-22 20:33:29,557 - INFO - 🔥 MPS Iter 3 takes 1.037 seconds. Loss: 0.239
2025-08-22 20:33:30,472 - INFO - 🔥 MPS Iter 4 takes 2.651 seconds. Loss: 0.062
2025-08-22 20:33:31,305 - INFO - 🔥 MPS Iter 5 takes 3.567 seconds. Loss: 0.020
2025-08-22 20:33:32,257 - INFO - 🔥 MPS Iter 6 takes 4.434 seconds. Loss: 0.007
2025-08-22 20:33:32,259 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:33:32,259 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:33:32,298 - INFO - 🧹 GPU memory cleared
2025-08-22 20:33:34,036 - INFO -    RWR 耗时: 7.134 秒
2025-08-22 20:33:35,412 - INFO -    归一化耗时: 1.376 秒
2025-08-22 20:33:45,270 - INFO -    ✅ 完成，总耗时: 8.938 秒
2025-08-22 20:33:45,281 - INFO -   ✅ chr10: 完成，耗时 18.82 秒
2025-08-22 20:33:45,282 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-22 20:33:45,293 - INFO -    矩阵大小: (6105, 6105), 非零元素: 34386, 稀疏度: 0.000923
2025-08-22 20:33:45,294 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:33:45,294 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-22 20:33:45,466 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:33:45,734 - INFO -    卷积耗时: 0.440 秒
2025-08-22 20:33:45,743 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0061)
2025-08-22 20:33:45,743 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-22 20:33:45,744 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-22 20:33:45,795 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-22 20:33:46,016 - INFO - 🔥 MPS Iter 1 takes 0.052 seconds. Loss: 6.595
2025-08-22 20:33:46,326 - INFO - 🔥 MPS Iter 2 takes 0.275 seconds. Loss: 1.041
2025-08-22 20:33:47,495 - INFO - 🔥 MPS Iter 3 takes 0.586 seconds. Loss: 0.227
2025-08-22 20:33:48,561 - INFO - 🔥 MPS Iter 4 takes 1.754 seconds. Loss: 0.060
2025-08-22 20:33:49,289 - INFO - 🔥 MPS Iter 5 takes 2.823 seconds. Loss: 0.019
2025-08-22 20:33:49,911 - INFO - 🔥 MPS Iter 6 takes 3.550 seconds. Loss: 0.007
2025-08-22 20:33:49,912 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:33:49,913 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:33:49,927 - INFO - 🧹 GPU memory cleared
2025-08-22 20:33:51,286 - INFO -    RWR 耗时: 5.550 秒
2025-08-22 20:33:52,398 - INFO -    归一化耗时: 1.112 秒
2025-08-22 20:33:59,797 - INFO -    ✅ 完成，总耗时: 7.102 秒
2025-08-22 20:33:59,803 - INFO -   ✅ chr11: 完成，耗时 14.52 秒
2025-08-22 20:33:59,804 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-22 20:33:59,812 - INFO -    矩阵大小: (6007, 6007), 非零元素: 29372, 稀疏度: 0.000814
2025-08-22 20:33:59,813 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:33:59,813 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-22 20:33:59,948 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:34:00,273 - INFO -    卷积耗时: 0.460 秒
2025-08-22 20:34:00,281 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0054)
2025-08-22 20:34:00,282 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-22 20:34:00,282 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-22 20:34:00,339 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-22 20:34:00,544 - INFO - 🔥 MPS Iter 1 takes 0.059 seconds. Loss: 7.614
2025-08-22 20:34:00,796 - INFO - 🔥 MPS Iter 2 takes 0.264 seconds. Loss: 1.587
2025-08-22 20:34:01,135 - INFO - 🔥 MPS Iter 3 takes 0.516 seconds. Loss: 0.519
2025-08-22 20:34:02,463 - INFO - 🔥 MPS Iter 4 takes 0.856 seconds. Loss: 0.196
2025-08-22 20:34:03,329 - INFO - 🔥 MPS Iter 5 takes 2.186 seconds. Loss: 0.083
2025-08-22 20:34:04,075 - INFO - 🔥 MPS Iter 6 takes 3.051 seconds. Loss: 0.035
2025-08-22 20:34:04,689 - INFO - 🔥 MPS Iter 7 takes 3.796 seconds. Loss: 0.016
2025-08-22 20:34:05,216 - INFO - 🔥 MPS Iter 8 takes 4.410 seconds. Loss: 0.007
2025-08-22 20:34:05,218 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:34:05,218 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:34:05,237 - INFO - 🧹 GPU memory cleared
2025-08-22 20:34:06,574 - INFO -    RWR 耗时: 6.299 秒
2025-08-22 20:34:07,624 - INFO -    归一化耗时: 1.049 秒
2025-08-22 20:34:14,946 - INFO -    ✅ 完成，总耗时: 7.808 秒
2025-08-22 20:34:14,956 - INFO -   ✅ chr12: 完成，耗时 15.15 秒
2025-08-22 20:34:14,957 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-22 20:34:14,968 - INFO -    矩阵大小: (6022, 6022), 非零元素: 32347, 稀疏度: 0.000892
2025-08-22 20:34:14,969 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:34:14,969 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-22 20:34:15,111 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:34:15,337 - INFO -    卷积耗时: 0.368 秒
2025-08-22 20:34:15,344 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0059)
2025-08-22 20:34:15,344 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-22 20:34:15,344 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-22 20:34:15,395 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-22 20:34:15,609 - INFO - 🔥 MPS Iter 1 takes 0.053 seconds. Loss: 7.022
2025-08-22 20:34:15,870 - INFO - 🔥 MPS Iter 2 takes 0.267 seconds. Loss: 1.217
2025-08-22 20:34:16,210 - INFO - 🔥 MPS Iter 3 takes 0.527 seconds. Loss: 0.326
2025-08-22 20:34:17,563 - INFO - 🔥 MPS Iter 4 takes 0.869 seconds. Loss: 0.115
2025-08-22 20:34:18,412 - INFO - 🔥 MPS Iter 5 takes 2.222 seconds. Loss: 0.049
2025-08-22 20:34:19,091 - INFO - 🔥 MPS Iter 6 takes 3.070 seconds. Loss: 0.022
2025-08-22 20:34:19,681 - INFO - 🔥 MPS Iter 7 takes 3.749 seconds. Loss: 0.010
2025-08-22 20:34:19,681 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:34:19,681 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:34:19,708 - INFO - 🧹 GPU memory cleared
2025-08-22 20:34:20,591 - INFO -    RWR 耗时: 5.252 秒
2025-08-22 20:34:21,402 - INFO -    归一化耗时: 0.811 秒
2025-08-22 20:34:26,300 - INFO -    ✅ 完成，总耗时: 6.431 秒
2025-08-22 20:34:26,307 - INFO -   ✅ chr13: 完成，耗时 11.35 秒
2025-08-22 20:34:26,309 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 20:34:26,317 - INFO -    矩阵大小: (6246, 6246), 非零元素: 30415, 稀疏度: 0.000780
2025-08-22 20:34:26,317 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:34:26,317 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 20:34:26,414 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:34:26,594 - INFO -    卷积耗时: 0.277 秒
2025-08-22 20:34:26,599 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0052)
2025-08-22 20:34:26,599 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 20:34:26,599 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 20:34:26,657 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 20:34:26,917 - INFO - 🔥 MPS Iter 1 takes 0.060 seconds. Loss: 7.490
2025-08-22 20:34:27,323 - INFO - 🔥 MPS Iter 2 takes 0.319 seconds. Loss: 1.301
2025-08-22 20:34:28,776 - INFO - 🔥 MPS Iter 3 takes 0.725 seconds. Loss: 0.319
2025-08-22 20:34:29,578 - INFO - 🔥 MPS Iter 4 takes 2.180 seconds. Loss: 0.087
2025-08-22 20:34:30,280 - INFO - 🔥 MPS Iter 5 takes 2.981 seconds. Loss: 0.028
2025-08-22 20:34:30,898 - INFO - 🔥 MPS Iter 6 takes 3.682 seconds. Loss: 0.010
2025-08-22 20:34:30,899 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:34:30,899 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:34:30,911 - INFO - 🧹 GPU memory cleared
2025-08-22 20:34:32,016 - INFO -    RWR 耗时: 5.421 秒
2025-08-22 20:34:32,882 - INFO -    归一化耗时: 0.866 秒
2025-08-22 20:34:37,584 - INFO -    ✅ 完成，总耗时: 6.564 秒
2025-08-22 20:34:37,589 - INFO -   ✅ chr14: 完成，耗时 11.28 秒
2025-08-22 20:34:37,590 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-22 20:34:37,595 - INFO -    矩阵大小: (5203, 5203), 非零元素: 28634, 稀疏度: 0.001058
2025-08-22 20:34:37,596 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:34:37,596 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-22 20:34:37,707 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:34:37,841 - INFO -    卷积耗时: 0.245 秒
2025-08-22 20:34:37,846 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0069)
2025-08-22 20:34:37,846 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-22 20:34:37,846 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-22 20:34:37,894 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-22 20:34:38,044 - INFO - 🔥 MPS Iter 1 takes 0.049 seconds. Loss: 6.234
2025-08-22 20:34:38,193 - INFO - 🔥 MPS Iter 2 takes 0.200 seconds. Loss: 1.029
2025-08-22 20:34:38,376 - INFO - 🔥 MPS Iter 3 takes 0.349 seconds. Loss: 0.238
2025-08-22 20:34:38,801 - INFO - 🔥 MPS Iter 4 takes 0.533 seconds. Loss: 0.065
2025-08-22 20:34:39,650 - INFO - 🔥 MPS Iter 5 takes 0.957 seconds. Loss: 0.021
2025-08-22 20:34:40,274 - INFO - 🔥 MPS Iter 6 takes 1.806 seconds. Loss: 0.008
2025-08-22 20:34:40,275 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:34:40,276 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:34:40,283 - INFO - 🧹 GPU memory cleared
2025-08-22 20:34:41,212 - INFO -    RWR 耗时: 3.370 秒
2025-08-22 20:34:42,025 - INFO -    归一化耗时: 0.813 秒
2025-08-22 20:34:47,461 - INFO -    ✅ 完成，总耗时: 4.427 秒
2025-08-22 20:34:47,465 - INFO -   ✅ chr15: 完成，耗时 9.87 秒
2025-08-22 20:34:47,465 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-22 20:34:47,474 - INFO -    矩阵大小: (4911, 4911), 非零元素: 25815, 稀疏度: 0.001070
2025-08-22 20:34:47,477 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:34:47,477 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-22 20:34:47,575 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:34:47,769 - INFO -    卷积耗时: 0.292 秒
2025-08-22 20:34:47,784 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0072)
2025-08-22 20:34:47,785 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-22 20:34:47,785 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-22 20:34:47,859 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-22 20:34:48,004 - INFO - 🔥 MPS Iter 1 takes 0.078 seconds. Loss: 6.199
2025-08-22 20:34:48,143 - INFO - 🔥 MPS Iter 2 takes 0.223 seconds. Loss: 1.126
2025-08-22 20:34:48,290 - INFO - 🔥 MPS Iter 3 takes 0.360 seconds. Loss: 0.340
2025-08-22 20:34:48,499 - INFO - 🔥 MPS Iter 4 takes 0.507 seconds. Loss: 0.141
2025-08-22 20:34:49,187 - INFO - 🔥 MPS Iter 5 takes 0.716 seconds. Loss: 0.067
2025-08-22 20:34:49,804 - INFO - 🔥 MPS Iter 6 takes 1.405 seconds. Loss: 0.033
2025-08-22 20:34:50,254 - INFO - 🔥 MPS Iter 7 takes 2.022 seconds. Loss: 0.016
2025-08-22 20:34:50,634 - INFO - 🔥 MPS Iter 8 takes 2.472 seconds. Loss: 0.008
2025-08-22 20:34:50,636 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:34:50,636 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:34:50,646 - INFO - 🧹 GPU memory cleared
2025-08-22 20:34:51,633 - INFO -    RWR 耗时: 3.862 秒
2025-08-22 20:34:52,411 - INFO -    归一化耗时: 0.778 秒
2025-08-22 20:34:57,008 - INFO -    ✅ 完成，总耗时: 4.932 秒
2025-08-22 20:34:57,011 - INFO -   ✅ chr16: 完成，耗时 9.55 秒
2025-08-22 20:34:57,012 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-22 20:34:57,018 - INFO -    矩阵大小: (4750, 4750), 非零元素: 22214, 稀疏度: 0.000985
2025-08-22 20:34:57,019 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:34:57,019 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-22 20:34:57,098 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:34:57,272 - INFO -    卷积耗时: 0.252 秒
2025-08-22 20:34:57,278 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0062)
2025-08-22 20:34:57,278 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-22 20:34:57,278 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-22 20:34:57,365 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-22 20:34:57,481 - INFO - 🔥 MPS Iter 1 takes 0.088 seconds. Loss: 6.859
2025-08-22 20:34:57,589 - INFO - 🔥 MPS Iter 2 takes 0.204 seconds. Loss: 1.228
2025-08-22 20:34:57,714 - INFO - 🔥 MPS Iter 3 takes 0.312 seconds. Loss: 0.297
2025-08-22 20:34:57,871 - INFO - 🔥 MPS Iter 4 takes 0.438 seconds. Loss: 0.080
2025-08-22 20:34:58,232 - INFO - 🔥 MPS Iter 5 takes 0.619 seconds. Loss: 0.025
2025-08-22 20:34:58,967 - INFO - 🔥 MPS Iter 6 takes 0.959 seconds. Loss: 0.009
2025-08-22 20:34:58,968 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:34:58,968 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:34:58,979 - INFO - 🧹 GPU memory cleared
2025-08-22 20:34:59,786 - INFO -    RWR 耗时: 2.513 秒
2025-08-22 20:35:00,695 - INFO -    归一化耗时: 0.908 秒
2025-08-22 20:35:04,814 - INFO -    ✅ 完成，总耗时: 3.674 秒
2025-08-22 20:35:04,817 - INFO -   ✅ chr17: 完成，耗时 7.81 秒
2025-08-22 20:35:04,818 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-22 20:35:04,824 - INFO -    矩阵大小: (4536, 4536), 非零元素: 25159, 稀疏度: 0.001223
2025-08-22 20:35:04,825 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:35:04,825 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-22 20:35:04,889 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:35:05,039 - INFO -    卷积耗时: 0.213 秒
2025-08-22 20:35:05,047 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0082)
2025-08-22 20:35:05,047 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-22 20:35:05,047 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-22 20:35:05,094 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-22 20:35:05,184 - INFO - 🔥 MPS Iter 1 takes 0.048 seconds. Loss: 5.739
2025-08-22 20:35:05,268 - INFO - 🔥 MPS Iter 2 takes 0.139 seconds. Loss: 0.983
2025-08-22 20:35:05,354 - INFO - 🔥 MPS Iter 3 takes 0.222 seconds. Loss: 0.263
2025-08-22 20:35:05,447 - INFO - 🔥 MPS Iter 4 takes 0.308 seconds. Loss: 0.094
2025-08-22 20:35:05,554 - INFO - 🔥 MPS Iter 5 takes 0.404 seconds. Loss: 0.039
2025-08-22 20:35:05,678 - INFO - 🔥 MPS Iter 6 takes 0.509 seconds. Loss: 0.017
2025-08-22 20:35:05,881 - INFO - 🔥 MPS Iter 7 takes 0.632 seconds. Loss: 0.007
2025-08-22 20:35:05,883 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:35:05,883 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:35:05,891 - INFO - 🧹 GPU memory cleared
2025-08-22 20:35:06,881 - INFO -    RWR 耗时: 1.840 秒
2025-08-22 20:35:07,725 - INFO -    归一化耗时: 0.844 秒
2025-08-22 20:35:11,897 - INFO -    ✅ 完成，总耗时: 2.898 秒
2025-08-22 20:35:11,901 - INFO -   ✅ chr18: 完成，耗时 7.08 秒
2025-08-22 20:35:11,902 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-22 20:35:11,909 - INFO -    矩阵大小: (3072, 3072), 非零元素: 16472, 稀疏度: 0.001745
2025-08-22 20:35:11,910 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:35:11,910 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-22 20:35:11,958 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:35:12,034 - INFO -    卷积耗时: 0.124 秒
2025-08-22 20:35:12,038 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0111)
2025-08-22 20:35:12,038 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-22 20:35:12,038 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-22 20:35:12,083 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-22 20:35:12,121 - INFO - 🔥 MPS Iter 1 takes 0.045 seconds. Loss: 4.756
2025-08-22 20:35:12,150 - INFO - 🔥 MPS Iter 2 takes 0.084 seconds. Loss: 0.774
2025-08-22 20:35:12,179 - INFO - 🔥 MPS Iter 3 takes 0.113 seconds. Loss: 0.175
2025-08-22 20:35:12,208 - INFO - 🔥 MPS Iter 4 takes 0.142 seconds. Loss: 0.047
2025-08-22 20:35:12,238 - INFO - 🔥 MPS Iter 5 takes 0.171 seconds. Loss: 0.016
2025-08-22 20:35:12,267 - INFO - 🔥 MPS Iter 6 takes 0.201 seconds. Loss: 0.006
2025-08-22 20:35:12,268 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:35:12,268 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:35:12,271 - INFO - 🧹 GPU memory cleared
2025-08-22 20:35:12,753 - INFO -    RWR 耗时: 0.718 秒
2025-08-22 20:35:13,092 - INFO -    归一化耗时: 0.339 秒
2025-08-22 20:35:15,217 - INFO -    ✅ 完成，总耗时: 1.180 秒
2025-08-22 20:35:15,223 - INFO -   ✅ chr19: 完成，耗时 3.32 秒
2025-08-22 20:35:15,223 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-22 20:35:15,230 - INFO -    矩阵大小: (8552, 8552), 非零元素: 19392, 稀疏度: 0.000265
2025-08-22 20:35:15,231 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:35:15,231 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-22 20:35:15,374 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:35:15,912 - INFO -    卷积耗时: 0.681 秒
2025-08-22 20:35:15,921 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0020)
2025-08-22 20:35:15,921 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-22 20:35:15,921 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-22 20:35:15,982 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-22 20:35:17,387 - INFO - 🔥 MPS Iter 1 takes 0.063 seconds. Loss: 12.507
2025-08-22 20:35:19,907 - INFO - 🔥 MPS Iter 2 takes 1.471 seconds. Loss: 3.051
2025-08-22 20:35:21,751 - INFO - 🔥 MPS Iter 3 takes 3.988 seconds. Loss: 0.997
2025-08-22 20:35:24,091 - INFO - 🔥 MPS Iter 4 takes 5.834 seconds. Loss: 0.366
2025-08-22 20:35:25,887 - INFO - 🔥 MPS Iter 5 takes 8.175 seconds. Loss: 0.154
2025-08-22 20:35:28,126 - INFO - 🔥 MPS Iter 6 takes 10.017 seconds. Loss: 0.069
2025-08-22 20:35:30,183 - INFO - 🔥 MPS Iter 7 takes 12.208 seconds. Loss: 0.032
2025-08-22 20:35:32,093 - INFO - 🔥 MPS Iter 8 takes 14.265 seconds. Loss: 0.015
2025-08-22 20:35:34,354 - INFO - 🔥 MPS Iter 9 takes 16.254 seconds. Loss: 0.008
2025-08-22 20:35:34,356 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:35:34,356 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:35:34,425 - INFO - 🧹 GPU memory cleared
2025-08-22 20:35:36,697 - INFO -    RWR 耗时: 20.783 秒
2025-08-22 20:35:38,460 - INFO -    归一化耗时: 1.762 秒
2025-08-22 20:35:49,585 - INFO -    ✅ 完成，总耗时: 23.226 秒
2025-08-22 20:35:49,595 - INFO -   ✅ chrX: 完成，耗时 34.37 秒
2025-08-22 20:35:49,595 - INFO - 🎯 细胞 GasdE701007 完成: 20 成功, 0 失败, 总耗时 6.7 分钟
2025-08-22 20:35:49,595 - INFO - 📊 Stage E70: 处理细胞 7/557
2025-08-22 20:35:49,596 - INFO - 🧬 开始处理细胞: GasdE701008
2025-08-22 20:35:49,596 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 20:35:49,607 - INFO -    矩阵大小: (9774, 9774), 非零元素: 40149, 稀疏度: 0.000420
2025-08-22 20:35:49,608 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:35:49,608 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-22 20:35:49,972 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:35:50,668 - INFO -    卷积耗时: 1.060 秒
2025-08-22 20:35:50,678 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0029)
2025-08-22 20:35:50,678 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-22 20:35:50,678 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-22 20:35:50,755 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-22 20:35:54,139 - INFO - 🔥 MPS Iter 1 takes 0.080 seconds. Loss: 10.718
2025-08-22 20:35:57,336 - INFO - 🔥 MPS Iter 2 takes 3.466 seconds. Loss: 2.031
2025-08-22 20:36:00,652 - INFO - 🔥 MPS Iter 3 takes 6.662 seconds. Loss: 0.505
2025-08-22 20:36:04,270 - INFO - 🔥 MPS Iter 4 takes 9.978 seconds. Loss: 0.134
2025-08-22 20:36:07,392 - INFO - 🔥 MPS Iter 5 takes 13.597 seconds. Loss: 0.040
2025-08-22 20:36:10,628 - INFO - 🔥 MPS Iter 6 takes 16.718 seconds. Loss: 0.013
2025-08-22 20:36:14,204 - INFO - 🔥 MPS Iter 7 takes 19.954 seconds. Loss: 0.004
2025-08-22 20:36:14,206 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:36:14,207 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:36:14,390 - INFO - 🧹 GPU memory cleared
2025-08-22 20:36:17,442 - INFO -    RWR 耗时: 26.772 秒
2025-08-22 20:36:20,122 - INFO -    归一化耗时: 2.680 秒
2025-08-22 20:37:00,746 - INFO -    ✅ 完成，总耗时: 30.512 秒
2025-08-22 20:37:00,757 - INFO -   ✅ chr1: 完成，耗时 71.16 秒
2025-08-22 20:37:00,758 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 20:37:00,767 - INFO -    矩阵大小: (9106, 9106), 非零元素: 37558, 稀疏度: 0.000453
2025-08-22 20:37:00,768 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:37:00,768 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-22 20:37:01,046 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:37:01,410 - INFO -    卷积耗时: 0.642 秒
2025-08-22 20:37:01,415 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0031)
2025-08-22 20:37:01,415 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-22 20:37:01,415 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-22 20:37:01,467 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-22 20:37:04,203 - INFO - 🔥 MPS Iter 1 takes 0.052 seconds. Loss: 10.140
2025-08-22 20:37:06,193 - INFO - 🔥 MPS Iter 2 takes 2.791 seconds. Loss: 1.885
2025-08-22 20:37:09,077 - INFO - 🔥 MPS Iter 3 takes 4.779 seconds. Loss: 0.461
2025-08-22 20:37:11,307 - INFO - 🔥 MPS Iter 4 takes 7.669 seconds. Loss: 0.121
2025-08-22 20:37:14,333 - INFO - 🔥 MPS Iter 5 takes 9.893 seconds. Loss: 0.037
2025-08-22 20:37:16,347 - INFO - 🔥 MPS Iter 6 takes 12.920 seconds. Loss: 0.012
2025-08-22 20:37:19,292 - INFO - 🔥 MPS Iter 7 takes 14.935 seconds. Loss: 0.004
2025-08-22 20:37:19,294 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:37:19,294 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:37:19,342 - INFO - 🧹 GPU memory cleared
2025-08-22 20:37:21,585 - INFO -    RWR 耗时: 20.174 秒
2025-08-22 20:37:23,188 - INFO -    归一化耗时: 1.598 秒
2025-08-22 20:37:56,726 - INFO -    ✅ 完成，总耗时: 22.414 秒
2025-08-22 20:37:56,743 - INFO -   ✅ chr2: 完成，耗时 55.98 秒
2025-08-22 20:37:56,744 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 20:37:56,749 - INFO -    矩阵大小: (8002, 8002), 非零元素: 28932, 稀疏度: 0.000452
2025-08-22 20:37:56,750 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:37:56,750 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 20:37:56,929 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:37:57,220 - INFO -    卷积耗时: 0.470 秒
2025-08-22 20:37:57,226 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0032)
2025-08-22 20:37:57,226 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 20:37:57,226 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 20:37:57,277 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 20:37:58,143 - INFO - 🔥 MPS Iter 1 takes 0.053 seconds. Loss: 10.325
2025-08-22 20:38:00,607 - INFO - 🔥 MPS Iter 2 takes 0.921 seconds. Loss: 2.022
2025-08-22 20:38:02,264 - INFO - 🔥 MPS Iter 3 takes 3.385 seconds. Loss: 0.513
2025-08-22 20:38:04,077 - INFO - 🔥 MPS Iter 4 takes 5.041 seconds. Loss: 0.137
2025-08-22 20:38:05,362 - INFO - 🔥 MPS Iter 5 takes 6.853 seconds. Loss: 0.042
2025-08-22 20:38:06,538 - INFO - 🔥 MPS Iter 6 takes 8.138 seconds. Loss: 0.013
2025-08-22 20:38:08,439 - INFO - 🔥 MPS Iter 7 takes 9.313 seconds. Loss: 0.004
2025-08-22 20:38:08,443 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:38:08,443 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:38:08,495 - INFO - 🧹 GPU memory cleared
2025-08-22 20:38:10,469 - INFO -    RWR 耗时: 13.248 秒
2025-08-22 20:38:11,680 - INFO -    归一化耗时: 1.210 秒
2025-08-22 20:38:20,277 - INFO -    ✅ 完成，总耗时: 14.928 秒
2025-08-22 20:38:20,294 - INFO -   ✅ chr3: 完成，耗时 23.55 秒
2025-08-22 20:38:20,296 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 20:38:20,305 - INFO -    矩阵大小: (7826, 7826), 非零元素: 29942, 稀疏度: 0.000489
2025-08-22 20:38:20,306 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:38:20,306 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 20:38:20,423 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:38:20,771 - INFO -    卷积耗时: 0.465 秒
2025-08-22 20:38:20,777 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0034)
2025-08-22 20:38:20,777 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 20:38:20,777 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 20:38:20,833 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 20:38:21,462 - INFO - 🔥 MPS Iter 1 takes 0.062 seconds. Loss: 9.872
2025-08-22 20:38:23,909 - INFO - 🔥 MPS Iter 2 takes 0.687 seconds. Loss: 1.922
2025-08-22 20:38:25,246 - INFO - 🔥 MPS Iter 3 takes 3.136 seconds. Loss: 0.495
2025-08-22 20:38:26,233 - INFO - 🔥 MPS Iter 4 takes 4.471 seconds. Loss: 0.136
2025-08-22 20:38:27,751 - INFO - 🔥 MPS Iter 5 takes 5.457 seconds. Loss: 0.043
2025-08-22 20:38:29,307 - INFO - 🔥 MPS Iter 6 takes 6.976 seconds. Loss: 0.014
2025-08-22 20:38:30,286 - INFO - 🔥 MPS Iter 7 takes 8.532 seconds. Loss: 0.005
2025-08-22 20:38:30,287 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:38:30,287 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:38:30,305 - INFO - 🧹 GPU memory cleared
2025-08-22 20:38:32,842 - INFO -    RWR 耗时: 12.070 秒
2025-08-22 20:38:33,986 - INFO -    归一化耗时: 1.139 秒
2025-08-22 20:38:43,969 - INFO -    ✅ 完成，总耗时: 13.674 秒
2025-08-22 20:38:43,976 - INFO -   ✅ chr4: 完成，耗时 23.68 秒
2025-08-22 20:38:43,978 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 20:38:43,988 - INFO -    矩阵大小: (7592, 7592), 非零元素: 30370, 稀疏度: 0.000527
2025-08-22 20:38:43,989 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:38:43,989 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 20:38:44,303 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:38:44,563 - INFO -    卷积耗时: 0.573 秒
2025-08-22 20:38:44,568 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0036)
2025-08-22 20:38:44,568 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 20:38:44,568 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 20:38:44,622 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 20:38:45,115 - INFO - 🔥 MPS Iter 1 takes 0.056 seconds. Loss: 9.661
2025-08-22 20:38:46,945 - INFO - 🔥 MPS Iter 2 takes 0.549 seconds. Loss: 1.901
2025-08-22 20:38:48,759 - INFO - 🔥 MPS Iter 3 takes 2.385 seconds. Loss: 0.496
2025-08-22 20:38:49,892 - INFO - 🔥 MPS Iter 4 takes 4.193 seconds. Loss: 0.137
2025-08-22 20:38:50,932 - INFO - 🔥 MPS Iter 5 takes 5.325 seconds. Loss: 0.043
2025-08-22 20:38:52,348 - INFO - 🔥 MPS Iter 6 takes 6.366 seconds. Loss: 0.014
2025-08-22 20:38:54,035 - INFO - 🔥 MPS Iter 7 takes 7.782 seconds. Loss: 0.005
2025-08-22 20:38:54,039 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:38:54,039 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:38:54,072 - INFO - 🧹 GPU memory cleared
2025-08-22 20:38:55,540 - INFO -    RWR 耗时: 10.975 秒
2025-08-22 20:38:56,749 - INFO -    归一化耗时: 1.209 秒
2025-08-22 20:39:04,670 - INFO -    ✅ 完成，总耗时: 12.757 秒
2025-08-22 20:39:04,678 - INFO -   ✅ chr5: 完成，耗时 20.70 秒
2025-08-22 20:39:04,679 - INFO - 🧬 开始处理 chr6 (bin格式)
2025-08-22 20:39:04,685 - INFO -    矩阵大小: (7487, 7487), 非零元素: 29285, 稀疏度: 0.000522
2025-08-22 20:39:04,685 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:39:04,686 - INFO - 🔥 MPS Gaussian filter: 7487x7487 matrix, 内存需求: 855.6MB
2025-08-22 20:39:04,773 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:39:05,026 - INFO -    卷积耗时: 0.340 秒
2025-08-22 20:39:05,030 - INFO - 🚀 MPS 加速: 7487x7487 矩阵 (内存需求: 0.63GB, 稀疏度: 0.0036)
2025-08-22 20:39:05,030 - INFO - 🚀 Using MPS for 7487x7487 matrix with 24GB GPU memory
2025-08-22 20:39:05,030 - INFO - Converting 7487x7487 sparse matrix to dense for MPS...
2025-08-22 20:39:05,076 - INFO - 💾 Estimated GPU memory usage: 641.5 MB
2025-08-22 20:39:05,554 - INFO - 🔥 MPS Iter 1 takes 0.047 seconds. Loss: 9.614
2025-08-22 20:39:07,150 - INFO - 🔥 MPS Iter 2 takes 0.525 seconds. Loss: 1.887
2025-08-22 20:39:09,006 - INFO - 🔥 MPS Iter 3 takes 2.125 seconds. Loss: 0.484
2025-08-22 20:39:10,254 - INFO - 🔥 MPS Iter 4 takes 3.978 seconds. Loss: 0.133
2025-08-22 20:39:11,365 - INFO - 🔥 MPS Iter 5 takes 5.226 seconds. Loss: 0.041
2025-08-22 20:39:12,920 - INFO - 🔥 MPS Iter 6 takes 6.337 seconds. Loss: 0.013
2025-08-22 20:39:14,336 - INFO - 🔥 MPS Iter 7 takes 7.892 seconds. Loss: 0.005
2025-08-22 20:39:14,338 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:39:14,338 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:39:14,358 - INFO - 🧹 GPU memory cleared
2025-08-22 20:39:16,087 - INFO -    RWR 耗时: 11.061 秒
2025-08-22 20:39:17,464 - INFO -    归一化耗时: 1.376 秒
2025-08-22 20:39:28,753 - INFO -    ✅ 完成，总耗时: 12.777 秒
2025-08-22 20:39:28,762 - INFO -   ✅ chr6: 完成，耗时 24.08 秒
2025-08-22 20:39:28,775 - INFO - 🧬 开始处理 chr7 (bin格式)
2025-08-22 20:39:28,784 - INFO -    矩阵大小: (7273, 7273), 非零元素: 30481, 稀疏度: 0.000576
2025-08-22 20:39:28,785 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:39:28,785 - INFO - 🔥 MPS Gaussian filter: 7273x7273 matrix, 内存需求: 807.4MB
2025-08-22 20:39:29,015 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:39:29,441 - INFO -    卷积耗时: 0.656 秒
2025-08-22 20:39:29,450 - INFO - 🚀 MPS 加速: 7273x7273 矩阵 (内存需求: 0.59GB, 稀疏度: 0.0040)
2025-08-22 20:39:29,450 - INFO - 🚀 Using MPS for 7273x7273 matrix with 24GB GPU memory
2025-08-22 20:39:29,450 - INFO - Converting 7273x7273 sparse matrix to dense for MPS...
2025-08-22 20:39:29,505 - INFO - 💾 Estimated GPU memory usage: 605.4 MB
2025-08-22 20:39:29,931 - INFO - 🔥 MPS Iter 1 takes 0.057 seconds. Loss: 9.099
2025-08-22 20:39:31,427 - INFO - 🔥 MPS Iter 2 takes 0.483 seconds. Loss: 1.824
2025-08-22 20:39:33,098 - INFO - 🔥 MPS Iter 3 takes 1.981 seconds. Loss: 0.508
2025-08-22 20:39:34,379 - INFO - 🔥 MPS Iter 4 takes 3.652 seconds. Loss: 0.153
2025-08-22 20:39:35,474 - INFO - 🔥 MPS Iter 5 takes 4.933 seconds. Loss: 0.053
2025-08-22 20:39:36,659 - INFO - 🔥 MPS Iter 6 takes 6.036 seconds. Loss: 0.019
2025-08-22 20:39:37,999 - INFO - 🔥 MPS Iter 7 takes 7.211 seconds. Loss: 0.007
2025-08-22 20:39:38,000 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:39:38,000 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:39:38,024 - INFO - 🧹 GPU memory cleared
2025-08-22 20:39:39,964 - INFO -    RWR 耗时: 10.521 秒
2025-08-22 20:39:41,300 - INFO -    归一化耗时: 1.336 秒
2025-08-22 20:39:51,003 - INFO -    ✅ 完成，总耗时: 12.513 秒
2025-08-22 20:39:51,011 - INFO -   ✅ chr7: 完成，耗时 22.24 秒
2025-08-22 20:39:51,013 - INFO - 🧬 开始处理 chr8 (bin格式)
2025-08-22 20:39:51,024 - INFO -    矩阵大小: (6471, 6471), 非零元素: 27128, 稀疏度: 0.000648
2025-08-22 20:39:51,025 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:39:51,026 - INFO - 🔥 MPS Gaussian filter: 6471x6471 matrix, 内存需求: 639.1MB
2025-08-22 20:39:51,150 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:39:51,443 - INFO -    卷积耗时: 0.417 秒
2025-08-22 20:39:51,449 - INFO - 🚀 MPS 加速: 6471x6471 矩阵 (内存需求: 0.47GB, 稀疏度: 0.0043)
2025-08-22 20:39:51,449 - INFO - 🚀 Using MPS for 6471x6471 matrix with 24GB GPU memory
2025-08-22 20:39:51,449 - INFO - Converting 6471x6471 sparse matrix to dense for MPS...
2025-08-22 20:39:51,511 - INFO - 💾 Estimated GPU memory usage: 479.2 MB
2025-08-22 20:39:51,811 - INFO - 🔥 MPS Iter 1 takes 0.064 seconds. Loss: 8.600
2025-08-22 20:39:52,392 - INFO - 🔥 MPS Iter 2 takes 0.364 seconds. Loss: 1.655
2025-08-22 20:39:54,120 - INFO - 🔥 MPS Iter 3 takes 0.985 seconds. Loss: 0.432
2025-08-22 20:39:54,961 - INFO - 🔥 MPS Iter 4 takes 2.673 seconds. Loss: 0.123
2025-08-22 20:39:55,708 - INFO - 🔥 MPS Iter 5 takes 3.515 seconds. Loss: 0.040
2025-08-22 20:39:56,443 - INFO - 🔥 MPS Iter 6 takes 4.262 seconds. Loss: 0.014
2025-08-22 20:39:57,328 - INFO - 🔥 MPS Iter 7 takes 4.997 seconds. Loss: 0.005
2025-08-22 20:39:57,328 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:39:57,329 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:39:57,349 - INFO - 🧹 GPU memory cleared
2025-08-22 20:39:59,158 - INFO -    RWR 耗时: 7.714 秒
2025-08-22 20:40:00,273 - INFO -    归一化耗时: 1.114 秒
2025-08-22 20:40:08,800 - INFO -    ✅ 完成，总耗时: 9.246 秒
2025-08-22 20:40:08,806 - INFO -   ✅ chr8: 完成，耗时 17.79 秒
2025-08-22 20:40:08,807 - INFO - 🧬 开始处理 chr9 (bin格式)
2025-08-22 20:40:08,816 - INFO -    矩阵大小: (6230, 6230), 非零元素: 27427, 稀疏度: 0.000707
2025-08-22 20:40:08,818 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:40:08,818 - INFO - 🔥 MPS Gaussian filter: 6230x6230 matrix, 内存需求: 592.4MB
2025-08-22 20:40:09,101 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:40:09,375 - INFO -    卷积耗时: 0.556 秒
2025-08-22 20:40:09,381 - INFO - 🚀 MPS 加速: 6230x6230 矩阵 (内存需求: 0.43GB, 稀疏度: 0.0047)
2025-08-22 20:40:09,381 - INFO - 🚀 Using MPS for 6230x6230 matrix with 24GB GPU memory
2025-08-22 20:40:09,381 - INFO - Converting 6230x6230 sparse matrix to dense for MPS...
2025-08-22 20:40:09,431 - INFO - 💾 Estimated GPU memory usage: 444.2 MB
2025-08-22 20:40:09,658 - INFO - 🔥 MPS Iter 1 takes 0.052 seconds. Loss: 7.945
2025-08-22 20:40:09,973 - INFO - 🔥 MPS Iter 2 takes 0.279 seconds. Loss: 1.445
2025-08-22 20:40:10,856 - INFO - 🔥 MPS Iter 3 takes 0.593 seconds. Loss: 0.350
2025-08-22 20:40:11,910 - INFO - 🔥 MPS Iter 4 takes 1.478 seconds. Loss: 0.094
2025-08-22 20:40:12,843 - INFO - 🔥 MPS Iter 5 takes 2.533 seconds. Loss: 0.029
2025-08-22 20:40:13,706 - INFO - 🔥 MPS Iter 6 takes 3.464 seconds. Loss: 0.010
2025-08-22 20:40:13,707 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:40:13,707 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:40:13,728 - INFO - 🧹 GPU memory cleared
2025-08-22 20:40:15,201 - INFO -    RWR 耗时: 5.825 秒
2025-08-22 20:40:16,340 - INFO -    归一化耗时: 1.139 秒
2025-08-22 20:40:23,916 - INFO -    ✅ 完成，总耗时: 7.521 秒
2025-08-22 20:40:23,924 - INFO -   ✅ chr9: 完成，耗时 15.12 秒
2025-08-22 20:40:23,925 - INFO - 🧬 开始处理 chr10 (bin格式)
2025-08-22 20:40:23,934 - INFO -    矩阵大小: (6535, 6535), 非零元素: 24626, 稀疏度: 0.000577
2025-08-22 20:40:23,935 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:40:23,935 - INFO - 🔥 MPS Gaussian filter: 6535x6535 matrix, 内存需求: 651.8MB
2025-08-22 20:40:24,055 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:40:24,353 - INFO -    卷积耗时: 0.418 秒
2025-08-22 20:40:24,359 - INFO - 🚀 MPS 加速: 6535x6535 矩阵 (内存需求: 0.48GB, 稀疏度: 0.0040)
2025-08-22 20:40:24,359 - INFO - 🚀 Using MPS for 6535x6535 matrix with 24GB GPU memory
2025-08-22 20:40:24,359 - INFO - Converting 6535x6535 sparse matrix to dense for MPS...
2025-08-22 20:40:24,408 - INFO - 💾 Estimated GPU memory usage: 488.7 MB
2025-08-22 20:40:24,690 - INFO - 🔥 MPS Iter 1 takes 0.050 seconds. Loss: 8.860
2025-08-22 20:40:25,094 - INFO - 🔥 MPS Iter 2 takes 0.333 seconds. Loss: 1.689
2025-08-22 20:40:26,589 - INFO - 🔥 MPS Iter 3 takes 0.740 seconds. Loss: 0.421
2025-08-22 20:40:27,726 - INFO - 🔥 MPS Iter 4 takes 2.233 seconds. Loss: 0.114
2025-08-22 20:40:28,751 - INFO - 🔥 MPS Iter 5 takes 3.370 seconds. Loss: 0.035
2025-08-22 20:40:29,563 - INFO - 🔥 MPS Iter 6 takes 4.394 seconds. Loss: 0.011
2025-08-22 20:40:30,345 - INFO - 🔥 MPS Iter 7 takes 5.206 seconds. Loss: 0.004
2025-08-22 20:40:30,346 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:40:30,347 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:40:30,364 - INFO - 🧹 GPU memory cleared
2025-08-22 20:40:32,119 - INFO -    RWR 耗时: 7.764 秒
2025-08-22 20:40:33,415 - INFO -    归一化耗时: 1.296 秒
2025-08-22 20:40:41,252 - INFO -    ✅ 完成，总耗时: 9.478 秒
2025-08-22 20:40:41,277 - INFO -   ✅ chr10: 完成，耗时 17.35 秒
2025-08-22 20:40:41,279 - INFO - 🧬 开始处理 chr11 (bin格式)
2025-08-22 20:40:41,298 - INFO -    矩阵大小: (6105, 6105), 非零元素: 26528, 稀疏度: 0.000712
2025-08-22 20:40:41,299 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:40:41,300 - INFO - 🔥 MPS Gaussian filter: 6105x6105 matrix, 内存需求: 568.9MB
2025-08-22 20:40:41,771 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:40:42,142 - INFO -    卷积耗时: 0.843 秒
2025-08-22 20:40:42,156 - INFO - 🚀 MPS 加速: 6105x6105 矩阵 (内存需求: 0.42GB, 稀疏度: 0.0047)
2025-08-22 20:40:42,156 - INFO - 🚀 Using MPS for 6105x6105 matrix with 24GB GPU memory
2025-08-22 20:40:42,156 - INFO - Converting 6105x6105 sparse matrix to dense for MPS...
2025-08-22 20:40:42,247 - INFO - 💾 Estimated GPU memory usage: 426.5 MB
2025-08-22 20:40:42,719 - INFO - 🔥 MPS Iter 1 takes 0.094 seconds. Loss: 7.784
2025-08-22 20:40:44,085 - INFO - 🔥 MPS Iter 2 takes 0.649 seconds. Loss: 1.375
2025-08-22 20:40:44,987 - INFO - 🔥 MPS Iter 3 takes 1.939 seconds. Loss: 0.323
2025-08-22 20:40:45,662 - INFO - 🔥 MPS Iter 4 takes 2.833 seconds. Loss: 0.085
2025-08-22 20:40:46,322 - INFO - 🔥 MPS Iter 5 takes 3.525 seconds. Loss: 0.027
2025-08-22 20:40:47,129 - INFO - 🔥 MPS Iter 6 takes 4.167 seconds. Loss: 0.009
2025-08-22 20:40:47,130 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:40:47,130 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:40:47,165 - INFO - 🧹 GPU memory cleared
2025-08-22 20:40:48,267 - INFO -    RWR 耗时: 6.122 秒
2025-08-22 20:40:49,129 - INFO -    归一化耗时: 0.857 秒
2025-08-22 20:40:54,653 - INFO -    ✅ 完成，总耗时: 7.822 秒
2025-08-22 20:41:05,534 - INFO -   ✅ chr11: 完成，耗时 24.26 秒
2025-08-22 20:41:05,538 - INFO - 🧬 开始处理 chr12 (bin格式)
2025-08-22 20:41:05,550 - INFO -    矩阵大小: (6007, 6007), 非零元素: 21920, 稀疏度: 0.000607
2025-08-22 20:41:05,552 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:41:05,553 - INFO - 🔥 MPS Gaussian filter: 6007x6007 matrix, 内存需求: 550.8MB
2025-08-22 20:41:05,633 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:41:05,827 - INFO -    卷积耗时: 0.275 秒
2025-08-22 20:41:05,831 - INFO - 🚀 MPS 加速: 6007x6007 矩阵 (内存需求: 0.40GB, 稀疏度: 0.0042)
2025-08-22 20:41:05,832 - INFO - 🚀 Using MPS for 6007x6007 matrix with 24GB GPU memory
2025-08-22 20:41:05,833 - INFO - Converting 6007x6007 sparse matrix to dense for MPS...
2025-08-22 20:41:05,880 - INFO - 💾 Estimated GPU memory usage: 412.9 MB
2025-08-22 20:41:06,096 - INFO - 🔥 MPS Iter 1 takes 0.054 seconds. Loss: 9.142
2025-08-22 20:41:06,410 - INFO - 🔥 MPS Iter 2 takes 0.267 seconds. Loss: 2.083
2025-08-22 20:41:08,156 - INFO - 🔥 MPS Iter 3 takes 0.582 seconds. Loss: 0.679
2025-08-22 20:41:09,058 - INFO - 🔥 MPS Iter 4 takes 2.333 seconds. Loss: 0.257
2025-08-22 20:41:09,705 - INFO - 🔥 MPS Iter 5 takes 3.231 seconds. Loss: 0.109
2025-08-22 20:41:10,321 - INFO - 🔥 MPS Iter 6 takes 3.876 seconds. Loss: 0.048
2025-08-22 20:41:10,924 - INFO - 🔥 MPS Iter 7 takes 4.492 seconds. Loss: 0.022
2025-08-22 20:41:11,604 - INFO - 🔥 MPS Iter 8 takes 5.095 seconds. Loss: 0.010
2025-08-22 20:41:11,612 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:41:11,613 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:41:11,656 - INFO - 🧹 GPU memory cleared
2025-08-22 20:41:13,491 - INFO -    RWR 耗时: 7.663 秒
2025-08-22 20:41:14,807 - INFO -    归一化耗时: 1.312 秒
2025-08-22 20:41:21,589 - INFO -    ✅ 完成，总耗时: 9.250 秒
2025-08-22 20:41:21,594 - INFO -   ✅ chr12: 完成，耗时 16.06 秒
2025-08-22 20:41:21,595 - INFO - 🧬 开始处理 chr13 (bin格式)
2025-08-22 20:41:21,605 - INFO -    矩阵大小: (6022, 6022), 非零元素: 23387, 稀疏度: 0.000645
2025-08-22 20:41:21,607 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:41:21,609 - INFO - 🔥 MPS Gaussian filter: 6022x6022 matrix, 内存需求: 553.5MB
2025-08-22 20:41:21,862 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:41:22,222 - INFO -    卷积耗时: 0.615 秒
2025-08-22 20:41:22,233 - INFO - 🚀 MPS 加速: 6022x6022 矩阵 (内存需求: 0.41GB, 稀疏度: 0.0044)
2025-08-22 20:41:22,234 - INFO - 🚀 Using MPS for 6022x6022 matrix with 24GB GPU memory
2025-08-22 20:41:22,235 - INFO - Converting 6022x6022 sparse matrix to dense for MPS...
2025-08-22 20:41:22,307 - INFO - 💾 Estimated GPU memory usage: 415.0 MB
2025-08-22 20:41:22,556 - INFO - 🔥 MPS Iter 1 takes 0.077 seconds. Loss: 8.519
2025-08-22 20:41:23,090 - INFO - 🔥 MPS Iter 2 takes 0.326 seconds. Loss: 1.653
2025-08-22 20:41:24,462 - INFO - 🔥 MPS Iter 3 takes 0.861 seconds. Loss: 0.451
2025-08-22 20:41:25,273 - INFO - 🔥 MPS Iter 4 takes 2.234 seconds. Loss: 0.146
2025-08-22 20:41:25,946 - INFO - 🔥 MPS Iter 5 takes 3.044 seconds. Loss: 0.057
2025-08-22 20:41:26,681 - INFO - 🔥 MPS Iter 6 takes 3.716 seconds. Loss: 0.024
2025-08-22 20:41:27,535 - INFO - 🔥 MPS Iter 7 takes 4.451 seconds. Loss: 0.011
2025-08-22 20:41:28,452 - INFO - 🔥 MPS Iter 8 takes 5.306 seconds. Loss: 0.005
2025-08-22 20:41:28,455 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:41:28,456 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:41:28,478 - INFO - 🧹 GPU memory cleared
2025-08-22 20:41:30,000 - INFO -    RWR 耗时: 7.775 秒
2025-08-22 20:41:31,052 - INFO -    归一化耗时: 1.048 秒
2025-08-22 20:41:38,781 - INFO -    ✅ 完成，总耗时: 9.438 秒
2025-08-22 20:41:38,791 - INFO -   ✅ chr13: 完成，耗时 17.20 秒
2025-08-22 20:41:38,813 - INFO - 🧬 开始处理 chr14 (bin格式)
2025-08-22 20:41:38,825 - INFO -    矩阵大小: (6246, 6246), 非零元素: 21877, 稀疏度: 0.000561
2025-08-22 20:41:38,827 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:41:38,828 - INFO - 🔥 MPS Gaussian filter: 6246x6246 matrix, 内存需求: 595.5MB
2025-08-22 20:41:39,076 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:41:39,456 - INFO -    卷积耗时: 0.629 秒
2025-08-22 20:41:39,464 - INFO - 🚀 MPS 加速: 6246x6246 矩阵 (内存需求: 0.44GB, 稀疏度: 0.0039)
2025-08-22 20:41:39,465 - INFO - 🚀 Using MPS for 6246x6246 matrix with 24GB GPU memory
2025-08-22 20:41:39,466 - INFO - Converting 6246x6246 sparse matrix to dense for MPS...
2025-08-22 20:41:39,528 - INFO - 💾 Estimated GPU memory usage: 446.5 MB
2025-08-22 20:41:39,774 - INFO - 🔥 MPS Iter 1 takes 0.066 seconds. Loss: 9.273
2025-08-22 20:41:40,152 - INFO - 🔥 MPS Iter 2 takes 0.313 seconds. Loss: 1.996
2025-08-22 20:41:41,376 - INFO - 🔥 MPS Iter 3 takes 0.688 seconds. Loss: 0.582
2025-08-22 20:41:42,582 - INFO - 🔥 MPS Iter 4 takes 1.914 seconds. Loss: 0.189
2025-08-22 20:41:43,623 - INFO - 🔥 MPS Iter 5 takes 3.121 seconds. Loss: 0.072
2025-08-22 20:41:44,426 - INFO - 🔥 MPS Iter 6 takes 4.165 seconds. Loss: 0.030
2025-08-22 20:41:45,096 - INFO - 🔥 MPS Iter 7 takes 4.963 seconds. Loss: 0.013
2025-08-22 20:41:45,735 - INFO - 🔥 MPS Iter 8 takes 5.634 seconds. Loss: 0.006
2025-08-22 20:41:45,738 - INFO - ✅ Converged after 8 iterations
2025-08-22 20:41:45,739 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:41:45,783 - INFO - 🧹 GPU memory cleared
2025-08-22 20:41:47,093 - INFO -    RWR 耗时: 7.635 秒
2025-08-22 20:41:48,287 - INFO -    归一化耗时: 1.194 秒
2025-08-22 20:41:55,496 - INFO -    ✅ 完成，总耗时: 9.457 秒
2025-08-22 20:41:55,501 - INFO -   ✅ chr14: 完成，耗时 16.69 秒
2025-08-22 20:41:55,502 - INFO - 🧬 开始处理 chr15 (bin格式)
2025-08-22 20:41:55,510 - INFO -    矩阵大小: (5203, 5203), 非零元素: 19769, 稀疏度: 0.000730
2025-08-22 20:41:55,511 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:41:55,512 - INFO - 🔥 MPS Gaussian filter: 5203x5203 matrix, 内存需求: 413.2MB
2025-08-22 20:41:55,589 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:41:55,900 - INFO -    卷积耗时: 0.389 秒
2025-08-22 20:41:55,924 - INFO - 🚀 MPS 加速: 5203x5203 矩阵 (内存需求: 0.30GB, 稀疏度: 0.0049)
2025-08-22 20:41:55,925 - INFO - 🚀 Using MPS for 5203x5203 matrix with 24GB GPU memory
2025-08-22 20:41:55,926 - INFO - Converting 5203x5203 sparse matrix to dense for MPS...
2025-08-22 20:41:55,977 - INFO - 💾 Estimated GPU memory usage: 309.8 MB
2025-08-22 20:41:56,127 - INFO - 🔥 MPS Iter 1 takes 0.065 seconds. Loss: 8.127
2025-08-22 20:41:56,281 - INFO - 🔥 MPS Iter 2 takes 0.212 seconds. Loss: 1.609
2025-08-22 20:41:56,459 - INFO - 🔥 MPS Iter 3 takes 0.358 seconds. Loss: 0.421
2025-08-22 20:41:57,137 - INFO - 🔥 MPS Iter 4 takes 0.536 seconds. Loss: 0.117
2025-08-22 20:41:58,133 - INFO - 🔥 MPS Iter 5 takes 1.216 seconds. Loss: 0.037
2025-08-22 20:41:58,784 - INFO - 🔥 MPS Iter 6 takes 2.231 seconds. Loss: 0.012
2025-08-22 20:41:59,269 - INFO - 🔥 MPS Iter 7 takes 2.865 seconds. Loss: 0.004
2025-08-22 20:41:59,271 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:41:59,273 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:41:59,287 - INFO - 🧹 GPU memory cleared
2025-08-22 20:42:00,265 - INFO -    RWR 耗时: 4.344 秒
2025-08-22 20:42:01,185 - INFO -    归一化耗时: 0.915 秒
2025-08-22 20:42:06,761 - INFO -    ✅ 完成，总耗时: 5.648 秒
2025-08-22 20:42:06,769 - INFO -   ✅ chr15: 完成，耗时 11.27 秒
2025-08-22 20:42:06,785 - INFO - 🧬 开始处理 chr16 (bin格式)
2025-08-22 20:42:06,827 - INFO -    矩阵大小: (4911, 4911), 非零元素: 17812, 稀疏度: 0.000739
2025-08-22 20:42:06,830 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:42:06,831 - INFO - 🔥 MPS Gaussian filter: 4911x4911 matrix, 内存需求: 368.2MB
2025-08-22 20:42:06,973 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:42:07,159 - INFO -    卷积耗时: 0.329 秒
2025-08-22 20:42:07,165 - INFO - 🚀 MPS 加速: 4911x4911 矩阵 (内存需求: 0.27GB, 稀疏度: 0.0050)
2025-08-22 20:42:07,166 - INFO - 🚀 Using MPS for 4911x4911 matrix with 24GB GPU memory
2025-08-22 20:42:07,167 - INFO - Converting 4911x4911 sparse matrix to dense for MPS...
2025-08-22 20:42:07,226 - INFO - 💾 Estimated GPU memory usage: 276.0 MB
2025-08-22 20:42:07,360 - INFO - 🔥 MPS Iter 1 takes 0.063 seconds. Loss: 8.035
2025-08-22 20:42:07,488 - INFO - 🔥 MPS Iter 2 takes 0.197 seconds. Loss: 1.573
2025-08-22 20:42:07,637 - INFO - 🔥 MPS Iter 3 takes 0.325 seconds. Loss: 0.398
2025-08-22 20:42:07,887 - INFO - 🔥 MPS Iter 4 takes 0.474 seconds. Loss: 0.105
2025-08-22 20:42:08,928 - INFO - 🔥 MPS Iter 5 takes 0.751 seconds. Loss: 0.032
2025-08-22 20:42:09,427 - INFO - 🔥 MPS Iter 6 takes 1.766 seconds. Loss: 0.010
2025-08-22 20:42:09,429 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:42:09,430 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:42:09,446 - INFO - 🧹 GPU memory cleared
2025-08-22 20:42:10,475 - INFO -    RWR 耗时: 3.314 秒
2025-08-22 20:42:11,279 - INFO -    归一化耗时: 0.804 秒
2025-08-22 20:42:16,791 - INFO -    ✅ 完成，总耗时: 4.446 秒
2025-08-22 20:42:16,796 - INFO -   ✅ chr16: 完成，耗时 10.01 秒
2025-08-22 20:42:16,798 - INFO - 🧬 开始处理 chr17 (bin格式)
2025-08-22 20:42:16,807 - INFO -    矩阵大小: (4750, 4750), 非零元素: 18056, 稀疏度: 0.000800
2025-08-22 20:42:16,808 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:42:16,809 - INFO - 🔥 MPS Gaussian filter: 4750x4750 matrix, 内存需求: 344.4MB
2025-08-22 20:42:16,919 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:42:17,098 - INFO -    卷积耗时: 0.289 秒
2025-08-22 20:42:17,104 - INFO - 🚀 MPS 加速: 4750x4750 矩阵 (内存需求: 0.25GB, 稀疏度: 0.0054)
2025-08-22 20:42:17,104 - INFO - 🚀 Using MPS for 4750x4750 matrix with 24GB GPU memory
2025-08-22 20:42:17,105 - INFO - Converting 4750x4750 sparse matrix to dense for MPS...
2025-08-22 20:42:17,180 - INFO - 💾 Estimated GPU memory usage: 258.2 MB
2025-08-22 20:42:17,318 - INFO - 🔥 MPS Iter 1 takes 0.077 seconds. Loss: 7.802
2025-08-22 20:42:17,460 - INFO - 🔥 MPS Iter 2 takes 0.236 seconds. Loss: 1.521
2025-08-22 20:42:17,596 - INFO - 🔥 MPS Iter 3 takes 0.360 seconds. Loss: 0.393
2025-08-22 20:42:17,784 - INFO - 🔥 MPS Iter 4 takes 0.494 seconds. Loss: 0.108
2025-08-22 20:42:18,521 - INFO - 🔥 MPS Iter 5 takes 0.683 seconds. Loss: 0.034
2025-08-22 20:42:19,138 - INFO - 🔥 MPS Iter 6 takes 1.423 seconds. Loss: 0.011
2025-08-22 20:42:19,552 - INFO - 🔥 MPS Iter 7 takes 2.043 seconds. Loss: 0.004
2025-08-22 20:42:19,554 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:42:19,556 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:42:19,567 - INFO - 🧹 GPU memory cleared
2025-08-22 20:42:20,679 - INFO -    RWR 耗时: 3.579 秒
2025-08-22 20:42:21,389 - INFO -    归一化耗时: 0.709 秒
2025-08-22 20:42:26,080 - INFO -    ✅ 完成，总耗时: 4.578 秒
2025-08-22 20:42:26,084 - INFO -   ✅ chr17: 完成，耗时 9.29 秒
2025-08-22 20:42:26,085 - INFO - 🧬 开始处理 chr18 (bin格式)
2025-08-22 20:42:26,093 - INFO -    矩阵大小: (4536, 4536), 非零元素: 17780, 稀疏度: 0.000864
2025-08-22 20:42:26,095 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:42:26,096 - INFO - 🔥 MPS Gaussian filter: 4536x4536 matrix, 内存需求: 314.1MB
2025-08-22 20:42:26,165 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:42:26,327 - INFO -    卷积耗时: 0.232 秒
2025-08-22 20:42:26,335 - INFO - 🚀 MPS 加速: 4536x4536 矩阵 (内存需求: 0.23GB, 稀疏度: 0.0059)
2025-08-22 20:42:26,335 - INFO - 🚀 Using MPS for 4536x4536 matrix with 24GB GPU memory
2025-08-22 20:42:26,336 - INFO - Converting 4536x4536 sparse matrix to dense for MPS...
2025-08-22 20:42:26,391 - INFO - 💾 Estimated GPU memory usage: 235.5 MB
2025-08-22 20:42:26,506 - INFO - 🔥 MPS Iter 1 takes 0.070 seconds. Loss: 7.156
2025-08-22 20:42:26,601 - INFO - 🔥 MPS Iter 2 takes 0.174 seconds. Loss: 1.359
2025-08-22 20:42:26,708 - INFO - 🔥 MPS Iter 3 takes 0.269 seconds. Loss: 0.343
2025-08-22 20:42:26,852 - INFO - 🔥 MPS Iter 4 takes 0.393 seconds. Loss: 0.096
2025-08-22 20:42:27,030 - INFO - 🔥 MPS Iter 5 takes 0.532 seconds. Loss: 0.031
2025-08-22 20:42:27,596 - INFO - 🔥 MPS Iter 6 takes 0.700 seconds. Loss: 0.011
2025-08-22 20:42:28,265 - INFO - 🔥 MPS Iter 7 takes 1.265 seconds. Loss: 0.004
2025-08-22 20:42:28,267 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:42:28,269 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:42:28,290 - INFO - 🧹 GPU memory cleared
2025-08-22 20:42:29,176 - INFO -    RWR 耗时: 2.846 秒
2025-08-22 20:42:30,028 - INFO -    归一化耗时: 0.849 秒
2025-08-22 20:42:34,253 - INFO -    ✅ 完成，总耗时: 3.928 秒
2025-08-22 20:42:34,257 - INFO -   ✅ chr18: 完成，耗时 8.17 秒
2025-08-22 20:42:34,258 - INFO - 🧬 开始处理 chr19 (bin格式)
2025-08-22 20:42:34,264 - INFO -    矩阵大小: (3072, 3072), 非零元素: 12414, 稀疏度: 0.001315
2025-08-22 20:42:34,266 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:42:34,266 - INFO - 🔥 MPS Gaussian filter: 3072x3072 matrix, 内存需求: 144.1MB
2025-08-22 20:42:34,323 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:42:34,391 - INFO -    卷积耗时: 0.125 秒
2025-08-22 20:42:34,395 - INFO - 🚀 MPS 加速: 3072x3072 矩阵 (内存需求: 0.11GB, 稀疏度: 0.0089)
2025-08-22 20:42:34,395 - INFO - 🚀 Using MPS for 3072x3072 matrix with 24GB GPU memory
2025-08-22 20:42:34,396 - INFO - Converting 3072x3072 sparse matrix to dense for MPS...
2025-08-22 20:42:34,452 - INFO - 💾 Estimated GPU memory usage: 108.0 MB
2025-08-22 20:42:34,485 - INFO - 🔥 MPS Iter 1 takes 0.059 seconds. Loss: 5.740
2025-08-22 20:42:34,524 - INFO - 🔥 MPS Iter 2 takes 0.101 seconds. Loss: 1.044
2025-08-22 20:42:34,553 - INFO - 🔥 MPS Iter 3 takes 0.131 seconds. Loss: 0.251
2025-08-22 20:42:34,593 - INFO - 🔥 MPS Iter 4 takes 0.172 seconds. Loss: 0.066
2025-08-22 20:42:34,622 - INFO - 🔥 MPS Iter 5 takes 0.199 seconds. Loss: 0.020
2025-08-22 20:42:34,668 - INFO - 🔥 MPS Iter 6 takes 0.245 seconds. Loss: 0.007
2025-08-22 20:42:34,670 - INFO - ✅ Converged after 6 iterations
2025-08-22 20:42:34,671 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:42:34,674 - INFO - 🧹 GPU memory cleared
2025-08-22 20:42:34,955 - INFO -    RWR 耗时: 0.562 秒
2025-08-22 20:42:35,237 - INFO -    归一化耗时: 0.281 秒
2025-08-22 20:42:37,318 - INFO -    ✅ 完成，总耗时: 0.968 秒
2025-08-22 20:42:37,325 - INFO -   ✅ chr19: 完成，耗时 3.07 秒
2025-08-22 20:42:37,327 - INFO - 🧬 开始处理 chrX (bin格式)
2025-08-22 20:42:37,335 - INFO -    矩阵大小: (8552, 8552), 非零元素: 15593, 稀疏度: 0.000213
2025-08-22 20:42:37,337 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:42:37,338 - INFO - 🔥 MPS Gaussian filter: 8552x8552 matrix, 内存需求: 1116.2MB
2025-08-22 20:42:37,487 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:42:38,173 - INFO -    卷积耗时: 0.836 秒
2025-08-22 20:42:38,195 - INFO - 🚀 MPS 加速: 8552x8552 矩阵 (内存需求: 0.82GB, 稀疏度: 0.0016)
2025-08-22 20:42:38,196 - INFO - 🚀 Using MPS for 8552x8552 matrix with 24GB GPU memory
2025-08-22 20:42:38,199 - INFO - Converting 8552x8552 sparse matrix to dense for MPS...
2025-08-22 20:42:38,283 - INFO - 💾 Estimated GPU memory usage: 837.0 MB
2025-08-22 20:42:40,261 - INFO - 🔥 MPS Iter 1 takes 0.094 seconds. Loss: 14.060
2025-08-22 20:42:42,527 - INFO - 🔥 MPS Iter 2 takes 2.086 seconds. Loss: 3.624
2025-08-22 20:42:44,841 - INFO - 🔥 MPS Iter 3 takes 4.346 seconds. Loss: 1.201
2025-08-22 20:42:46,723 - INFO - 🔥 MPS Iter 4 takes 6.650 seconds. Loss: 0.430
2025-08-22 20:42:49,302 - INFO - 🔥 MPS Iter 5 takes 8.538 seconds. Loss: 0.174
2025-08-22 20:42:51,057 - INFO - 🔥 MPS Iter 6 takes 11.110 seconds. Loss: 0.074
2025-08-22 20:42:53,656 - INFO - 🔥 MPS Iter 7 takes 12.867 seconds. Loss: 0.034
2025-08-22 20:42:55,540 - INFO - 🔥 MPS Iter 8 takes 15.471 seconds. Loss: 0.016
2025-08-22 20:42:58,101 - INFO - 🔥 MPS Iter 9 takes 17.347 seconds. Loss: 0.007
2025-08-22 20:42:58,106 - INFO - ✅ Converged after 9 iterations
2025-08-22 20:42:58,107 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:42:58,211 - INFO - 🧹 GPU memory cleared
2025-08-22 20:43:00,457 - INFO -    RWR 耗时: 22.273 秒
2025-08-22 20:43:01,676 - INFO -    归一化耗时: 1.217 秒
2025-08-22 20:43:07,943 - ERROR -   ❌ chrX: 失败 - [Errno 28] No space left on device
2025-08-22 20:43:07,953 - INFO - 🎯 细胞 GasdE701008 完成: 19 成功, 1 失败, 总耗时 7.3 分钟
2025-08-22 20:43:07,955 - INFO - 📊 Stage E70: 处理细胞 8/557
2025-08-22 20:43:07,956 - INFO - 🧬 开始处理细胞: GasdE701009
2025-08-22 20:43:07,958 - INFO - 🧬 开始处理 chr1 (bin格式)
2025-08-22 20:43:07,970 - INFO -    矩阵大小: (9774, 9774), 非零元素: 45196, 稀疏度: 0.000473
2025-08-22 20:43:07,972 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:43:07,972 - INFO - 🔥 MPS Gaussian filter: 9774x9774 matrix, 内存需求: 1458.0MB
2025-08-22 20:43:08,229 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:43:08,805 - INFO -    卷积耗时: 0.833 秒
2025-08-22 20:43:08,817 - INFO - 🚀 MPS 加速: 9774x9774 矩阵 (内存需求: 1.07GB, 稀疏度: 0.0031)
2025-08-22 20:43:08,817 - INFO - 🚀 Using MPS for 9774x9774 matrix with 24GB GPU memory
2025-08-22 20:43:08,818 - INFO - Converting 9774x9774 sparse matrix to dense for MPS...
2025-08-22 20:43:08,888 - INFO - 💾 Estimated GPU memory usage: 1093.3 MB
2025-08-22 20:43:12,312 - INFO - 🔥 MPS Iter 1 takes 0.073 seconds. Loss: 9.765
2025-08-22 20:43:15,809 - INFO - 🔥 MPS Iter 2 takes 3.504 seconds. Loss: 1.693
2025-08-22 20:43:19,513 - INFO - 🔥 MPS Iter 3 takes 7.002 seconds. Loss: 0.394
2025-08-22 20:43:22,607 - INFO - 🔥 MPS Iter 4 takes 10.703 seconds. Loss: 0.103
2025-08-22 20:43:25,793 - INFO - 🔥 MPS Iter 5 takes 13.797 seconds. Loss: 0.032
2025-08-22 20:43:29,452 - INFO - 🔥 MPS Iter 6 takes 17.174 seconds. Loss: 0.011
2025-08-22 20:43:32,622 - INFO - 🔥 MPS Iter 7 takes 20.655 seconds. Loss: 0.004
2025-08-22 20:43:32,634 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:43:32,635 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:43:32,956 - INFO - 🧹 GPU memory cleared
2025-08-22 20:43:36,273 - INFO -    RWR 耗时: 27.462 秒
2025-08-22 20:43:41,409 - INFO -    归一化耗时: 5.131 秒
2025-08-22 20:43:42,844 - ERROR -   ❌ chr1: 失败 - [Errno 28] No space left on device
2025-08-22 20:43:42,868 - INFO - 🧬 开始处理 chr2 (bin格式)
2025-08-22 20:43:42,879 - INFO -    矩阵大小: (9106, 9106), 非零元素: 41612, 稀疏度: 0.000502
2025-08-22 20:43:42,881 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:43:42,882 - INFO - 🔥 MPS Gaussian filter: 9106x9106 matrix, 内存需求: 1265.5MB
2025-08-22 20:43:43,283 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:43:43,715 - INFO -    卷积耗时: 0.834 秒
2025-08-22 20:43:43,723 - INFO - 🚀 MPS 加速: 9106x9106 矩阵 (内存需求: 0.93GB, 稀疏度: 0.0032)
2025-08-22 20:43:43,724 - INFO - 🚀 Using MPS for 9106x9106 matrix with 24GB GPU memory
2025-08-22 20:43:43,725 - INFO - Converting 9106x9106 sparse matrix to dense for MPS...
2025-08-22 20:43:43,785 - INFO - 💾 Estimated GPU memory usage: 948.9 MB
2025-08-22 20:43:45,903 - INFO - 🔥 MPS Iter 1 takes 0.064 seconds. Loss: 9.232
2025-08-22 20:43:48,874 - INFO - 🔥 MPS Iter 2 takes 2.187 seconds. Loss: 1.608
2025-08-22 20:43:51,117 - INFO - 🔥 MPS Iter 3 takes 5.158 seconds. Loss: 0.376
2025-08-22 20:43:54,062 - INFO - 🔥 MPS Iter 4 takes 7.401 seconds. Loss: 0.099
2025-08-22 20:43:56,158 - INFO - 🔥 MPS Iter 5 takes 10.345 seconds. Loss: 0.031
2025-08-22 20:43:59,127 - INFO - 🔥 MPS Iter 6 takes 12.441 seconds. Loss: 0.010
2025-08-22 20:44:01,321 - INFO - 🔥 MPS Iter 7 takes 15.410 seconds. Loss: 0.004
2025-08-22 20:44:01,328 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:44:01,329 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:44:01,479 - INFO - 🧹 GPU memory cleared
2025-08-22 20:44:05,068 - INFO -    RWR 耗时: 21.350 秒
2025-08-22 20:44:06,970 - INFO -    归一化耗时: 1.895 秒
2025-08-22 20:44:08,406 - ERROR -   ❌ chr2: 失败 - [Errno 28] No space left on device
2025-08-22 20:44:08,428 - INFO - 🧬 开始处理 chr3 (bin格式)
2025-08-22 20:44:08,439 - INFO -    矩阵大小: (8002, 8002), 非零元素: 33610, 稀疏度: 0.000525
2025-08-22 20:44:08,441 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:44:08,442 - INFO - 🔥 MPS Gaussian filter: 8002x8002 matrix, 内存需求: 977.3MB
2025-08-22 20:44:08,761 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:44:09,114 - INFO -    卷积耗时: 0.673 秒
2025-08-22 20:44:09,121 - INFO - 🚀 MPS 加速: 8002x8002 矩阵 (内存需求: 0.72GB, 稀疏度: 0.0035)
2025-08-22 20:44:09,122 - INFO - 🚀 Using MPS for 8002x8002 matrix with 24GB GPU memory
2025-08-22 20:44:09,123 - INFO - Converting 8002x8002 sparse matrix to dense for MPS...
2025-08-22 20:44:09,180 - INFO - 💾 Estimated GPU memory usage: 732.8 MB
2025-08-22 20:44:09,844 - INFO - 🔥 MPS Iter 1 takes 0.061 seconds. Loss: 9.278
2025-08-22 20:44:12,255 - INFO - 🔥 MPS Iter 2 takes 0.750 seconds. Loss: 1.675
2025-08-22 20:44:14,143 - INFO - 🔥 MPS Iter 3 takes 3.144 seconds. Loss: 0.397
2025-08-22 20:44:15,541 - INFO - 🔥 MPS Iter 4 takes 5.031 seconds. Loss: 0.103
2025-08-22 20:44:16,982 - INFO - 🔥 MPS Iter 5 takes 6.426 seconds. Loss: 0.031
2025-08-22 20:44:18,718 - INFO - 🔥 MPS Iter 6 takes 7.868 seconds. Loss: 0.010
2025-08-22 20:44:20,432 - INFO - 🔥 MPS Iter 7 takes 9.602 seconds. Loss: 0.004
2025-08-22 20:44:20,440 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:44:20,441 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:44:20,489 - INFO - 🧹 GPU memory cleared
2025-08-22 20:44:22,915 - INFO -    RWR 耗时: 13.798 秒
2025-08-22 20:44:24,847 - INFO -    归一化耗时: 1.927 秒
2025-08-22 20:44:25,615 - ERROR -   ❌ chr3: 失败 - [Errno 28] No space left on device
2025-08-22 20:44:25,636 - INFO - 🧬 开始处理 chr4 (bin格式)
2025-08-22 20:44:25,643 - INFO -    矩阵大小: (7826, 7826), 非零元素: 33287, 稀疏度: 0.000543
2025-08-22 20:44:25,645 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:44:25,646 - INFO - 🔥 MPS Gaussian filter: 7826x7826 matrix, 内存需求: 934.8MB
2025-08-22 20:44:26,067 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:44:26,385 - INFO -    卷积耗时: 0.740 秒
2025-08-22 20:44:26,409 - INFO - 🚀 MPS 加速: 7826x7826 矩阵 (内存需求: 0.68GB, 稀疏度: 0.0034)
2025-08-22 20:44:26,410 - INFO - 🚀 Using MPS for 7826x7826 matrix with 24GB GPU memory
2025-08-22 20:44:26,410 - INFO - Converting 7826x7826 sparse matrix to dense for MPS...
2025-08-22 20:44:26,479 - INFO - 💾 Estimated GPU memory usage: 700.9 MB
2025-08-22 20:44:27,085 - INFO - 🔥 MPS Iter 1 takes 0.073 seconds. Loss: 9.213
2025-08-22 20:44:29,403 - INFO - 🔥 MPS Iter 2 takes 0.687 seconds. Loss: 1.692
2025-08-22 20:44:30,785 - INFO - 🔥 MPS Iter 3 takes 3.374 seconds. Loss: 0.424
2025-08-22 20:44:32,053 - INFO - 🔥 MPS Iter 4 takes 4.382 seconds. Loss: 0.116
2025-08-22 20:44:33,801 - INFO - 🔥 MPS Iter 5 takes 5.654 seconds. Loss: 0.037
2025-08-22 20:44:35,163 - INFO - 🔥 MPS Iter 6 takes 7.399 seconds. Loss: 0.012
2025-08-22 20:44:36,302 - INFO - 🔥 MPS Iter 7 takes 8.757 seconds. Loss: 0.005
2025-08-22 20:44:36,309 - INFO - ✅ Converged after 7 iterations
2025-08-22 20:44:36,310 - INFO - Converting MPS result back to sparse matrix...
2025-08-22 20:44:36,352 - INFO - 🧹 GPU memory cleared
2025-08-22 20:44:38,264 - INFO -    RWR 耗时: 11.860 秒
2025-08-22 20:44:39,697 - INFO -    归一化耗时: 1.428 秒
2025-08-22 20:44:41,458 - ERROR -   ❌ chr4: 失败 - [Errno 28] No space left on device
2025-08-22 20:44:41,469 - INFO - 🧬 开始处理 chr5 (bin格式)
2025-08-22 20:44:41,481 - INFO -    矩阵大小: (7592, 7592), 非零元素: 33455, 稀疏度: 0.000580
2025-08-22 20:44:41,483 - INFO -    使用 MPS 加速 Gaussian 卷积
2025-08-22 20:44:41,484 - INFO - 🔥 MPS Gaussian filter: 7592x7592 matrix, 内存需求: 879.7MB
2025-08-22 20:44:41,608 - INFO - ✅ MPS Gaussian filter completed, GPU 内存已清理
2025-08-22 20:44:41,961 - INFO -    卷积耗时: 0.478 秒
2025-08-22 20:44:41,968 - INFO - 🚀 MPS 加速: 7592x7592 矩阵 (内存需求: 0.64GB, 稀疏度: 0.0037)
2025-08-22 20:44:41,969 - INFO - 🚀 Using MPS for 7592x7592 matrix with 24GB GPU memory
2025-08-22 20:44:41,970 - INFO - Converting 7592x7592 sparse matrix to dense for MPS...
2025-08-22 20:44:42,030 - INFO - 💾 Estimated GPU memory usage: 659.6 MB
2025-08-22 20:44:42,614 - INFO - 🔥 MPS Iter 1 takes 0.064 seconds. Loss: 8.659
2025-08-22 20:44:44,517 - INFO - 🔥 MPS Iter 2 takes 0.651 seconds. Loss: 1.540
2025-08-22 20:44:45,636 - INFO - 🔥 MPS Iter 3 takes 2.555 seconds. Loss: 0.366
2025-08-22 20:44:46,503 - INFO - 🔥 MPS Iter 4 takes 3.674 seconds. Loss: 0.097
