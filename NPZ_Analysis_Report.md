# NPZ 文件分析报告

## 概述
本报告分析了 `data/example_data/` 目录下的 4 个 NPZ 文件，这些文件都存储了稀疏矩阵数据，主要用于单细胞 Hi-C 数据分析。

## 文件详细信息

### 1. Astro_Endo_ODC_OPC_chr1_upper_tri.npz
- **文件大小**: 14.47 MB
- **矩阵格式**: COO (Coordinate) 格式稀疏矩阵
- **矩阵维度**: 2,101 × 30,876
- **数据类型**: float64
- **非零元素**: 6,480,102 个
- **稀疏度**: 90.01%
- **数值范围**: [1.0, 135.0]
- **数值特征**: 
  - 整数值，主要集中在1-10之间
  - 值为1的元素最多（2,905,028次）
  - 可能表示接触频次计数

**用途推测**: 
- 多种细胞类型（星形胶质细胞Astro、内皮细胞Endo、少突胶质细胞ODC、少突胶质前体细胞OPC）的染色体1接触矩阵
- "upper_tri"表示只存储了上三角部分，利用Hi-C数据的对称性节省存储空间

### 2. GasdE701001_chr1_pad1_std1.0_rp0.5_sqrtvc.npz
- **文件大小**: 13.34 MB
- **矩阵格式**: CSR (Compressed Sparse Row) 格式稀疏矩阵
- **矩阵维度**: 4,887 × 4,887 (正方形矩阵)
- **数据类型**: float32
- **非零元素**: 3,712,437 个
- **稀疏度**: 84.46%
- **数值范围**: [0.0, 1.0]
- **数值特征**: 
  - 归一化后的浮点值
  - 对角线上接近1.0的值表示自相互作用
  - 矩阵对称

**用途推测**: 
- 单细胞样本 GasdE701001 的染色体1接触矩阵
- 经过预处理：pad1（填充）、std1.0（标准化）、rp0.5（随机化参数）、sqrtvc（平方根方差归一化）

### 3. K562_2k_ALL_sim.npz
- **文件大小**: 0.32 MB
- **矩阵格式**: COO 格式稀疏矩阵
- **矩阵维度**: 1,830 × 300
- **数据类型**: int64
- **非零元素**: 350,359 个
- **稀疏度**: 36.18%
- **数值范围**: [1, 18]
- **数值特征**: 
  - 整数值，分布相对均匀
  - 较高的密度（低稀疏度）

**用途推测**: 
- K562细胞系的模拟（simulation）数据
- "2k"可能表示2kb分辨率
- "ALL"可能表示所有染色体或所有条件

### 4. K562_2k_ALL_true.npz
- **文件大小**: 0.07 MB
- **矩阵格式**: COO 格式稀疏矩阵
- **矩阵维度**: 1,830 × 300
- **数据类型**: float64
- **非零元素**: 499,473 个
- **稀疏度**: 9.02%
- **数值范围**: [0.157, 9.056]
- **数值特征**: 
  - 浮点值，每行数值相同（可能经过某种归一化）
  - 最高密度（最低稀疏度）

**用途推测**: 
- K562细胞系的真实观测（true/observed）数据
- 与上述sim文件形成模拟vs真实数据的对比对

## 主要发现

### 1. 数据类型多样性
- **计数数据**: Astro_Endo_ODC_OPC和K562_sim文件包含原始计数
- **归一化数据**: GasdE701001文件经过复杂的归一化处理
- **观测数据**: K562_true文件可能是实验观测值

### 2. 矩阵格式优化
- **COO格式**: 适合初始数据加载和简单操作
- **CSR格式**: 适合快速行访问和矩阵乘法运算

### 3. 稀疏度差异显著
- 从9.02%（K562_true）到90.01%（Astro_Endo_ODC_OPC）
- 反映了不同数据处理方法和数据类型的特征

### 4. 应用场景推测
- **Astro_Endo_ODC_OPC**: 多细胞类型的Hi-C数据聚合分析
- **GasdE701001**: 单细胞Hi-C数据的插补和分析
- **K562对**: 方法验证，比较模拟结果与真实数据

## 技术建议

1. **数据加载**: 使用scipy.sparse处理所有文件
2. **内存优化**: CSR格式的GasdE701001文件最适合大规模计算
3. **对比分析**: K562的sim和true文件可用于算法验证
4. **预处理参考**: GasdE701001的处理流程可作为其他数据的参考

## 结论

这些NPZ文件代表了单细胞Hi-C数据分析流程中的不同阶段和类型：
- 原始数据（Astro_Endo_ODC_OPC）
- 预处理数据（GasdE701001）
- 验证数据集（K562对）

它们为单细胞染色体空间结构研究提供了丰富的测试和验证数据集。
